<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Emma Rand">
<title>Workshop – Data Analysis in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-bc185b5c5bdbcb35c2eb49d8a876ef70.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-72ac799c4abbddf31cb463dd8fc99f5d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-25ac7be22ffa75a8e8541e30a6dcc9a3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-72ac799c4abbddf31cb463dd8fc99f5d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-50FV9HPTRE"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-50FV9HPTRE', { 'anonymize_ip': true});
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Data Analysis in R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Welcome!</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../r4babs1/r4babs1.html"> 
<span class="menu-text">BABS 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../r4babs2/r4babs2.html" aria-current="page"> 
<span class="menu-text">BABS 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../r4babs4/r4babs4.html"> 
<span class="menu-text">BABS 4</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../pgt52m/pgt52m.html"> 
<span class="menu-text">PGT 52M</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/3mmaRand" title="Emma on GitHub" class="quarto-navigation-tool px-1" aria-label="Emma on GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../r4babs2/week-2/overview.html">Week 2: Introduction to statistical models: Single regression</a></li><li class="breadcrumb-item"><a href="../../r4babs2/week-2/workshop.html">Workshop</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/r4babs2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis in R for BABS 2</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 1: The logic of hypothesis testing and CI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-1/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-1/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-1/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-1/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 2: Introduction to statistical models: Single regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-2/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-2/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-2/workshop.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-2/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 3: Two-sample tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-3/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-3/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-3/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-3/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 4: One-way ANOVA and Kruskal-Wallis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-4/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-4/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-4/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-4/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 5: Two-way ANOVA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-5/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-5/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-5/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-5/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 6: Association</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-6/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-6/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-6/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs2/week-6/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
<li><a href="#session-overview" id="toc-session-overview" class="nav-link" data-scroll-target="#session-overview">Session overview</a></li>
  <li><a href="#philosophy" id="toc-philosophy" class="nav-link" data-scroll-target="#philosophy">Philosophy</a></li>
  </ul>
</li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting started</a></li>
  <li>
<a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
<li>
<a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a>
  <ul class="collapse">
<li><a href="#exploring" id="toc-exploring" class="nav-link" data-scroll-target="#exploring">Exploring</a></li>
  <li><a href="#applying-interpreting-and-reporting" id="toc-applying-interpreting-and-reporting" class="nav-link" data-scroll-target="#applying-interpreting-and-reporting">Applying, interpreting and reporting</a></li>
  <li><a href="#checking-assumptions" id="toc-checking-assumptions" class="nav-link" data-scroll-target="#checking-assumptions">Checking assumptions</a></li>
  <li><a href="#illustrating" id="toc-illustrating" class="nav-link" data-scroll-target="#illustrating">Illustrating</a></li>
  </ul>
</li>
  <li>
<a href="#linear-regression-for-estimating-molecular-weights-from-gels" id="toc-linear-regression-for-estimating-molecular-weights-from-gels" class="nav-link" data-scroll-target="#linear-regression-for-estimating-molecular-weights-from-gels">Linear Regression for estimating molecular weights from gels</a>
  <ul class="collapse">
<li><a href="#option-1-manual-measurements" id="toc-option-1-manual-measurements" class="nav-link" data-scroll-target="#option-1-manual-measurements">Option 1: Manual measurements</a></li>
  <li><a href="#option-2-measurements-in-r" id="toc-option-2-measurements-in-r" class="nav-link" data-scroll-target="#option-2-measurements-in-r">Option 2: Measurements in R</a></li>
  </ul>
</li>
  <li><a href="#look-after-future-you" id="toc-look-after-future-you" class="nav-link" data-scroll-target="#look-after-future-you">Look after future you!</a></li>
  </ul>
</li>
  <li><a href="#well-done" id="toc-well-done" class="nav-link" data-scroll-target="#well-done">🥳 Well Done! 🎉</a></li>
  <li><a href="#independent-study-following-the-workshop" id="toc-independent-study-following-the-workshop" class="nav-link" data-scroll-target="#independent-study-following-the-workshop">Independent study following the workshop</a></li>
  <li><a href="#the-code-file" id="toc-the-code-file" class="nav-link" data-scroll-target="#the-code-file">The Code file</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/3mmaRand/comp4biosci/edit/main/r4babs2/week-2/workshop.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div><div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="#"><i class="bi bi-chat-left-dots"></i>Make a suggestion</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../r4babs2/week-2/overview.html">Week 2: Introduction to statistical models: Single regression</a></li><li class="breadcrumb-item"><a href="../../r4babs2/week-2/workshop.html">Workshop</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Workshop</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Introduction to statistical models: Single linear regression</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduction" class="level1"><h1>Introduction</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/linear-regression-dragon.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Artwork by @allison_horst: “linear regression dragons”"><img src="images/linear-regression-dragon.png" class="img-fluid figure-img" alt="Two blue dragons stand on scales next to a vertical yardstick showing one slightly taller than the other. Regression estimates are shown at the top as an equation: 'weight (tons) = 2.4 + 0.3*height', with explanatory text reading 'If all other variables are constant, we expect a 1 foot taller dragon to weight 0.3 tons more, on average.'" width="800"></a></p>
<figcaption>Artwork by <span class="citation" data-cites="allison_horst">Horst (<a href="#ref-allison_horst" role="doc-biblioref">2023</a>)</span>: “linear regression dragons”</figcaption></figure>
</div>
<section id="session-overview" class="level2"><h2 class="anchored" data-anchor-id="session-overview">Session overview</h2>
<p>In this session you will carry out, interpret and report a single linear regression.</p>
</section><section id="philosophy" class="level2"><h2 class="anchored" data-anchor-id="philosophy">Philosophy</h2>
<p>Workshops are not a test. It is expected that you often don’t know how to start, make a lot of mistakes and need help. It is expected that you are familiar with independent study content before the workshop. However, you need not remember or understand every detail as the workshop should build and consolidate your understanding. Tips</p>
<ul>
<li>don’t worry about making mistakes</li>
<li>don’t let what you can not do interfere with what you can do</li>
<li>discussing code with your neighbours will help</li>
<li>look things up in the independent study material</li>
<li>look things up in your own code from earlier</li>
<li>there are no stupid questions</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key
</div>
</div>
<div class="callout-body-container callout-body">
<p>These four symbols are used at the beginning of each instruction so you know where to carry out the instruction.</p>
<p><img src="images/do_on_your_computer.png" class="img-fluid"> Something you need to do on your computer. It may be opening programs or documents or locating a file.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Something you should do in RStudio. It will often be typing a command or using the menus but might also be creating folders, locating or moving files.</p>
<p><img src="images/do_on_internet.png" class="img-fluid"> Something you should do in your browser on the internet. It may be searching for information, going to the VLE or downloading a file.</p>
<p><img src="images/answer.png" class="img-fluid"> A question for you to think about and answer. Record your answers in your script for future reference.</p>
</div>
</div>
</section></section><section id="getting-started" class="level1"><h1>Getting started</h1>
<p><img src="images/do_on_your_computer.png" class="img-fluid"> Start RStudio from the Start menu.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Make an RStudio project for this workshop by clicking on the drop-down menu on top right where it says <code>Project: (None)</code> and choosing New Project, then New Directory, then New Project. Navigate to the <code>data-analysis-in-r-2</code> folder and name the RStudio Project <code>week-2</code>.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Make new folders called <code>data-raw</code> and <code>figures</code>. You can do this on the Files Pane by clicking New Folder and typing into the box that appears.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Make a new script then save it with a name like <code>single-linear-regression.R</code> to carry out the rest of the work.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Add a comment to the script: <code># Introduction to statistical models: Single linear-regression</code> and load the <strong><code>tidyverse</code></strong> <span class="citation" data-cites="tidyverse">(<a href="#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span> package</p>
</section><section id="exercises" class="level1"><h1>Exercises</h1>
<section id="linear-regression" class="level2"><h2 class="anchored" data-anchor-id="linear-regression">Linear Regression</h2>
<p>The data in <a href="data-raw/plant.xlsx">plant.xlsx</a> is a set of observations of plant growth over two months. The researchers planted the seeds and harvested, dried and weighed a plant each day from day 10 so all the data points are independent of each other.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Save a copy of <a href="data-raw/plant.xlsx">plant.xlsx</a> to your <code>data-raw</code> folder and import it.</p>
<p><img src="images/answer.png" class="img-fluid"> What type of variables do you have? Which is the response and which is the explanatory? What is the null hypothesis?</p>
<!-- #---THINKING ANSWER---  -->
<!-- Day is discrete (but ordered) and is the explanatory; mass looks continuous and  -->
<!-- is the response.  -->
<!-- The null hypothesis can be expressed as one of the following: day does not  -->
<!-- explain the variation in mass; there is no linear relationship between  -->
<!-- day and mass; slope of the best fitting straight line is zero -->
<section id="exploring" class="level3"><h3 class="anchored" data-anchor-id="exploring">Exploring</h3>
<p><img src="images/do_in_R.png" class="img-fluid"> Do a quick plot of the data:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plant</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">mass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="workshop_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p><img src="images/answer.png" class="img-fluid"> What are the assumptions of linear regression? Do these seem to be met?</p>
<!-- #---THINKING ANSWER--- -->
<!-- linear relationship - looks ok on the scatter -->
<!-- each y is drawn from a normal distribution for each x and these  -->
<!-- normal distributions have the same variance - looks ok too.  -->
<!-- We'd expect y to be continuous and the scatter around a best fitting line  -->
<!-- we imagine is about even. -->
<!-- The values of y are independent of each other - yes it was a different  -->
<!-- plant each day (in fact plant was destroyed). Measuring the height  -->
<!-- of the SAME plants each day would violate this assumption -->
<!-- x has been chosen by the experimenter - yes. -->
</section><section id="applying-interpreting-and-reporting" class="level3"><h3 class="anchored" data-anchor-id="applying-interpreting-and-reporting">Applying, interpreting and reporting</h3>
<p><img src="images/do_in_R.png" class="img-fluid"> We now carry out a regression assigning the result of the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> procedure to a variable and examining it with <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plant</span>, <span class="va">mass</span> <span class="op">~</span> <span class="va">day</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ day, data = plant)

Residuals:
    Min      1Q  Median      3Q     Max 
-32.810 -11.253  -0.408   9.075  48.869 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -8.6834     6.4729  -1.342    0.186    
day           1.6026     0.1705   9.401  1.5e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.92 on 49 degrees of freedom
Multiple R-squared:  0.6433,    Adjusted R-squared:  0.636 
F-statistic: 88.37 on 1 and 49 DF,  p-value: 1.503e-12</code></pre>
</div>
</div>
<p>The Estimates in the Coefficients table give the intercept (first line) and the slope (second line) of the best fitting straight line. The <em>p</em>-values on the same line are tests of whether that coefficient is different from zero.</p>
<p>The <em>F</em> value and <em>p</em>-value in the last line are a test of whether the model as a whole explains a significant amount of variation in the dependent variable. For a single linear regression this is exactly equivalent to the test of the slope against zero.</p>
<p><img src="images/answer.png" class="img-fluid"> What is the equation of the line? What do you conclude from the analysis?</p>
<!-- #---THINKING ANSWER--- -->
<!-- mass = 1.606*day - 8.683 -->
<!-- the slope of the line is significantly different from zero OR -->
<!-- the day explains a significant amount of the variation in mass OR -->
<!-- mass can be predicted from the day (ANOVA: F = 88.4; d.f. = 1,49; p < 0.0001).  -->
<p><img src="images/answer.png" class="img-fluid"> Does the line go through (0,0)?</p>
<!-- #---THINKING ANSWER--- -->
<!-- yes it could. The intercept is -8.683 but it is not significantly  -->
<!-- different from zero thus it could be zero.  -->
<p><img src="images/answer.png" class="img-fluid"> What percentage of variation is explained by the line?</p>
<!-- #---THINKING ANSWER--- -->
<!-- 64%  -->
<p>It might be useful to assign the slope and the intercept to variables in case we need them later. The can be accessed in the <code>mod$coefficients</code> variable:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         day 
  -8.683379    1.602606 </code></pre>
</div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Assign <code>mod$coefficients[1]</code> to <code>b0</code> and <code>mod$coefficients[1]</code> to <code>b1</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I also rounded the values to two decimal places.</p>
</section><section id="checking-assumptions" class="level3"><h3 class="anchored" data-anchor-id="checking-assumptions">Checking assumptions</h3>
<p>We need to examine the residuals. Very conveniently, the object which is created by <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> contains a variable called <code>$residuals</code>. Also conveniently, the R’s <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function can used on the output objects of <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. The assumptions of the GLM demand that each <em>y</em> is drawn from a normal distribution for each <em>x</em> and these normal distributions have the same variance. Therefore, we plot the residuals against the fitted values to see if the variance is the same for all the values of <em>x</em>. The fitted - or predicted - values are the values on the line of best fit. Each residual is the difference between the fitted values and the observed value.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Plot the model residuals against the fitted values like this:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="workshop_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p><img src="images/answer.png" class="img-fluid"> What to you conclude?</p>
<!-- #---THINKING ANSWER--- -->
<!-- The residuals look 'homogeneously' distributed. That is, the variance is the same  -->
<!-- for all the values of x.  -->
<p>To examine normality of the model residuals we can plot them as a histogram and do a normality test on them.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Plot a histogram of the residuals:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="workshop_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Use the <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> to test the normality of the model residuals</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  mod$residuals
W = 0.96377, p-value = 0.1208</code></pre>
</div>
</div>
<p>Usually, when we are doing statistical tests we would like the the test to be significant because it means we have evidence of a biological effect. However, when doing normality tests we hope it will not be significant. A non-significant result means that there is no significant difference between the distribution of the residuals and a normal distribution and that indicates the assumptions are met.</p>
<p><img src="images/answer.png" class="img-fluid"> What to you conclude?</p>
<!-- #---THINKING ANSWER--- -->
<!-- the residuals appear roughly normally distributed.  -->
<!-- The histogram is symmetrical and the shapiro test is NS. -->
<!-- Overall, it seems the assumptions are met -->
</section><section id="illustrating" class="level3"><h3 class="anchored" data-anchor-id="illustrating">Illustrating</h3>
<p>We want a figure with the points and the statistical model, i.e., the best fitting straight line.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Create a scatter plot using <code>geom_point()</code></p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plant</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">mass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="workshop_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> The <code>geom_smooth()</code> function will add a variety of fitted lines to a plot. We want a straight line so we need to specify <code>method = "lm"</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plant</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">mass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>              colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="workshop_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> What do the <code>se</code> and <code>colour</code> arguments do? Try changing them.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Let’s add the equation of the line to the figure using <code>annotate()</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plant</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">mass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>              colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="fl">110</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"mass = 1.61 * day - 8.68"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="workshop_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p>We have to tell <code>annotate()</code> what type of geom we want - <code>text</code> in this case, - where to put it, and the text we want to appear.</p>
<p>Instead of hardcoding the equation, we can use the values of <code>b0</code> and <code>b1</code> that we assigned earlier. This is a neat trick that makes or work more reproducible. If the data were updated, we would not need to change the equation in the figure.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plant</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">mass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>              colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="fl">110</span>, </span>
<span>           label <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"mass = { b1 } * day {if (b0&lt;0) \"-\" else \"+\"} { abs(b0) }"</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="workshop_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The <code><a href="https://glue.tidyverse.org/reference/glue.html">glue::glue()</a></code> function allows us to use variables in the text - the variables go inside curly braces</li>
<li>
<code>{ b1 }</code> and <code>{ abs(b0) }</code> are the variables we assigned earlier and they will be replaced with their values in the text.</li>
<li>The <code>if (b0&lt;0) \"-\" else \"+\"</code> part is a conditional that adds a minus sign if the intercept is negative and a plus sign if it is positive. The <code>abs(b0)</code> part makes sure we only show the absolute value of the intercept.</li>
</ul>
<p><img src="images/do_in_R.png" class="img-fluid"> Improve the axes. You may need to refer back <a href="../../r4babs1/week-7/workshop.html#changing-the-axes">Changing the axes</a> from the Week 7 workshop in BABS1 <span class="citation" data-cites="rand2023">(<a href="#ref-rand2023" role="doc-biblioref">Rand 2023</a>)</span></p>
<p><img src="images/do_in_R.png" class="img-fluid"> Save your figure to your <code>figures</code> folder. Make sure you <a href="../../r4babs1/week-9/workshop.html#writing-figures-to-file">script figure saving with <code>ggsave()</code></a>.</p>
</section></section><section id="linear-regression-for-estimating-molecular-weights-from-gels" class="level2"><h2 class="anchored" data-anchor-id="linear-regression-for-estimating-molecular-weights-from-gels">Linear Regression for estimating molecular weights from gels</h2>
<p>In this section we will use a linear regression to estimate the molecular weights of proteins from a gel. Gels are run with a marker lane containing proteins of known molecular weights. The positions of these marker proteins are used to create a standard curve that allows us to estimate the molecular weights of other proteins in the gel.</p>
<p>This is a different use for linear regression than the previous example where we wanted to statistically test whether the an <em>x</em>-variable explained the variation in a <em>y</em>-variable.</p>
<p>Here we already know there is a very tight linear relationship between the position of the marker proteins on the gel and their molecular weights. We are using the linear regression to find the equation of the line that describes this relationship so we can use it to estimate the molecular weights of other proteins in the gel.</p>
<p>We will use this gel image (<strong>?@fig-gel</strong>) as an example: <a href="data-image/26C-10-Coomassie-Blue.jpg">26C-10-Coomassie-Blue.jpg</a>. This gel has two sets of results (one each side) – since only 4 lanes were for each practical group, we put two groups on one gel.</p>
<ul>
<li><p>Lane 1 (and 10) is the protein ladder which are the proteins of known molecular weights.</p></li>
<li><p>Lane 2 (and 9) is Uninduced E. coli lysate</p></li>
<li><p>Lane 3 (and 8) is Induced E. coli lysate</p></li>
<li><p>Lane 4 (and 7) is ShPatB</p></li>
</ul>
<p>You don’t need worry about the details of the gel, only that our aim is to estimate the molecule weight of the ShPatB protein in lane 4 from its position on the gel and the standard curve created from the marker proteins in lane 1. <strong>?@fig-gel</strong> illustrates the measurements needed from the gel image.</p>
<div class="cell">
<div class="cell-output cell-output-error">
<pre><code>Error in library(imager): there is no package called 'imager'</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in load.image("data-image/26C-10-Coomassie-Blue.jpg"): could not find function "load.image"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in crop.borders(gel, nx = 300, ny = 150): could not find function "crop.borders"</code></pre>
</div>
</div>
<p>: :: {fig-gel}</p>
<div class="cell">
<div class="cell-output cell-output-error">
<pre><code>Error: object 'gel_cropped' not found</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in segments(x0 = 50, y0 = gel_top, x1 = 50, y1 = gel_bottom, lty = 2): plot.new has not been called yet</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in text.default(x = 20, y = (gel_top + gel_bottom)/2, labels = "L", : plot.new has not been called yet</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in arrows(x0 = 220, y0 = gel_top, x1 = 220, y1 = gel_top + 138, : plot.new has not been called yet</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in arrows(x0 = 510, y0 = gel_top, x1 = 510, y1 = gel_top + pos_patB, : plot.new has not been called yet</code></pre>
</div>
</div>
<p><strong>SDS-PAGE gel provided as a sample in the BCH strand of 26C practicals with annotation.</strong> Lane 1 (and 10) is the protein ladder, Lane 2 (and 9) is Uninduced E. coli lysate, Lane 3 (and 8) is Induced E. coli lysate and Lane 4 (and 7) is ShPatB. The horizontal red lines indicate the top and bottom of the gel. The vertical black dashed line indicates the length of the gel, <span class="math inline">\(L\)</span>. The distance of one marker protein – the heaviest – and that ShPatB from the top of the gel are indicated by vertical solid blue lines. Distance to all the marker proteins need to be measured from the top of the gel. These distances and the molecular weights of the marker proteins are used to create a standard curve that allows us to estimate the molecular weight of ShPatB from its position on the gel.</p>
<p>:::</p>
<p>We will cover two options:</p>
<ol type="1">
<li><p>Where you have measured the length of the gel, the positions of ShPatB and the marker proteins on the gel manually – by opening the gel image in Powerpoint for example – and have a file containing the molecular weights and positions of the marker proteins. The measures can be in centimetres or pixels, it does not matter as long as they are all in the same units.</p></li>
<li><p>Where you have a file containing the molecular weights of the marker proteins and use R to measure the length of the gel, the positions of ShPatB and the marker proteins by importing the gel image. This method relies on the <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code> which stores the coordinate positions when you click on a plot! Magic!</p></li>
</ol>
<p><img src="images/do_in_R.png" class="img-fluid"> Make a new script then save it with a name like <code>mw-from-gel-regression.R</code> to carry out the rest of the work.</p>
<section id="option-1-manual-measurements" class="level3"><h3 class="anchored" data-anchor-id="option-1-manual-measurements">Option 1: Manual measurements</h3>
<p>You have measured the positions of the marker proteins and added them to a file containing the molecular weights. Your file is: <a href="data-raw/standard-mw-with-positions.csv">standard-mw-with-positions.csv</a>. The molecular weights of the marker proteins are in kilodaltons (kDa) and the positions of the marker proteins are in pixels. The length of the gel is 810 pixels and ShPatB is at 394 pixels from the top of the gel.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Save <a href="data-raw/standard-mw-with-positions.csv">standard-mw-with-positions.csv</a> to <code>data-raw/</code> and import it.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mw_positions</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data-raw/standard-mw-with-positions.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Assign the position of ShPatB and the length of the gel to variables:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gel_length</span> <span class="op">&lt;-</span> <span class="fl">810</span></span>
<span><span class="va">pos_patB</span> <span class="op">&lt;-</span> <span class="fl">394</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to calculate <span class="math inline">\(R_f\)</span> values for the marker proteins:</p>
<p><span class="math display">\[R_f = \frac{L - d}{L}\]</span></p>
<p>where <span class="math inline">\(L\)</span> is the length of the gel and <span class="math inline">\(d\)</span> is the distance to the band.</p>
<p>We also need to log the molecular weights of the marker proteins to make a linear relationship. We can add these two new variables to the data frame using the <code>mutate()</code>.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Calculate Rf values for the marker proteins:</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mw_positions</span> <span class="op">&lt;-</span> <span class="va">mw_positions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Rf <span class="op">=</span> <span class="op">(</span><span class="va">gel_length</span> <span class="op">-</span> <span class="va">dist_to_band</span><span class="op">)</span> <span class="op">/</span> <span class="va">gel_length</span>,</span>
<span>         log_kda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">kda</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Plot the data with <code>geom_point()</code> and add a linear regression line with <code>geom_smooth(method = "lm")</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mw_positions</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Rf</span>, y <span class="op">=</span> <span class="va">log_kda</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="workshop_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Fit a linear model so we have the equation of the line</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">log_kda</span> <span class="op">~</span> <span class="va">Rf</span>, data <span class="op">=</span> <span class="va">mw_positions</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Print the model:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_kda ~ Rf, data = mw_positions)

Coefficients:
(Intercept)           Rf  
      1.091        5.231  </code></pre>
</div>
</div>
<p>We only need to print the coefficients – we don’t care about the statistical tests here. You can tell from the plot that the relationship is very tight and linear. The equation of the line is: <span class="math inline">\(MW\)</span>= 5.231 * <span class="math inline">\(R_f\)</span> + 1.091</p>
<p>You can substitute the values of the coefficients and the <span class="math inline">\(R_f\)</span> of ShpatB to find the log molecular weight of ShPatB. Or you can use the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function to do this for you.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Calculate the <span class="math inline">\(R_f\)</span> of ShPatB:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patB_Rf</span> <span class="op">=</span> <span class="op">(</span><span class="va">gel_length</span> <span class="op">-</span> <span class="va">pos_patB</span><span class="op">)</span> <span class="op">/</span> <span class="va">gel_length</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Predict the molecular weight ShPatB:</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patB_kda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Rf <span class="op">=</span> <span class="va">patB_Rf</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">patB_kda</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
43.69469 </code></pre>
</div>
</div>
</section><section id="option-2-measurements-in-r" class="level3"><h3 class="anchored" data-anchor-id="option-2-measurements-in-r">Option 2: Measurements in R</h3>
<p>You have a file containing the molecular weights of the marker proteins <a href="data-image/standard-mw.txt">standard-mw.txt</a> and the image of the gel <a href="data-image/26C-10-Coomassie-Blue.jpg">26C-10-Coomassie-Blue.jpg</a>. The molecular weights of the marker proteins are in kilodaltons (kDa)</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Make a folder call <code>data-image</code> and save <a href="data-image/standard-mw.txt">standard-mw.txt</a> and <a href="data-image/26C-10-Coomassie-Blue.jpg">26C-10-Coomassie-Blue.jpg</a> to it</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Imort the molecular weights of the marker proteins from <a href="data-image/standard-mw.txt">standard-mw.txt</a></p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mw</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data-image/standard-mw.txt"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Load the <code>imager</code> package</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://asgr.github.io/imager/">imager</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in library(imager): there is no package called 'imager'</code></pre>
</div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Import the gel image:</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gel</span> <span class="op">&lt;-</span> <span class="fu">load.image</span><span class="op">(</span><span class="st">"data-image/26C-10-Coomassie-Blue.jpg"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in load.image("data-image/26C-10-Coomassie-Blue.jpg"): could not find function "load.image"</code></pre>
</div>
</div>
<p>Base R’s generic <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function can handle image files and plot axes default. These are in pixels and will help us mark the top and bottom of the gel.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Plot the gel image:</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gel</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'gel' not found</code></pre>
</div>
</div>
<p>The <strong><code>imager</code></strong> package has a function that will crop the edges of the image. This is certainly not essential but can have two benefits:</p>
<ul>
<li>the image is smaller which means plotting is quicker – this is especially useful when your images are many pixels</li>
<li>it makes it a little easier determine where the axes numbers are on the gel</li>
</ul>
<p><img src="images/do_in_R.png" class="img-fluid"> Crop the image:</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># crop</span></span>
<span><span class="va">gel_cropped</span> <span class="op">&lt;-</span> <span class="fu">crop.borders</span><span class="op">(</span><span class="va">gel</span>, nx <span class="op">=</span> <span class="fl">300</span>, ny <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in crop.borders(gel, nx = 300, ny = 150): could not find function "crop.borders"</code></pre>
</div>
</div>
<p><code>crop.borders()</code> removes <code>ny</code> from the top and the bottom and <code>nx</code> from each side. You may wish to adjust the numbers.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Plot the cropped image:</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gel_cropped</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'gel_cropped' not found</code></pre>
</div>
</div>
<p>To make sure we measure distances from the same place we need to add lines to mark the top and the bottom of the gel. Notice that the <em>y</em>-axis is 0 at the top. I think the top is at about 180 and the bottom is about 990. We will assign these values to variables because they will be needed in calculations later. We will also need the gel length (bottom position - top position).</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Assign values for the top and bottom of the gel to variables and calculate the length of the gel:</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gel_top</span> <span class="op">&lt;-</span> <span class="fl">180</span></span>
<span><span class="va">gel_bottom</span> <span class="op">&lt;-</span> <span class="fl">990</span></span>
<span><span class="va">gel_length</span> <span class="op">&lt;-</span> <span class="va">gel_bottom</span> <span class="op">-</span> <span class="va">gel_top</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Plot the cropped gel with lines marking the top and bottom of the gel:</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot gel</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gel_cropped</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'gel_cropped' not found</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add a horizontal lines for the top and bottom of the gel </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">gel_top</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet</code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">gel_bottom</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet</code></pre>
</div>
</div>
<p>Make sure you run all theses commands. The base plotting system works a little differently that <code>ggplot</code>. We do not use <code>+</code> but we have to make sure we have recently run the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> command before the <code><a href="https://rdrr.io/r/graphics/abline.html">abline()</a></code> (and other functions that modify plots) will work. You will get <code>Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...) :</code> <code>plot.new has not been called yet</code></p>
<p>At this point you have check that you are happy with the numbers used for the top and bottom of the gel. Adjust and replot if needed.</p>
<p>I like to add a vertical line in the marker lane to help guide my later measures.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Add a vertical line in the marker lane. Again, make sure you run all of the plotting code:</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot gel</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gel_cropped</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'gel_cropped' not found</code></pre>
</div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add a horizontal lines for the top and bottom of the gel</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">gel_top</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet</code></pre>
</div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">gel_bottom</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet</code></pre>
</div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add a vertical line in the marker lane as a guide to help with locator</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">220</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): plot.new has not been called yet</code></pre>
</div>
</div>
<p>We are now ready to measure the band positions using the <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code> function. We need to measure the position of shPatB and the all the marker proteins. We will start with shPatB:</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Run the <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code> command and click on the shPatB in lane 4:</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dist_to_patB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/locator.html">locator</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The (<em>x</em>,<em>y</em>) position of shPatB is now stored in an R object called `pos_patB.</p>
<p>The distance between the shPatB band and the top of the gel will be the <em>y</em>0value in <code>dist_to_patB</code> minus the distance to the top of the gel.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Calculate the distance from the top of the gel to shPatB:</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pos_patB</span> <span class="op">&lt;-</span> <span class="va">dist_to_patB</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">gel_top</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have 9 bands so pass the argument <code>n = 9</code> to the function. This means you will need to click on the graph 9 times. Start at the top – the heaviest band – and work your way down. You only need to click once on each band. The R cursor will disappear until you have clicked 9 times. Don’t worry if you make a mistake, just click until the cursor is returned and run the locator command again to start afresh.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Run the <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code> command and click on the 9 bands in order from top to bottom:</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Number of bands in your marker lane</span></span>
<span><span class="co"># click from the top or gel to the bottom </span></span>
<span><span class="co"># i.e., high MW to low</span></span>
<span><span class="va">marker_positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/locator.html">locator</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Magic! The (<em>x</em>,<em>y</em>) position of each band is now stored in an R object called <code>marker_positions</code>.</p>
<p>We need to</p>
<ul>
<li>combine the <em>y</em> positions with molecular weights in <code>mw</code>
</li>
<li>calculate the distance to each band by substracting <code>gel_top</code>
</li>
<li>calculate <span class="math inline">\(R_f\)</span> values for the marker proteins using <span class="math inline">\(R_f = \frac{L - d}{L}\)</span> where <span class="math inline">\(L\)</span> is the length of the gel and <span class="math inline">\(d\)</span> is the distance to the band.</li>
<li>log the molecular weights of the marker proteins to make a linear relationship.</li>
</ul>
<p>We can put all these new columns in a dataframe called <code>mw_positions</code> frame using the <code>mutate()</code>.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Create <code>mw_positions</code> from <code>mw</code> and the <em>y</em> positions in <code>marker_positions</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mw_positions</span> <span class="op">&lt;-</span> <span class="va">mw</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>y <span class="op">=</span> <span class="va">marker_positions</span><span class="op">$</span><span class="va">y</span>,</span>
<span>         dist_to_band <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">gel_top</span>,</span>
<span>         Rf <span class="op">=</span> <span class="op">(</span><span class="va">gel_length</span> <span class="op">-</span> <span class="va">dist_to_band</span><span class="op">)</span> <span class="op">/</span> <span class="va">gel_length</span>,</span>
<span>         log_kda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">kda</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The process is now exactly the same as it was for Option 1.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Plot the data with <code>geom_point()</code> and add a linear regression line with <code>geom_smooth(method = "lm")</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mw_positions</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Rf</span>, y <span class="op">=</span> <span class="va">log_kda</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-43-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="workshop_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Fit a linear model so we have the equation of the line</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">log_kda</span> <span class="op">~</span> <span class="va">Rf</span>, data <span class="op">=</span> <span class="va">mw_positions</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Print the model:</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_kda ~ Rf, data = mw_positions)

Coefficients:
(Intercept)           Rf  
      1.091        5.231  </code></pre>
</div>
</div>
<p>We only need to print the coefficients – we don’t care about the statistical tests here. You can tell from the plot that the relationship is very tight and linear. The equation of the line is: <span class="math inline">\(MW\)</span>= 5.231 * <span class="math inline">\(R_f\)</span> + 1.091</p>
<p>You can substitute the values of the coefficients and the <span class="math inline">\(R_f\)</span> of ShpatB to find the log molecular weight of ShPatB. Or you can use the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function to do this for you.</p>
<p><img src="images/do_in_R.png" class="img-fluid"> Calculate the <span class="math inline">\(R_f\)</span> of ShPatB:</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patB_Rf</span> <span class="op">=</span> <span class="op">(</span><span class="va">gel_length</span> <span class="op">-</span> <span class="va">pos_patB</span><span class="op">)</span> <span class="op">/</span> <span class="va">gel_length</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/do_in_R.png" class="img-fluid"> Predict the molecular weight ShPatB:</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">patB_kda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Rf <span class="op">=</span> <span class="va">patB_Rf</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">patB_kda</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
43.69469 </code></pre>
</div>
</div>
<p>If you would like to practice Option 2 again, you could repeat the the steps using the set of results on the other side of the gel.</p>
</section></section><section id="look-after-future-you" class="level2"><h2 class="anchored" data-anchor-id="look-after-future-you">Look after future you!</h2>
<p>Future you will submit scripts for the assessment and these need to be organised, well-formatted, concise and well-commented so others can understand what you did and why.</p>
<p>You might need to:</p>
<ul>
<li>collect together library statements at the beginning of the code</li>
<li>edit your comments for clarity and include a paragraph explaining what the analysis is about add code section headers (Ctrl+Shift+R)</li>
<li>rename variables for consistency or clarity</li>
<li>remove house keeping or exploratory code or mark it for later removal</li>
<li>restyle code indentation (Ctrl+i) if needed</li>
<li>check whitespace and line length.</li>
</ul>
<p>You will find it useful to change some options in RStudio to make your life easier. Revisit <a href="https://3mmarand.github.io/comp4biosci/first-steps-rstudio.html#changing-some-defaults-to-make-life-easier">Changing some defaults to make life easier</a>.</p>
<p>If you need to make additional notes that do not belong in the script, you can add them a text file called <code>README.txt</code> that future you – and anyone else will know exactly what to do with!</p>
<p>You’re finished!</p>
</section></section><section id="well-done" class="level1"><h1>🥳 Well Done! 🎉</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/lenght-length.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Artwork by @allison_horst: “length typos”"><img src="images/lenght-length.png" class="img-fluid figure-img" alt="Comic panels of an alligator trying to debug some code. First panel: A confident looking alligator gets an error message. Second panel: a few minutes later, the error remains and the alligator is looking carefully at their code. Third panel: 10 minutes after that, the error remains and the alligator is giving a frustrated 'RAAAR' while desperately typing. Fourth panel: The error remains, and the alligator looks exhausted and exasperated, and a thought bubble reads 'maybe it's a bug'. Fifth panel: A friendly flamingo comes over to take a look, and reads aloud from the problematic code a spelling error: 'L-E-N-G-H-T'. Only the tail of the alligator is visible as it stomp stomp stomps out of the panel roaring." width="800"></a></p>
<figcaption>Artwork by <span class="citation" data-cites="allison_horst">Horst (<a href="#ref-allison_horst" role="doc-biblioref">2023</a>)</span>: “length typos”</figcaption></figure>
</div>
</section><section id="independent-study-following-the-workshop" class="level1"><h1>Independent study following the workshop</h1>
<p><a href="../../r4babs2/week-2/study_after_workshop.html">Consolidate</a></p>
</section><section id="the-code-file" class="level1"><h1>The Code file</h1>
<p>This contains all the code needed in the workshop even where it is not visible on the webpage.</p>
<p>The <code>workshop.qmd</code> file is the file I use to compile the practical. Qmd stands for Quarto markdown. It allows code and ordinary text to be interweaved to produce well-formatted reports including webpages. View the source code for this workshop using the <code>&lt;/&gt; Code</code> button at the top of the page. Coding and thinking answers are marked with <code>#---CODING ANSWER---</code> and <code>#---THINKING ANSWER---</code></p>
<p>Pages made with R <span class="citation" data-cites="R-core">(<a href="#ref-R-core" role="doc-biblioref">R Core Team 2024</a>)</span>, Quarto <span class="citation" data-cites="allaire2022">(<a href="#ref-allaire2022" role="doc-biblioref">Allaire et al. 2022</a>)</span>, <code>knitr</code> <span class="citation" data-cites="knitr1 knitr2 knitr3">(<a href="#ref-knitr1" role="doc-biblioref">Xie 2024</a>, <a href="#ref-knitr2" role="doc-biblioref">2015</a>, <a href="#ref-knitr3" role="doc-biblioref">2014</a>)</span>, <code>kableExtra</code> <span class="citation" data-cites="kableExtra">(<a href="#ref-kableExtra" role="doc-biblioref">Zhu 2024</a>)</span></p>
</section><section id="references" class="level1">


<!-- -->


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-allaire2022" class="csl-entry" role="listitem">
Allaire, J. J., Charles Teague, Carlos Scheidegger, Yihui Xie, and Christophe Dervieux. 2022. <em>Quarto</em>. <a href="https://doi.org/10.5281/zenodo.5960048">https://doi.org/10.5281/zenodo.5960048</a>.
</div>
<div id="ref-allison_horst" class="csl-entry" role="listitem">
Horst, Allison. 2023. <span>“Data Science Illustrations.”</span> <a href="https://allisonhorst.com/allison-horst">https://allisonhorst.com/allison-horst</a>.
</div>
<div id="ref-R-core" class="csl-entry" role="listitem">
R Core Team. 2024. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-rand2023" class="csl-entry" role="listitem">
Rand, Emma. 2023. <em>Data Analysis in r for Becoming a Bioscientist</em>. <a href="https://3mmarand.github.io/R4BABS/">https://3mmarand.github.io/R4BABS/</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span></span>Tidyverse<span></span>”</span> 4: 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-knitr3" class="csl-entry" role="listitem">
Xie, Yihui. 2014. <span>“Knitr: A Comprehensive Tool for Reproducible Research in <span>R</span>.”</span> In <em>Implementing Reproducible Computational Research</em>, edited by Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman; Hall/CRC.
</div>
<div id="ref-knitr2" class="csl-entry" role="listitem">
———. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-knitr1" class="csl-entry" role="listitem">
———. 2024. <em>Knitr: A General-Purpose Package for Dynamic Report Generation in r</em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-kableExtra" class="csl-entry" role="listitem">
Zhu, Hao. 2024. <em>kableExtra: Construct Complex Table with ’Kable’ and Pipe Syntax</em>. <a href="https://CRAN.R-project.org/package=kableExtra">https://CRAN.R-project.org/package=kableExtra</a>.
</div>
</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("^(?:http:|https:)\/\/3mmarand\.github\.io\/R4BABS");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb72" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Workshop"</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Introduction to statistical models: Single linear regression"</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="an">toc-location:</span><span class="co"> right</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>![Artwork by @allison_horst: "linear regression</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>dragons"](images/linear-regression-dragon.png){fig-alt="Two blue dragons stand on scales next to a vertical yardstick showing one slightly taller than the other. Regression estimates are shown at the top as an equation: 'weight (tons) = 2.4 + 0.3*height', with explanatory text reading 'If all other variables are constant, we expect a 1 foot taller dragon to weight 0.3 tons more, on average.'"</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>width="800"}</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session overview</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>In this session you will carry out, interpret and report a single linear</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>regression.</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Philosophy</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>Workshops are not a test. It is expected that you often don't know how</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>to start, make a lot of mistakes and need help. It is expected that you</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>are familiar with independent study content before the workshop.</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>However, you need not remember or understand every detail as the</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>workshop should build and consolidate your understanding. Tips</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>don't worry about making mistakes</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>don't let what you can not do interfere with what you can do</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>discussing code with your neighbours will help</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>look things up in the independent study material</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>look things up in your own code from earlier</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>there are no stupid questions</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key</span></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>These four symbols are used at the beginning of each instruction so you</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>know where to carry out the instruction.</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_on_your_computer.png)</span> Something you need to do on your</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>computer. It may be opening programs or documents or locating a file.</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Something you should do in RStudio. It will</span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a>often be typing a command or using the menus but might also be creating</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>folders, locating or moving files.</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_on_internet.png)</span> Something you should do in your browser</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>on the internet. It may be searching for information, going to the VLE</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>or downloading a file.</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/answer.png)</span> A question for you to think about and answer.</span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>Record your answers in your script for future reference.</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a><span class="fu"># Getting started</span></span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_on_your_computer.png)</span> Start RStudio from the Start menu.</span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Make an RStudio project for this workshop by</span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a>clicking on the drop-down menu on top right where it says</span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a><span class="in">`Project: (None)`</span> and choosing New Project, then New Directory, then New</span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a>Project. Navigate to the <span class="in">`data-analysis-in-r-2`</span> folder and name the</span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a>RStudio Project <span class="in">`week-2`</span>.</span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Make new folders called <span class="in">`data-raw`</span> and</span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a><span class="in">`figures`</span>. You can do this on the Files Pane by clicking New Folder and</span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a>typing into the box that appears.</span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Make a new script then save it with a name like</span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a><span class="in">`single-linear-regression.R`</span> to carry out the rest of the work.</span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Add a comment to the script:</span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a><span class="in">`# Introduction to statistical models: Single linear-regression`</span> and</span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a>load the **`tidyverse`** <span class="co">[</span><span class="ot">@tidyverse</span><span class="co">]</span> package</span>
<span id="cb72-83"><a href="#cb72-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-84"><a href="#cb72-84" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercises</span></span>
<span id="cb72-85"><a href="#cb72-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-86"><a href="#cb72-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear Regression</span></span>
<span id="cb72-87"><a href="#cb72-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-88"><a href="#cb72-88" aria-hidden="true" tabindex="-1"></a>The data in <span class="co">[</span><span class="ot">plant.xlsx</span><span class="co">](data-raw/plant.xlsx)</span> is a set of observations</span>
<span id="cb72-89"><a href="#cb72-89" aria-hidden="true" tabindex="-1"></a>of plant growth over two months. The researchers planted the seeds and</span>
<span id="cb72-90"><a href="#cb72-90" aria-hidden="true" tabindex="-1"></a>harvested, dried and weighed a plant each day from day 10 so all the</span>
<span id="cb72-91"><a href="#cb72-91" aria-hidden="true" tabindex="-1"></a>data points are independent of each other.</span>
<span id="cb72-92"><a href="#cb72-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-93"><a href="#cb72-93" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Save a copy of <span class="co">[</span><span class="ot">plant.xlsx</span><span class="co">](data-raw/plant.xlsx)</span></span>
<span id="cb72-94"><a href="#cb72-94" aria-hidden="true" tabindex="-1"></a>to your <span class="in">`data-raw`</span> folder and import it.</span>
<span id="cb72-95"><a href="#cb72-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-98"><a href="#cb72-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-99"><a href="#cb72-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb72-100"><a href="#cb72-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-101"><a href="#cb72-101" aria-hidden="true" tabindex="-1"></a><span class="co">#---CODING ANSWER---</span></span>
<span id="cb72-102"><a href="#cb72-102" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb72-103"><a href="#cb72-103" aria-hidden="true" tabindex="-1"></a><span class="co"># we need the readxl package that was introduced in the last workshop</span></span>
<span id="cb72-104"><a href="#cb72-104" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb72-105"><a href="#cb72-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-106"><a href="#cb72-106" aria-hidden="true" tabindex="-1"></a><span class="co"># assign file name to variable because I'll use it more than once</span></span>
<span id="cb72-107"><a href="#cb72-107" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">"data-raw/plant.xlsx"</span></span>
<span id="cb72-108"><a href="#cb72-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-109"><a href="#cb72-109" aria-hidden="true" tabindex="-1"></a><span class="co"># list the sheets in the file</span></span>
<span id="cb72-110"><a href="#cb72-110" aria-hidden="true" tabindex="-1"></a><span class="fu">excel_sheets</span>(file)</span>
<span id="cb72-111"><a href="#cb72-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-112"><a href="#cb72-112" aria-hidden="true" tabindex="-1"></a><span class="co"># You might want to open th file in excel to make sure you know what is in it. </span></span>
<span id="cb72-113"><a href="#cb72-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-114"><a href="#cb72-114" aria-hidden="true" tabindex="-1"></a><span class="co"># I'm a bit lazy - and less worried by being wrong - so will just guess the </span></span>
<span id="cb72-115"><a href="#cb72-115" aria-hidden="true" tabindex="-1"></a><span class="co"># are data in the one named sheet. If I guess wrong, then I might open the file!</span></span>
<span id="cb72-116"><a href="#cb72-116" aria-hidden="true" tabindex="-1"></a>plant <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(file, <span class="at">sheet =</span> <span class="st">"plant"</span>)</span>
<span id="cb72-117"><a href="#cb72-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-118"><a href="#cb72-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-119"><a href="#cb72-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-120"><a href="#cb72-120" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/answer.png)</span> What type of variables do you have? Which is the</span>
<span id="cb72-121"><a href="#cb72-121" aria-hidden="true" tabindex="-1"></a>response and which is the explanatory? What is the null hypothesis?</span>
<span id="cb72-122"><a href="#cb72-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-123"><a href="#cb72-123" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #---THINKING ANSWER---  --&gt;</span></span>
<span id="cb72-124"><a href="#cb72-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-125"><a href="#cb72-125" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Day is discrete (but ordered) and is the explanatory; mass looks continuous and  --&gt;</span></span>
<span id="cb72-126"><a href="#cb72-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-127"><a href="#cb72-127" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- is the response.  --&gt;</span></span>
<span id="cb72-128"><a href="#cb72-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-129"><a href="#cb72-129" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The null hypothesis can be expressed as one of the following: day does not  --&gt;</span></span>
<span id="cb72-130"><a href="#cb72-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-131"><a href="#cb72-131" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- explain the variation in mass; there is no linear relationship between  --&gt;</span></span>
<span id="cb72-132"><a href="#cb72-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-133"><a href="#cb72-133" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- day and mass; slope of the best fitting straight line is zero --&gt;</span></span>
<span id="cb72-134"><a href="#cb72-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-135"><a href="#cb72-135" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exploring</span></span>
<span id="cb72-136"><a href="#cb72-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-137"><a href="#cb72-137" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Do a quick plot of the data:</span>
<span id="cb72-138"><a href="#cb72-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-141"><a href="#cb72-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-142"><a href="#cb72-142" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plant, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> mass)) <span class="sc">+</span></span>
<span id="cb72-143"><a href="#cb72-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb72-144"><a href="#cb72-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-145"><a href="#cb72-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-146"><a href="#cb72-146" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/answer.png)</span> What are the assumptions of linear regression? Do</span>
<span id="cb72-147"><a href="#cb72-147" aria-hidden="true" tabindex="-1"></a>these seem to be met?</span>
<span id="cb72-148"><a href="#cb72-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-149"><a href="#cb72-149" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #---THINKING ANSWER--- --&gt;</span></span>
<span id="cb72-150"><a href="#cb72-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-151"><a href="#cb72-151" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- linear relationship - looks ok on the scatter --&gt;</span></span>
<span id="cb72-152"><a href="#cb72-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-153"><a href="#cb72-153" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- each y is drawn from a normal distribution for each x and these  --&gt;</span></span>
<span id="cb72-154"><a href="#cb72-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-155"><a href="#cb72-155" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- normal distributions have the same variance - looks ok too.  --&gt;</span></span>
<span id="cb72-156"><a href="#cb72-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-157"><a href="#cb72-157" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We'd expect y to be continuous and the scatter around a best fitting line  --&gt;</span></span>
<span id="cb72-158"><a href="#cb72-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-159"><a href="#cb72-159" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- we imagine is about even. --&gt;</span></span>
<span id="cb72-160"><a href="#cb72-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-161"><a href="#cb72-161" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The values of y are independent of each other - yes it was a different  --&gt;</span></span>
<span id="cb72-162"><a href="#cb72-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-163"><a href="#cb72-163" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- plant each day (in fact plant was destroyed). Measuring the height  --&gt;</span></span>
<span id="cb72-164"><a href="#cb72-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-165"><a href="#cb72-165" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- of the SAME plants each day would violate this assumption --&gt;</span></span>
<span id="cb72-166"><a href="#cb72-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-167"><a href="#cb72-167" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- x has been chosen by the experimenter - yes. --&gt;</span></span>
<span id="cb72-168"><a href="#cb72-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-169"><a href="#cb72-169" aria-hidden="true" tabindex="-1"></a><span class="fu">### Applying, interpreting and reporting</span></span>
<span id="cb72-170"><a href="#cb72-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-171"><a href="#cb72-171" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> We now carry out a regression assigning the</span>
<span id="cb72-172"><a href="#cb72-172" aria-hidden="true" tabindex="-1"></a>result of the <span class="in">`lm()`</span> procedure to a variable and examining it with</span>
<span id="cb72-173"><a href="#cb72-173" aria-hidden="true" tabindex="-1"></a><span class="in">`summary()`</span>.</span>
<span id="cb72-174"><a href="#cb72-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-177"><a href="#cb72-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-178"><a href="#cb72-178" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> plant, mass <span class="sc">~</span> day)</span>
<span id="cb72-179"><a href="#cb72-179" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb72-180"><a href="#cb72-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-181"><a href="#cb72-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-182"><a href="#cb72-182" aria-hidden="true" tabindex="-1"></a>The Estimates in the Coefficients table give the intercept (first line)</span>
<span id="cb72-183"><a href="#cb72-183" aria-hidden="true" tabindex="-1"></a>and the slope (second line) of the best fitting straight line. The</span>
<span id="cb72-184"><a href="#cb72-184" aria-hidden="true" tabindex="-1"></a>*p*-values on the same line are tests of whether that coefficient is</span>
<span id="cb72-185"><a href="#cb72-185" aria-hidden="true" tabindex="-1"></a>different from zero.</span>
<span id="cb72-186"><a href="#cb72-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-187"><a href="#cb72-187" aria-hidden="true" tabindex="-1"></a>The *F* value and *p*-value in the last line are a test of whether the</span>
<span id="cb72-188"><a href="#cb72-188" aria-hidden="true" tabindex="-1"></a>model as a whole explains a significant amount of variation in the</span>
<span id="cb72-189"><a href="#cb72-189" aria-hidden="true" tabindex="-1"></a>dependent variable. For a single linear regression this is exactly</span>
<span id="cb72-190"><a href="#cb72-190" aria-hidden="true" tabindex="-1"></a>equivalent to the test of the slope against zero.</span>
<span id="cb72-191"><a href="#cb72-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-192"><a href="#cb72-192" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/answer.png)</span> What is the equation of the line? What do you</span>
<span id="cb72-193"><a href="#cb72-193" aria-hidden="true" tabindex="-1"></a>conclude from the analysis?</span>
<span id="cb72-194"><a href="#cb72-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-195"><a href="#cb72-195" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #---THINKING ANSWER--- --&gt;</span></span>
<span id="cb72-196"><a href="#cb72-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-197"><a href="#cb72-197" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- mass = 1.606*day - 8.683 --&gt;</span></span>
<span id="cb72-198"><a href="#cb72-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-199"><a href="#cb72-199" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- the slope of the line is significantly different from zero OR --&gt;</span></span>
<span id="cb72-200"><a href="#cb72-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-201"><a href="#cb72-201" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- the day explains a significant amount of the variation in mass OR --&gt;</span></span>
<span id="cb72-202"><a href="#cb72-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-203"><a href="#cb72-203" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- mass can be predicted from the day (ANOVA: F = 88.4; d.f. = 1,49; p &lt; 0.0001).  --&gt;</span></span>
<span id="cb72-204"><a href="#cb72-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-205"><a href="#cb72-205" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/answer.png)</span> Does the line go through (0,0)?</span>
<span id="cb72-206"><a href="#cb72-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-207"><a href="#cb72-207" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #---THINKING ANSWER--- --&gt;</span></span>
<span id="cb72-208"><a href="#cb72-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-209"><a href="#cb72-209" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- yes it could. The intercept is -8.683 but it is not significantly  --&gt;</span></span>
<span id="cb72-210"><a href="#cb72-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-211"><a href="#cb72-211" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- different from zero thus it could be zero.  --&gt;</span></span>
<span id="cb72-212"><a href="#cb72-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-213"><a href="#cb72-213" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/answer.png)</span> What percentage of variation is explained by the</span>
<span id="cb72-214"><a href="#cb72-214" aria-hidden="true" tabindex="-1"></a>line?</span>
<span id="cb72-215"><a href="#cb72-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-216"><a href="#cb72-216" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #---THINKING ANSWER--- --&gt;</span></span>
<span id="cb72-217"><a href="#cb72-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-218"><a href="#cb72-218" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 64%  --&gt;</span></span>
<span id="cb72-219"><a href="#cb72-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-220"><a href="#cb72-220" aria-hidden="true" tabindex="-1"></a>It might be useful to assign the slope and the intercept to variables in</span>
<span id="cb72-221"><a href="#cb72-221" aria-hidden="true" tabindex="-1"></a>case we need them later. The can be accessed in the <span class="in">`mod$coefficients`</span></span>
<span id="cb72-222"><a href="#cb72-222" aria-hidden="true" tabindex="-1"></a>variable:</span>
<span id="cb72-223"><a href="#cb72-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-226"><a href="#cb72-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-227"><a href="#cb72-227" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>coefficients</span>
<span id="cb72-228"><a href="#cb72-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-229"><a href="#cb72-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-230"><a href="#cb72-230" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Assign <span class="in">`mod$coefficients[1]`</span> to <span class="in">`b0`</span> and</span>
<span id="cb72-231"><a href="#cb72-231" aria-hidden="true" tabindex="-1"></a><span class="in">`mod$coefficients[1]`</span> to <span class="in">`b1`</span>:</span>
<span id="cb72-232"><a href="#cb72-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-235"><a href="#cb72-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-236"><a href="#cb72-236" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> mod<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb72-237"><a href="#cb72-237" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> mod<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb72-238"><a href="#cb72-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-239"><a href="#cb72-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-240"><a href="#cb72-240" aria-hidden="true" tabindex="-1"></a>I also rounded the values to two decimal places.</span>
<span id="cb72-241"><a href="#cb72-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-242"><a href="#cb72-242" aria-hidden="true" tabindex="-1"></a><span class="fu">### Checking assumptions</span></span>
<span id="cb72-243"><a href="#cb72-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-244"><a href="#cb72-244" aria-hidden="true" tabindex="-1"></a>We need to examine the residuals. Very conveniently, the object which is</span>
<span id="cb72-245"><a href="#cb72-245" aria-hidden="true" tabindex="-1"></a>created by <span class="in">`lm()`</span> contains a variable called <span class="in">`$residuals`</span>. Also</span>
<span id="cb72-246"><a href="#cb72-246" aria-hidden="true" tabindex="-1"></a>conveniently, the R's <span class="in">`plot()`</span> function can used on the output objects</span>
<span id="cb72-247"><a href="#cb72-247" aria-hidden="true" tabindex="-1"></a>of <span class="in">`lm()`</span>. The assumptions of the GLM demand that each *y* is drawn from</span>
<span id="cb72-248"><a href="#cb72-248" aria-hidden="true" tabindex="-1"></a>a normal distribution for each *x* and these normal distributions have</span>
<span id="cb72-249"><a href="#cb72-249" aria-hidden="true" tabindex="-1"></a>the same variance. Therefore, we plot the residuals against the fitted</span>
<span id="cb72-250"><a href="#cb72-250" aria-hidden="true" tabindex="-1"></a>values to see if the variance is the same for all the values of *x*. The</span>
<span id="cb72-251"><a href="#cb72-251" aria-hidden="true" tabindex="-1"></a>fitted - or predicted - values are the values on the line of best fit.</span>
<span id="cb72-252"><a href="#cb72-252" aria-hidden="true" tabindex="-1"></a>Each residual is the difference between the fitted values and the</span>
<span id="cb72-253"><a href="#cb72-253" aria-hidden="true" tabindex="-1"></a>observed value.</span>
<span id="cb72-254"><a href="#cb72-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-255"><a href="#cb72-255" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Plot the model residuals against the fitted</span>
<span id="cb72-256"><a href="#cb72-256" aria-hidden="true" tabindex="-1"></a>values like this:</span>
<span id="cb72-257"><a href="#cb72-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-260"><a href="#cb72-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-261"><a href="#cb72-261" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb72-262"><a href="#cb72-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-263"><a href="#cb72-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-264"><a href="#cb72-264" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/answer.png)</span> What to you conclude?</span>
<span id="cb72-265"><a href="#cb72-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-266"><a href="#cb72-266" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #---THINKING ANSWER--- --&gt;</span></span>
<span id="cb72-267"><a href="#cb72-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-268"><a href="#cb72-268" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The residuals look 'homogeneously' distributed. That is, the variance is the same  --&gt;</span></span>
<span id="cb72-269"><a href="#cb72-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-270"><a href="#cb72-270" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- for all the values of x.  --&gt;</span></span>
<span id="cb72-271"><a href="#cb72-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-272"><a href="#cb72-272" aria-hidden="true" tabindex="-1"></a>To examine normality of the model residuals we can plot them as a</span>
<span id="cb72-273"><a href="#cb72-273" aria-hidden="true" tabindex="-1"></a>histogram and do a normality test on them.</span>
<span id="cb72-274"><a href="#cb72-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-275"><a href="#cb72-275" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Plot a histogram of the residuals:</span>
<span id="cb72-276"><a href="#cb72-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-279"><a href="#cb72-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-280"><a href="#cb72-280" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mod<span class="sc">$</span>residuals)) <span class="sc">+</span> </span>
<span id="cb72-281"><a href="#cb72-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>)</span>
<span id="cb72-282"><a href="#cb72-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-283"><a href="#cb72-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-284"><a href="#cb72-284" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Use the <span class="in">`shapiro.test()`</span> to test the normality</span>
<span id="cb72-285"><a href="#cb72-285" aria-hidden="true" tabindex="-1"></a>of the model residuals</span>
<span id="cb72-286"><a href="#cb72-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-289"><a href="#cb72-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-290"><a href="#cb72-290" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(mod<span class="sc">$</span>residuals)</span>
<span id="cb72-291"><a href="#cb72-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-292"><a href="#cb72-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-293"><a href="#cb72-293" aria-hidden="true" tabindex="-1"></a>Usually, when we are doing statistical tests we would like the the test</span>
<span id="cb72-294"><a href="#cb72-294" aria-hidden="true" tabindex="-1"></a>to be significant because it means we have evidence of a biological</span>
<span id="cb72-295"><a href="#cb72-295" aria-hidden="true" tabindex="-1"></a>effect. However, when doing normality tests we hope it will not be</span>
<span id="cb72-296"><a href="#cb72-296" aria-hidden="true" tabindex="-1"></a>significant. A non-significant result means that there is no significant</span>
<span id="cb72-297"><a href="#cb72-297" aria-hidden="true" tabindex="-1"></a>difference between the distribution of the residuals and a normal</span>
<span id="cb72-298"><a href="#cb72-298" aria-hidden="true" tabindex="-1"></a>distribution and that indicates the assumptions are met.</span>
<span id="cb72-299"><a href="#cb72-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-300"><a href="#cb72-300" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/answer.png)</span> What to you conclude?</span>
<span id="cb72-301"><a href="#cb72-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-302"><a href="#cb72-302" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #---THINKING ANSWER--- --&gt;</span></span>
<span id="cb72-303"><a href="#cb72-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-304"><a href="#cb72-304" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- the residuals appear roughly normally distributed.  --&gt;</span></span>
<span id="cb72-305"><a href="#cb72-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-306"><a href="#cb72-306" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The histogram is symmetrical and the shapiro test is NS. --&gt;</span></span>
<span id="cb72-307"><a href="#cb72-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-308"><a href="#cb72-308" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Overall, it seems the assumptions are met --&gt;</span></span>
<span id="cb72-309"><a href="#cb72-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-310"><a href="#cb72-310" aria-hidden="true" tabindex="-1"></a><span class="fu">### Illustrating</span></span>
<span id="cb72-311"><a href="#cb72-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-312"><a href="#cb72-312" aria-hidden="true" tabindex="-1"></a>We want a figure with the points and the statistical model, i.e., the</span>
<span id="cb72-313"><a href="#cb72-313" aria-hidden="true" tabindex="-1"></a>best fitting straight line.</span>
<span id="cb72-314"><a href="#cb72-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-315"><a href="#cb72-315" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Create a scatter plot using <span class="in">`geom_point()`</span></span>
<span id="cb72-316"><a href="#cb72-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-319"><a href="#cb72-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-320"><a href="#cb72-320" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plant, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> mass)) <span class="sc">+</span></span>
<span id="cb72-321"><a href="#cb72-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb72-322"><a href="#cb72-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb72-323"><a href="#cb72-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-324"><a href="#cb72-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-325"><a href="#cb72-325" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> The <span class="in">`geom_smooth()`</span> function will add a variety</span>
<span id="cb72-326"><a href="#cb72-326" aria-hidden="true" tabindex="-1"></a>of fitted lines to a plot. We want a straight line so we need to specify</span>
<span id="cb72-327"><a href="#cb72-327" aria-hidden="true" tabindex="-1"></a><span class="in">`method = "lm"`</span>:</span>
<span id="cb72-328"><a href="#cb72-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-331"><a href="#cb72-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-332"><a href="#cb72-332" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plant, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> mass)) <span class="sc">+</span></span>
<span id="cb72-333"><a href="#cb72-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>   </span>
<span id="cb72-334"><a href="#cb72-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb72-335"><a href="#cb72-335" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb72-336"><a href="#cb72-336" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-337"><a href="#cb72-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb72-338"><a href="#cb72-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-339"><a href="#cb72-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-340"><a href="#cb72-340" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> What do the <span class="in">`se`</span> and <span class="in">`colour`</span> arguments do? Try</span>
<span id="cb72-341"><a href="#cb72-341" aria-hidden="true" tabindex="-1"></a>changing them.</span>
<span id="cb72-342"><a href="#cb72-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-343"><a href="#cb72-343" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Let's add the equation of the line to the figure</span>
<span id="cb72-344"><a href="#cb72-344" aria-hidden="true" tabindex="-1"></a>using <span class="in">`annotate()`</span>:</span>
<span id="cb72-345"><a href="#cb72-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-348"><a href="#cb72-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-349"><a href="#cb72-349" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plant, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> mass)) <span class="sc">+</span></span>
<span id="cb72-350"><a href="#cb72-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-351"><a href="#cb72-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb72-352"><a href="#cb72-352" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb72-353"><a href="#cb72-353" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-354"><a href="#cb72-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> <span class="dv">110</span>, </span>
<span id="cb72-355"><a href="#cb72-355" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"mass = 1.61 * day - 8.68"</span>) <span class="sc">+</span></span>
<span id="cb72-356"><a href="#cb72-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb72-357"><a href="#cb72-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-358"><a href="#cb72-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-359"><a href="#cb72-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-360"><a href="#cb72-360" aria-hidden="true" tabindex="-1"></a>We have to tell <span class="in">`annotate()`</span> what type of geom we want - <span class="in">`text`</span> in this</span>
<span id="cb72-361"><a href="#cb72-361" aria-hidden="true" tabindex="-1"></a>case, - where to put it, and the text we want to appear.</span>
<span id="cb72-362"><a href="#cb72-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-363"><a href="#cb72-363" aria-hidden="true" tabindex="-1"></a>Instead of hardcoding the equation, we can use the values of <span class="in">`b0`</span> and</span>
<span id="cb72-364"><a href="#cb72-364" aria-hidden="true" tabindex="-1"></a><span class="in">`b1`</span> that we assigned earlier. This is a neat trick that makes or work</span>
<span id="cb72-365"><a href="#cb72-365" aria-hidden="true" tabindex="-1"></a>more reproducible. If the data were updated, we would not need to change</span>
<span id="cb72-366"><a href="#cb72-366" aria-hidden="true" tabindex="-1"></a>the equation in the figure.</span>
<span id="cb72-367"><a href="#cb72-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-370"><a href="#cb72-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-371"><a href="#cb72-371" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plant, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> mass)) <span class="sc">+</span></span>
<span id="cb72-372"><a href="#cb72-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-373"><a href="#cb72-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb72-374"><a href="#cb72-374" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb72-375"><a href="#cb72-375" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-376"><a href="#cb72-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> <span class="dv">110</span>, </span>
<span id="cb72-377"><a href="#cb72-377" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"mass = { b1 } * day {if (b0&lt;0) </span><span class="sc">\"</span><span class="st">-</span><span class="sc">\"</span><span class="st"> else </span><span class="sc">\"</span><span class="st">+</span><span class="sc">\"</span><span class="st">} { abs(b0) }"</span>) ) <span class="sc">+</span></span>
<span id="cb72-378"><a href="#cb72-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb72-379"><a href="#cb72-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-380"><a href="#cb72-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-381"><a href="#cb72-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-382"><a href="#cb72-382" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The <span class="in">`glue::glue()`</span> function allows us to use variables in the text -</span>
<span id="cb72-383"><a href="#cb72-383" aria-hidden="true" tabindex="-1"></a>    the variables go inside curly braces</span>
<span id="cb72-384"><a href="#cb72-384" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`{ b1 }`</span> and <span class="in">`{ abs(b0) }`</span> are the variables we assigned earlier and</span>
<span id="cb72-385"><a href="#cb72-385" aria-hidden="true" tabindex="-1"></a>    they will be replaced with their values in the text.</span>
<span id="cb72-386"><a href="#cb72-386" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The <span class="in">`if (b0&lt;0) \"-\" else \"+\"`</span> part is a conditional that adds a</span>
<span id="cb72-387"><a href="#cb72-387" aria-hidden="true" tabindex="-1"></a>    minus sign if the intercept is negative and a plus sign if it is</span>
<span id="cb72-388"><a href="#cb72-388" aria-hidden="true" tabindex="-1"></a>    positive. The <span class="in">`abs(b0)`</span> part makes sure we only show the absolute</span>
<span id="cb72-389"><a href="#cb72-389" aria-hidden="true" tabindex="-1"></a>    value of the intercept.</span>
<span id="cb72-390"><a href="#cb72-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-391"><a href="#cb72-391" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Improve the axes. You may need to refer back</span>
<span id="cb72-392"><a href="#cb72-392" aria-hidden="true" tabindex="-1"></a>[Changing the</span>
<span id="cb72-393"><a href="#cb72-393" aria-hidden="true" tabindex="-1"></a>axes](../../r4babs1/week-7/workshop.html#changing-the-axes) from the</span>
<span id="cb72-394"><a href="#cb72-394" aria-hidden="true" tabindex="-1"></a>Week 7 workshop in BABS1 <span class="co">[</span><span class="ot">@rand2023</span><span class="co">]</span></span>
<span id="cb72-395"><a href="#cb72-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-398"><a href="#cb72-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-399"><a href="#cb72-399" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb72-400"><a href="#cb72-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-401"><a href="#cb72-401" aria-hidden="true" tabindex="-1"></a><span class="co">#---CODING ANSWER---</span></span>
<span id="cb72-402"><a href="#cb72-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-403"><a href="#cb72-403" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plant, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> mass)) <span class="sc">+</span></span>
<span id="cb72-404"><a href="#cb72-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-405"><a href="#cb72-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb72-406"><a href="#cb72-406" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb72-407"><a href="#cb72-407" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-408"><a href="#cb72-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Day"</span>,</span>
<span id="cb72-409"><a href="#cb72-409" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">65</span>),</span>
<span id="cb72-410"><a href="#cb72-410" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb72-411"><a href="#cb72-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Mass (g)"</span>,</span>
<span id="cb72-412"><a href="#cb72-412" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>),</span>
<span id="cb72-413"><a href="#cb72-413" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb72-414"><a href="#cb72-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> <span class="dv">110</span>, </span>
<span id="cb72-415"><a href="#cb72-415" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"mass = { b1 } * day {if (b0&lt;0) </span><span class="sc">\"</span><span class="st">-</span><span class="sc">\"</span><span class="st"> else </span><span class="sc">\"</span><span class="st">+</span><span class="sc">\"</span><span class="st">} { abs(b0) }"</span>) ) <span class="sc">+</span></span>
<span id="cb72-416"><a href="#cb72-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb72-417"><a href="#cb72-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-418"><a href="#cb72-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-419"><a href="#cb72-419" aria-hidden="true" tabindex="-1"></a><span class="co"># note that we need to use the continuous versions of both scale_</span></span>
<span id="cb72-420"><a href="#cb72-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-421"><a href="#cb72-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-422"><a href="#cb72-422" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Save your figure to your <span class="in">`figures`</span> folder. Make</span>
<span id="cb72-423"><a href="#cb72-423" aria-hidden="true" tabindex="-1"></a>sure you [script figure saving with</span>
<span id="cb72-424"><a href="#cb72-424" aria-hidden="true" tabindex="-1"></a><span class="in">`ggsave()`</span>](../../r4babs1/week-9/workshop.html#writing-figures-to-file).</span>
<span id="cb72-425"><a href="#cb72-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-428"><a href="#cb72-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-429"><a href="#cb72-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb72-430"><a href="#cb72-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-431"><a href="#cb72-431" aria-hidden="true" tabindex="-1"></a><span class="co">#---CODING ANSWER---</span></span>
<span id="cb72-432"><a href="#cb72-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-433"><a href="#cb72-433" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the figure to a variable</span></span>
<span id="cb72-434"><a href="#cb72-434" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plant, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> mass)) <span class="sc">+</span></span>
<span id="cb72-435"><a href="#cb72-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-436"><a href="#cb72-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb72-437"><a href="#cb72-437" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb72-438"><a href="#cb72-438" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-439"><a href="#cb72-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Day"</span>,</span>
<span id="cb72-440"><a href="#cb72-440" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">65</span>),</span>
<span id="cb72-441"><a href="#cb72-441" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb72-442"><a href="#cb72-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Mass (g)"</span>,</span>
<span id="cb72-443"><a href="#cb72-443" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>),</span>
<span id="cb72-444"><a href="#cb72-444" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb72-445"><a href="#cb72-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> <span class="dv">110</span>, </span>
<span id="cb72-446"><a href="#cb72-446" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"mass = { b1 } * day {if (b0&lt;0) </span><span class="sc">\"</span><span class="st">-</span><span class="sc">\"</span><span class="st"> else </span><span class="sc">\"</span><span class="st">+</span><span class="sc">\"</span><span class="st">} { abs(b0) }"</span>) ) <span class="sc">+</span></span>
<span id="cb72-447"><a href="#cb72-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb72-448"><a href="#cb72-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-449"><a href="#cb72-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-450"><a href="#cb72-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-453"><a href="#cb72-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-454"><a href="#cb72-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb72-455"><a href="#cb72-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-456"><a href="#cb72-456" aria-hidden="true" tabindex="-1"></a><span class="co">#---CODING ANSWER---</span></span>
<span id="cb72-457"><a href="#cb72-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-458"><a href="#cb72-458" aria-hidden="true" tabindex="-1"></a><span class="co"># save figure to figures/plant-growth.png</span></span>
<span id="cb72-459"><a href="#cb72-459" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figures/plant-growth.png"</span>,</span>
<span id="cb72-460"><a href="#cb72-460" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> fig2,</span>
<span id="cb72-461"><a href="#cb72-461" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="fl">3.5</span>,</span>
<span id="cb72-462"><a href="#cb72-462" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="fl">3.5</span>,</span>
<span id="cb72-463"><a href="#cb72-463" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb72-464"><a href="#cb72-464" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb72-465"><a href="#cb72-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-466"><a href="#cb72-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-467"><a href="#cb72-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-468"><a href="#cb72-468" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear Regression for estimating molecular weights from gels</span></span>
<span id="cb72-469"><a href="#cb72-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-470"><a href="#cb72-470" aria-hidden="true" tabindex="-1"></a>In this section we will use a linear regression to estimate the</span>
<span id="cb72-471"><a href="#cb72-471" aria-hidden="true" tabindex="-1"></a>molecular weights of proteins from a gel. Gels are run with a marker</span>
<span id="cb72-472"><a href="#cb72-472" aria-hidden="true" tabindex="-1"></a>lane containing proteins of known molecular weights. The positions of</span>
<span id="cb72-473"><a href="#cb72-473" aria-hidden="true" tabindex="-1"></a>these marker proteins are used to create a standard curve that allows us</span>
<span id="cb72-474"><a href="#cb72-474" aria-hidden="true" tabindex="-1"></a>to estimate the molecular weights of other proteins in the gel.</span>
<span id="cb72-475"><a href="#cb72-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-476"><a href="#cb72-476" aria-hidden="true" tabindex="-1"></a>This is a different use for linear regression than the previous example</span>
<span id="cb72-477"><a href="#cb72-477" aria-hidden="true" tabindex="-1"></a>where we wanted to statistically test whether the an *x*-variable</span>
<span id="cb72-478"><a href="#cb72-478" aria-hidden="true" tabindex="-1"></a>explained the variation in a *y*-variable.</span>
<span id="cb72-479"><a href="#cb72-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-480"><a href="#cb72-480" aria-hidden="true" tabindex="-1"></a>Here we already know there is a very tight linear relationship between</span>
<span id="cb72-481"><a href="#cb72-481" aria-hidden="true" tabindex="-1"></a>the position of the marker proteins on the gel and their molecular</span>
<span id="cb72-482"><a href="#cb72-482" aria-hidden="true" tabindex="-1"></a>weights. We are using the linear regression to find the equation of the</span>
<span id="cb72-483"><a href="#cb72-483" aria-hidden="true" tabindex="-1"></a>line that describes this relationship so we can use it to estimate the</span>
<span id="cb72-484"><a href="#cb72-484" aria-hidden="true" tabindex="-1"></a>molecular weights of other proteins in the gel.</span>
<span id="cb72-485"><a href="#cb72-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-486"><a href="#cb72-486" aria-hidden="true" tabindex="-1"></a>We will use this gel image (@fig-gel) as an example:</span>
<span id="cb72-487"><a href="#cb72-487" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">26C-10-Coomassie-Blue.jpg</span><span class="co">](data-image/26C-10-Coomassie-Blue.jpg)</span>. This</span>
<span id="cb72-488"><a href="#cb72-488" aria-hidden="true" tabindex="-1"></a>gel has two sets of results (one each side) -- since only 4 lanes were</span>
<span id="cb72-489"><a href="#cb72-489" aria-hidden="true" tabindex="-1"></a>for each practical group, we put two groups on one gel.</span>
<span id="cb72-490"><a href="#cb72-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-491"><a href="#cb72-491" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lane 1 (and 10) is the protein ladder which are the proteins of</span>
<span id="cb72-492"><a href="#cb72-492" aria-hidden="true" tabindex="-1"></a>    known molecular weights.</span>
<span id="cb72-493"><a href="#cb72-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-494"><a href="#cb72-494" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lane 2 (and 9) is Uninduced E. coli lysate</span>
<span id="cb72-495"><a href="#cb72-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-496"><a href="#cb72-496" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lane 3 (and 8) is Induced E. coli lysate</span>
<span id="cb72-497"><a href="#cb72-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-498"><a href="#cb72-498" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lane 4 (and 7) is ShPatB</span>
<span id="cb72-499"><a href="#cb72-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-500"><a href="#cb72-500" aria-hidden="true" tabindex="-1"></a>You don't need worry about the details of the gel, only that our aim is</span>
<span id="cb72-501"><a href="#cb72-501" aria-hidden="true" tabindex="-1"></a>to estimate the molecule weight of the ShPatB protein in lane 4 from its</span>
<span id="cb72-502"><a href="#cb72-502" aria-hidden="true" tabindex="-1"></a>position on the gel and the standard curve created from the marker</span>
<span id="cb72-503"><a href="#cb72-503" aria-hidden="true" tabindex="-1"></a>proteins in lane 1. @fig-gel illustrates the measurements needed from</span>
<span id="cb72-504"><a href="#cb72-504" aria-hidden="true" tabindex="-1"></a>the gel image.</span>
<span id="cb72-505"><a href="#cb72-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-508"><a href="#cb72-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-509"><a href="#cb72-509" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb72-510"><a href="#cb72-510" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb72-511"><a href="#cb72-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-512"><a href="#cb72-512" aria-hidden="true" tabindex="-1"></a><span class="co"># import gel</span></span>
<span id="cb72-513"><a href="#cb72-513" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(imager)</span>
<span id="cb72-514"><a href="#cb72-514" aria-hidden="true" tabindex="-1"></a>gel <span class="ot">&lt;-</span> <span class="fu">load.image</span>(<span class="st">"data-image/26C-10-Coomassie-Blue.jpg"</span>)</span>
<span id="cb72-515"><a href="#cb72-515" aria-hidden="true" tabindex="-1"></a>gel_cropped <span class="ot">&lt;-</span> <span class="fu">crop.borders</span>(gel, <span class="at">nx =</span> <span class="dv">300</span>, <span class="at">ny =</span> <span class="dv">150</span>)</span>
<span id="cb72-516"><a href="#cb72-516" aria-hidden="true" tabindex="-1"></a>gel_top <span class="ot">&lt;-</span> <span class="dv">180</span></span>
<span id="cb72-517"><a href="#cb72-517" aria-hidden="true" tabindex="-1"></a>gel_bottom <span class="ot">&lt;-</span> <span class="dv">990</span></span>
<span id="cb72-518"><a href="#cb72-518" aria-hidden="true" tabindex="-1"></a>pos_patB <span class="ot">&lt;-</span> <span class="dv">394</span></span>
<span id="cb72-519"><a href="#cb72-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-520"><a href="#cb72-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-521"><a href="#cb72-521" aria-hidden="true" tabindex="-1"></a>: :: {fig-gel}</span>
<span id="cb72-522"><a href="#cb72-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-525"><a href="#cb72-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-526"><a href="#cb72-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb72-527"><a href="#cb72-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb72-528"><a href="#cb72-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-529"><a href="#cb72-529" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gel_cropped, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb72-530"><a href="#cb72-530" aria-hidden="true" tabindex="-1"></a><span class="co"># add a line to plot </span></span>
<span id="cb72-531"><a href="#cb72-531" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> gel_top, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb72-532"><a href="#cb72-532" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> gel_bottom, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb72-533"><a href="#cb72-533" aria-hidden="true" tabindex="-1"></a><span class="co"># draw vertical double-headed arrow between top and bottom</span></span>
<span id="cb72-534"><a href="#cb72-534" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">50</span>, <span class="at">y0 =</span> gel_top, </span>
<span id="cb72-535"><a href="#cb72-535" aria-hidden="true" tabindex="-1"></a>       <span class="at">x1 =</span> <span class="dv">50</span>, <span class="at">y1 =</span> gel_bottom, </span>
<span id="cb72-536"><a href="#cb72-536" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb72-537"><a href="#cb72-537" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> (gel_top <span class="sc">+</span> gel_bottom) <span class="sc">/</span> <span class="dv">2</span>, </span>
<span id="cb72-538"><a href="#cb72-538" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="st">"L"</span>, </span>
<span id="cb72-539"><a href="#cb72-539" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb72-540"><a href="#cb72-540" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> <span class="dv">220</span>, <span class="at">y0 =</span> gel_top, </span>
<span id="cb72-541"><a href="#cb72-541" aria-hidden="true" tabindex="-1"></a>       <span class="at">x1 =</span> <span class="dv">220</span>, <span class="at">y1 =</span> gel_top <span class="sc">+</span> <span class="dv">138</span>,</span>
<span id="cb72-542"><a href="#cb72-542" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb72-543"><a href="#cb72-543" aria-hidden="true" tabindex="-1"></a>       <span class="at">code =</span> <span class="dv">3</span>, </span>
<span id="cb72-544"><a href="#cb72-544" aria-hidden="true" tabindex="-1"></a>       <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb72-545"><a href="#cb72-545" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="at">x0 =</span> <span class="dv">510</span>, <span class="at">y0 =</span> gel_top, </span>
<span id="cb72-546"><a href="#cb72-546" aria-hidden="true" tabindex="-1"></a>       <span class="at">x1 =</span> <span class="dv">510</span>, <span class="at">y1 =</span> gel_top <span class="sc">+</span> pos_patB,</span>
<span id="cb72-547"><a href="#cb72-547" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb72-548"><a href="#cb72-548" aria-hidden="true" tabindex="-1"></a>       <span class="at">code =</span> <span class="dv">3</span>, </span>
<span id="cb72-549"><a href="#cb72-549" aria-hidden="true" tabindex="-1"></a>       <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb72-550"><a href="#cb72-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-551"><a href="#cb72-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-552"><a href="#cb72-552" aria-hidden="true" tabindex="-1"></a>**SDS-PAGE gel provided as a sample in the BCH strand of 26C practicals</span>
<span id="cb72-553"><a href="#cb72-553" aria-hidden="true" tabindex="-1"></a>with annotation.** Lane 1 (and 10) is the protein ladder, Lane 2 (and 9)</span>
<span id="cb72-554"><a href="#cb72-554" aria-hidden="true" tabindex="-1"></a>is Uninduced E. coli lysate, Lane 3 (and 8) is Induced E. coli lysate</span>
<span id="cb72-555"><a href="#cb72-555" aria-hidden="true" tabindex="-1"></a>and Lane 4 (and 7) is ShPatB. The horizontal red lines indicate the top</span>
<span id="cb72-556"><a href="#cb72-556" aria-hidden="true" tabindex="-1"></a>and bottom of the gel. The vertical black dashed line indicates the</span>
<span id="cb72-557"><a href="#cb72-557" aria-hidden="true" tabindex="-1"></a>length of the gel, $L$. The distance of one marker protein -- the</span>
<span id="cb72-558"><a href="#cb72-558" aria-hidden="true" tabindex="-1"></a>heaviest -- and that ShPatB from the top of the gel are indicated by</span>
<span id="cb72-559"><a href="#cb72-559" aria-hidden="true" tabindex="-1"></a>vertical solid blue lines. Distance to all the marker proteins need to</span>
<span id="cb72-560"><a href="#cb72-560" aria-hidden="true" tabindex="-1"></a>be measured from the top of the gel. These distances and the molecular</span>
<span id="cb72-561"><a href="#cb72-561" aria-hidden="true" tabindex="-1"></a>weights of the marker proteins are used to create a standard curve that</span>
<span id="cb72-562"><a href="#cb72-562" aria-hidden="true" tabindex="-1"></a>allows us to estimate the molecular weight of ShPatB from its position</span>
<span id="cb72-563"><a href="#cb72-563" aria-hidden="true" tabindex="-1"></a>on the gel.</span>
<span id="cb72-564"><a href="#cb72-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-565"><a href="#cb72-565" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-566"><a href="#cb72-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-567"><a href="#cb72-567" aria-hidden="true" tabindex="-1"></a>We will cover two options:</span>
<span id="cb72-568"><a href="#cb72-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-569"><a href="#cb72-569" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Where you have measured the length of the gel, the positions of</span>
<span id="cb72-570"><a href="#cb72-570" aria-hidden="true" tabindex="-1"></a>    ShPatB and the marker proteins on the gel manually -- by opening the</span>
<span id="cb72-571"><a href="#cb72-571" aria-hidden="true" tabindex="-1"></a>    gel image in Powerpoint for example -- and have a file containing</span>
<span id="cb72-572"><a href="#cb72-572" aria-hidden="true" tabindex="-1"></a>    the molecular weights and positions of the marker proteins. The</span>
<span id="cb72-573"><a href="#cb72-573" aria-hidden="true" tabindex="-1"></a>    measures can be in centimetres or pixels, it does not matter as long</span>
<span id="cb72-574"><a href="#cb72-574" aria-hidden="true" tabindex="-1"></a>    as they are all in the same units.</span>
<span id="cb72-575"><a href="#cb72-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-576"><a href="#cb72-576" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Where you have a file containing the molecular weights of the marker</span>
<span id="cb72-577"><a href="#cb72-577" aria-hidden="true" tabindex="-1"></a>    proteins and use R to measure the length of the gel, the positions</span>
<span id="cb72-578"><a href="#cb72-578" aria-hidden="true" tabindex="-1"></a>    of ShPatB and the marker proteins by importing the gel image. This</span>
<span id="cb72-579"><a href="#cb72-579" aria-hidden="true" tabindex="-1"></a>    method relies on the <span class="in">`locator()`</span> which stores the coordinate</span>
<span id="cb72-580"><a href="#cb72-580" aria-hidden="true" tabindex="-1"></a>    positions when you click on a plot! Magic!</span>
<span id="cb72-581"><a href="#cb72-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-582"><a href="#cb72-582" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Make a new script then save it with a name like</span>
<span id="cb72-583"><a href="#cb72-583" aria-hidden="true" tabindex="-1"></a><span class="in">`mw-from-gel-regression.R`</span> to carry out the rest of the work.</span>
<span id="cb72-584"><a href="#cb72-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-585"><a href="#cb72-585" aria-hidden="true" tabindex="-1"></a><span class="fu">### Option 1: Manual measurements</span></span>
<span id="cb72-586"><a href="#cb72-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-587"><a href="#cb72-587" aria-hidden="true" tabindex="-1"></a>You have measured the positions of the marker proteins and added them to</span>
<span id="cb72-588"><a href="#cb72-588" aria-hidden="true" tabindex="-1"></a>a file containing the molecular weights. Your file is:</span>
<span id="cb72-589"><a href="#cb72-589" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">standard-mw-with-positions.csv</span><span class="co">](data-raw/standard-mw-with-positions.csv)</span>.</span>
<span id="cb72-590"><a href="#cb72-590" aria-hidden="true" tabindex="-1"></a>The molecular weights of the marker proteins are in kilodaltons (kDa)</span>
<span id="cb72-591"><a href="#cb72-591" aria-hidden="true" tabindex="-1"></a>and the positions of the marker proteins are in pixels. The length of</span>
<span id="cb72-592"><a href="#cb72-592" aria-hidden="true" tabindex="-1"></a>the gel is 810 pixels and ShPatB is at 394 pixels from the top of the</span>
<span id="cb72-593"><a href="#cb72-593" aria-hidden="true" tabindex="-1"></a>gel.</span>
<span id="cb72-594"><a href="#cb72-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-595"><a href="#cb72-595" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Save</span>
<span id="cb72-596"><a href="#cb72-596" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">standard-mw-with-positions.csv</span><span class="co">](data-raw/standard-mw-with-positions.csv)</span></span>
<span id="cb72-597"><a href="#cb72-597" aria-hidden="true" tabindex="-1"></a>to <span class="in">`data-raw/`</span> and import it.</span>
<span id="cb72-598"><a href="#cb72-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-601"><a href="#cb72-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-602"><a href="#cb72-602" aria-hidden="true" tabindex="-1"></a>mw_positions <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data-raw/standard-mw-with-positions.csv"</span>)</span>
<span id="cb72-603"><a href="#cb72-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-604"><a href="#cb72-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-605"><a href="#cb72-605" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Assign the position of ShPatB and the length of</span>
<span id="cb72-606"><a href="#cb72-606" aria-hidden="true" tabindex="-1"></a>the gel to variables:</span>
<span id="cb72-607"><a href="#cb72-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-610"><a href="#cb72-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-611"><a href="#cb72-611" aria-hidden="true" tabindex="-1"></a>gel_length <span class="ot">&lt;-</span> <span class="dv">810</span></span>
<span id="cb72-612"><a href="#cb72-612" aria-hidden="true" tabindex="-1"></a>pos_patB <span class="ot">&lt;-</span> <span class="dv">394</span></span>
<span id="cb72-613"><a href="#cb72-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-614"><a href="#cb72-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-615"><a href="#cb72-615" aria-hidden="true" tabindex="-1"></a>We need to calculate $R_f$ values for the marker proteins:</span>
<span id="cb72-616"><a href="#cb72-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-617"><a href="#cb72-617" aria-hidden="true" tabindex="-1"></a>$$R_f = \frac{L - d}{L}$$</span>
<span id="cb72-618"><a href="#cb72-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-619"><a href="#cb72-619" aria-hidden="true" tabindex="-1"></a>where $L$ is the length of the gel and $d$ is the distance to the band.</span>
<span id="cb72-620"><a href="#cb72-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-621"><a href="#cb72-621" aria-hidden="true" tabindex="-1"></a>We also need to log the molecular weights of the marker proteins to make</span>
<span id="cb72-622"><a href="#cb72-622" aria-hidden="true" tabindex="-1"></a>a linear relationship. We can add these two new variables to the data</span>
<span id="cb72-623"><a href="#cb72-623" aria-hidden="true" tabindex="-1"></a>frame using the <span class="in">`mutate()`</span>.</span>
<span id="cb72-624"><a href="#cb72-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-625"><a href="#cb72-625" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Calculate Rf values for the marker proteins:</span>
<span id="cb72-626"><a href="#cb72-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-629"><a href="#cb72-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-630"><a href="#cb72-630" aria-hidden="true" tabindex="-1"></a>mw_positions <span class="ot">&lt;-</span> mw_positions <span class="sc">|&gt;</span></span>
<span id="cb72-631"><a href="#cb72-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rf =</span> (gel_length <span class="sc">-</span> dist_to_band) <span class="sc">/</span> gel_length,</span>
<span id="cb72-632"><a href="#cb72-632" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_kda =</span> <span class="fu">log</span>(kda))</span>
<span id="cb72-633"><a href="#cb72-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-634"><a href="#cb72-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-635"><a href="#cb72-635" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Plot the data with <span class="in">`geom_point()`</span> and add a</span>
<span id="cb72-636"><a href="#cb72-636" aria-hidden="true" tabindex="-1"></a>linear regression line with <span class="in">`geom_smooth(method = "lm")`</span>:</span>
<span id="cb72-637"><a href="#cb72-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-640"><a href="#cb72-640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-641"><a href="#cb72-641" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mw_positions, <span class="fu">aes</span>(<span class="at">x =</span> Rf, <span class="at">y =</span> log_kda)) <span class="sc">+</span></span>
<span id="cb72-642"><a href="#cb72-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-643"><a href="#cb72-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb72-644"><a href="#cb72-644" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb72-645"><a href="#cb72-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb72-646"><a href="#cb72-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-647"><a href="#cb72-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-648"><a href="#cb72-648" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Fit a linear model so we have the equation of</span>
<span id="cb72-649"><a href="#cb72-649" aria-hidden="true" tabindex="-1"></a>the line</span>
<span id="cb72-650"><a href="#cb72-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-653"><a href="#cb72-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-654"><a href="#cb72-654" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_kda <span class="sc">~</span> Rf, <span class="at">data =</span> mw_positions)</span>
<span id="cb72-655"><a href="#cb72-655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-656"><a href="#cb72-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-657"><a href="#cb72-657" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Print the model:</span>
<span id="cb72-658"><a href="#cb72-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-661"><a href="#cb72-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-662"><a href="#cb72-662" aria-hidden="true" tabindex="-1"></a>mod</span>
<span id="cb72-663"><a href="#cb72-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-664"><a href="#cb72-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-665"><a href="#cb72-665" aria-hidden="true" tabindex="-1"></a>We only need to print the coefficients -- we don't care about the</span>
<span id="cb72-666"><a href="#cb72-666" aria-hidden="true" tabindex="-1"></a>statistical tests here. You can tell from the plot that the relationship</span>
<span id="cb72-667"><a href="#cb72-667" aria-hidden="true" tabindex="-1"></a>is very tight and linear. The equation of the line is: $MW$=</span>
<span id="cb72-668"><a href="#cb72-668" aria-hidden="true" tabindex="-1"></a><span class="in">`r mod$coef[2] |&gt; round(3)`</span> <span class="sc">\*</span> $R_f$ + <span class="in">`r mod$coef[1] |&gt; round(3)`</span></span>
<span id="cb72-669"><a href="#cb72-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-670"><a href="#cb72-670" aria-hidden="true" tabindex="-1"></a>You can substitute the values of the coefficients and the $R_f$ of</span>
<span id="cb72-671"><a href="#cb72-671" aria-hidden="true" tabindex="-1"></a>ShpatB to find the log molecular weight of ShPatB. Or you can use the</span>
<span id="cb72-672"><a href="#cb72-672" aria-hidden="true" tabindex="-1"></a><span class="in">`predict()`</span> function to do this for you.</span>
<span id="cb72-673"><a href="#cb72-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-674"><a href="#cb72-674" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Calculate the $R_f$ of ShPatB:</span>
<span id="cb72-675"><a href="#cb72-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-678"><a href="#cb72-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-679"><a href="#cb72-679" aria-hidden="true" tabindex="-1"></a>patB_Rf <span class="ot">=</span> (gel_length <span class="sc">-</span> pos_patB) <span class="sc">/</span> gel_length</span>
<span id="cb72-680"><a href="#cb72-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-681"><a href="#cb72-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-682"><a href="#cb72-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-683"><a href="#cb72-683" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Predict the molecular weight ShPatB:</span>
<span id="cb72-684"><a href="#cb72-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-687"><a href="#cb72-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-688"><a href="#cb72-688" aria-hidden="true" tabindex="-1"></a>patB_kda <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Rf =</span> patB_Rf)) <span class="sc">|&gt;</span> </span>
<span id="cb72-689"><a href="#cb72-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>()</span>
<span id="cb72-690"><a href="#cb72-690" aria-hidden="true" tabindex="-1"></a>patB_kda</span>
<span id="cb72-691"><a href="#cb72-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-692"><a href="#cb72-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-693"><a href="#cb72-693" aria-hidden="true" tabindex="-1"></a><span class="fu">### Option 2: Measurements in R</span></span>
<span id="cb72-694"><a href="#cb72-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-695"><a href="#cb72-695" aria-hidden="true" tabindex="-1"></a>You have a file containing the molecular weights of the marker proteins</span>
<span id="cb72-696"><a href="#cb72-696" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">standard-mw.txt</span><span class="co">](data-image/standard-mw.txt)</span> and the image of the gel</span>
<span id="cb72-697"><a href="#cb72-697" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">26C-10-Coomassie-Blue.jpg</span><span class="co">](data-image/26C-10-Coomassie-Blue.jpg)</span>. The</span>
<span id="cb72-698"><a href="#cb72-698" aria-hidden="true" tabindex="-1"></a>molecular weights of the marker proteins are in kilodaltons (kDa)</span>
<span id="cb72-699"><a href="#cb72-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-700"><a href="#cb72-700" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Make a folder call <span class="in">`data-image`</span> and save</span>
<span id="cb72-701"><a href="#cb72-701" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">standard-mw.txt</span><span class="co">](data-image/standard-mw.txt)</span> and</span>
<span id="cb72-702"><a href="#cb72-702" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">26C-10-Coomassie-Blue.jpg</span><span class="co">](data-image/26C-10-Coomassie-Blue.jpg)</span> to it</span>
<span id="cb72-703"><a href="#cb72-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-704"><a href="#cb72-704" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Imort the molecular weights of the marker</span>
<span id="cb72-705"><a href="#cb72-705" aria-hidden="true" tabindex="-1"></a>proteins from <span class="co">[</span><span class="ot">standard-mw.txt</span><span class="co">](data-image/standard-mw.txt)</span></span>
<span id="cb72-706"><a href="#cb72-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-709"><a href="#cb72-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-710"><a href="#cb72-710" aria-hidden="true" tabindex="-1"></a>mw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data-image/standard-mw.txt"</span>)</span>
<span id="cb72-711"><a href="#cb72-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-712"><a href="#cb72-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-713"><a href="#cb72-713" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Load the <span class="in">`imager`</span> package</span>
<span id="cb72-714"><a href="#cb72-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-717"><a href="#cb72-717" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-718"><a href="#cb72-718" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(imager)</span>
<span id="cb72-719"><a href="#cb72-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-720"><a href="#cb72-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-721"><a href="#cb72-721" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Import the gel image:</span>
<span id="cb72-722"><a href="#cb72-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-725"><a href="#cb72-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-726"><a href="#cb72-726" aria-hidden="true" tabindex="-1"></a>gel <span class="ot">&lt;-</span> <span class="fu">load.image</span>(<span class="st">"data-image/26C-10-Coomassie-Blue.jpg"</span>)</span>
<span id="cb72-727"><a href="#cb72-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-728"><a href="#cb72-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-729"><a href="#cb72-729" aria-hidden="true" tabindex="-1"></a>Base R's generic <span class="in">`plot()`</span> function can handle image files and plot axes</span>
<span id="cb72-730"><a href="#cb72-730" aria-hidden="true" tabindex="-1"></a>default. These are in pixels and will help us mark the top and bottom of</span>
<span id="cb72-731"><a href="#cb72-731" aria-hidden="true" tabindex="-1"></a>the gel.</span>
<span id="cb72-732"><a href="#cb72-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-733"><a href="#cb72-733" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Plot the gel image:</span>
<span id="cb72-734"><a href="#cb72-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-737"><a href="#cb72-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-738"><a href="#cb72-738" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gel)</span>
<span id="cb72-739"><a href="#cb72-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-740"><a href="#cb72-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-741"><a href="#cb72-741" aria-hidden="true" tabindex="-1"></a>The **`imager`** package has a function that will crop the edges of the</span>
<span id="cb72-742"><a href="#cb72-742" aria-hidden="true" tabindex="-1"></a>image. This is certainly not essential but can have two benefits:</span>
<span id="cb72-743"><a href="#cb72-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-744"><a href="#cb72-744" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the image is smaller which means plotting is quicker -- this is</span>
<span id="cb72-745"><a href="#cb72-745" aria-hidden="true" tabindex="-1"></a>    especially useful when your images are many pixels</span>
<span id="cb72-746"><a href="#cb72-746" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>it makes it a little easier determine where the axes numbers are on</span>
<span id="cb72-747"><a href="#cb72-747" aria-hidden="true" tabindex="-1"></a>    the gel</span>
<span id="cb72-748"><a href="#cb72-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-749"><a href="#cb72-749" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Crop the image:</span>
<span id="cb72-750"><a href="#cb72-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-753"><a href="#cb72-753" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-754"><a href="#cb72-754" aria-hidden="true" tabindex="-1"></a><span class="co"># crop</span></span>
<span id="cb72-755"><a href="#cb72-755" aria-hidden="true" tabindex="-1"></a>gel_cropped <span class="ot">&lt;-</span> <span class="fu">crop.borders</span>(gel, <span class="at">nx =</span> <span class="dv">300</span>, <span class="at">ny =</span> <span class="dv">150</span>)</span>
<span id="cb72-756"><a href="#cb72-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-757"><a href="#cb72-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-758"><a href="#cb72-758" aria-hidden="true" tabindex="-1"></a><span class="in">`crop.borders()`</span> removes <span class="in">`ny`</span> from the top and the bottom and <span class="in">`nx`</span> from</span>
<span id="cb72-759"><a href="#cb72-759" aria-hidden="true" tabindex="-1"></a>each side. You may wish to adjust the numbers.</span>
<span id="cb72-760"><a href="#cb72-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-761"><a href="#cb72-761" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Plot the cropped image:</span>
<span id="cb72-762"><a href="#cb72-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-765"><a href="#cb72-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-766"><a href="#cb72-766" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gel_cropped)</span>
<span id="cb72-767"><a href="#cb72-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-768"><a href="#cb72-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-769"><a href="#cb72-769" aria-hidden="true" tabindex="-1"></a>To make sure we measure distances from the same place we need to add</span>
<span id="cb72-770"><a href="#cb72-770" aria-hidden="true" tabindex="-1"></a>lines to mark the top and the bottom of the gel. Notice that the</span>
<span id="cb72-771"><a href="#cb72-771" aria-hidden="true" tabindex="-1"></a>*y*-axis is 0 at the top. I think the top is at about 180 and the bottom</span>
<span id="cb72-772"><a href="#cb72-772" aria-hidden="true" tabindex="-1"></a>is about 990. We will assign these values to variables because they will</span>
<span id="cb72-773"><a href="#cb72-773" aria-hidden="true" tabindex="-1"></a>be needed in calculations later. We will also need the gel length</span>
<span id="cb72-774"><a href="#cb72-774" aria-hidden="true" tabindex="-1"></a>(bottom position - top position).</span>
<span id="cb72-775"><a href="#cb72-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-776"><a href="#cb72-776" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Assign values for the top and bottom of the gel</span>
<span id="cb72-777"><a href="#cb72-777" aria-hidden="true" tabindex="-1"></a>to variables and calculate the length of the gel:</span>
<span id="cb72-778"><a href="#cb72-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-781"><a href="#cb72-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-782"><a href="#cb72-782" aria-hidden="true" tabindex="-1"></a>gel_top <span class="ot">&lt;-</span> <span class="dv">180</span></span>
<span id="cb72-783"><a href="#cb72-783" aria-hidden="true" tabindex="-1"></a>gel_bottom <span class="ot">&lt;-</span> <span class="dv">990</span></span>
<span id="cb72-784"><a href="#cb72-784" aria-hidden="true" tabindex="-1"></a>gel_length <span class="ot">&lt;-</span> gel_bottom <span class="sc">-</span> gel_top</span>
<span id="cb72-785"><a href="#cb72-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-786"><a href="#cb72-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-787"><a href="#cb72-787" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Plot the cropped gel with lines marking the top</span>
<span id="cb72-788"><a href="#cb72-788" aria-hidden="true" tabindex="-1"></a>and bottom of the gel:</span>
<span id="cb72-789"><a href="#cb72-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-792"><a href="#cb72-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-793"><a href="#cb72-793" aria-hidden="true" tabindex="-1"></a><span class="co"># plot gel</span></span>
<span id="cb72-794"><a href="#cb72-794" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gel_cropped)</span>
<span id="cb72-795"><a href="#cb72-795" aria-hidden="true" tabindex="-1"></a><span class="co"># add a horizontal lines for the top and bottom of the gel </span></span>
<span id="cb72-796"><a href="#cb72-796" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> gel_top, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb72-797"><a href="#cb72-797" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> gel_bottom, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb72-798"><a href="#cb72-798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-799"><a href="#cb72-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-800"><a href="#cb72-800" aria-hidden="true" tabindex="-1"></a>Make sure you run all theses commands. The base plotting system works a</span>
<span id="cb72-801"><a href="#cb72-801" aria-hidden="true" tabindex="-1"></a>little differently that <span class="in">`ggplot`</span>. We do not use <span class="in">`+`</span> but we have to make</span>
<span id="cb72-802"><a href="#cb72-802" aria-hidden="true" tabindex="-1"></a>sure we have recently run the <span class="in">`plot()`</span> command before the <span class="in">`abline()`</span></span>
<span id="cb72-803"><a href="#cb72-803" aria-hidden="true" tabindex="-1"></a>(and other functions that modify plots) will work. You will get</span>
<span id="cb72-804"><a href="#cb72-804" aria-hidden="true" tabindex="-1"></a><span class="in">`Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...) :`</span></span>
<span id="cb72-805"><a href="#cb72-805" aria-hidden="true" tabindex="-1"></a><span class="in">`plot.new has not been called yet`</span></span>
<span id="cb72-806"><a href="#cb72-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-807"><a href="#cb72-807" aria-hidden="true" tabindex="-1"></a>At this point you have check that you are happy with the numbers used</span>
<span id="cb72-808"><a href="#cb72-808" aria-hidden="true" tabindex="-1"></a>for the top and bottom of the gel. Adjust and replot if needed.</span>
<span id="cb72-809"><a href="#cb72-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-810"><a href="#cb72-810" aria-hidden="true" tabindex="-1"></a>I like to add a vertical line in the marker lane to help guide my later</span>
<span id="cb72-811"><a href="#cb72-811" aria-hidden="true" tabindex="-1"></a>measures.</span>
<span id="cb72-812"><a href="#cb72-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-813"><a href="#cb72-813" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Add a vertical line in the marker lane. Again,</span>
<span id="cb72-814"><a href="#cb72-814" aria-hidden="true" tabindex="-1"></a>make sure you run all of the plotting code:</span>
<span id="cb72-815"><a href="#cb72-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-818"><a href="#cb72-818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-819"><a href="#cb72-819" aria-hidden="true" tabindex="-1"></a><span class="co"># plot gel</span></span>
<span id="cb72-820"><a href="#cb72-820" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gel_cropped)</span>
<span id="cb72-821"><a href="#cb72-821" aria-hidden="true" tabindex="-1"></a><span class="co"># add a horizontal lines for the top and bottom of the gel</span></span>
<span id="cb72-822"><a href="#cb72-822" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> gel_top, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb72-823"><a href="#cb72-823" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> gel_bottom, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb72-824"><a href="#cb72-824" aria-hidden="true" tabindex="-1"></a><span class="co"># add a vertical line in the marker lane as a guide to help with locator</span></span>
<span id="cb72-825"><a href="#cb72-825" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">220</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb72-826"><a href="#cb72-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-827"><a href="#cb72-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-828"><a href="#cb72-828" aria-hidden="true" tabindex="-1"></a>We are now ready to measure the band positions using the <span class="in">`locator()`</span></span>
<span id="cb72-829"><a href="#cb72-829" aria-hidden="true" tabindex="-1"></a>function. We need to measure the position of shPatB and the all the</span>
<span id="cb72-830"><a href="#cb72-830" aria-hidden="true" tabindex="-1"></a>marker proteins. We will start with shPatB:</span>
<span id="cb72-831"><a href="#cb72-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-832"><a href="#cb72-832" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Run the <span class="in">`locator()`</span> command and click on the</span>
<span id="cb72-833"><a href="#cb72-833" aria-hidden="true" tabindex="-1"></a>shPatB in lane 4:</span>
<span id="cb72-834"><a href="#cb72-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-837"><a href="#cb72-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-838"><a href="#cb72-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb72-839"><a href="#cb72-839" aria-hidden="true" tabindex="-1"></a>dist_to_patB <span class="ot">&lt;-</span> <span class="fu">locator</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb72-840"><a href="#cb72-840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-841"><a href="#cb72-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-844"><a href="#cb72-844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-845"><a href="#cb72-845" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb72-846"><a href="#cb72-846" aria-hidden="true" tabindex="-1"></a>dist_to_patB <span class="ot">&lt;-</span> <span class="dv">394</span> <span class="sc">+</span> gel_top</span>
<span id="cb72-847"><a href="#cb72-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-848"><a href="#cb72-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-849"><a href="#cb72-849" aria-hidden="true" tabindex="-1"></a>The (*x*,*y*) position of shPatB is now stored in an R object called</span>
<span id="cb72-850"><a href="#cb72-850" aria-hidden="true" tabindex="-1"></a><span class="sc">\`</span>pos_patB.</span>
<span id="cb72-851"><a href="#cb72-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-852"><a href="#cb72-852" aria-hidden="true" tabindex="-1"></a>The distance between the shPatB band and the top of the gel will be the</span>
<span id="cb72-853"><a href="#cb72-853" aria-hidden="true" tabindex="-1"></a>*y*0value in <span class="in">`dist_to_patB`</span> minus the distance to the top of the gel.</span>
<span id="cb72-854"><a href="#cb72-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-855"><a href="#cb72-855" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Calculate the distance from the top of the gel</span>
<span id="cb72-856"><a href="#cb72-856" aria-hidden="true" tabindex="-1"></a>to shPatB:</span>
<span id="cb72-857"><a href="#cb72-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-860"><a href="#cb72-860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-861"><a href="#cb72-861" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb72-862"><a href="#cb72-862" aria-hidden="true" tabindex="-1"></a>pos_patB <span class="ot">&lt;-</span> dist_to_patB<span class="sc">$</span>y <span class="sc">-</span> gel_top</span>
<span id="cb72-863"><a href="#cb72-863" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-864"><a href="#cb72-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-867"><a href="#cb72-867" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-868"><a href="#cb72-868" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb72-869"><a href="#cb72-869" aria-hidden="true" tabindex="-1"></a>pos_patB <span class="ot">&lt;-</span> <span class="dv">394</span></span>
<span id="cb72-870"><a href="#cb72-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-871"><a href="#cb72-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-872"><a href="#cb72-872" aria-hidden="true" tabindex="-1"></a>We have 9 bands so pass the argument <span class="in">`n = 9`</span> to the function. This means</span>
<span id="cb72-873"><a href="#cb72-873" aria-hidden="true" tabindex="-1"></a>you will need to click on the graph 9 times. Start at the top -- the</span>
<span id="cb72-874"><a href="#cb72-874" aria-hidden="true" tabindex="-1"></a>heaviest band -- and work your way down. You only need to click once on</span>
<span id="cb72-875"><a href="#cb72-875" aria-hidden="true" tabindex="-1"></a>each band. The R cursor will disappear until you have clicked 9 times.</span>
<span id="cb72-876"><a href="#cb72-876" aria-hidden="true" tabindex="-1"></a>Don't worry if you make a mistake, just click until the cursor is</span>
<span id="cb72-877"><a href="#cb72-877" aria-hidden="true" tabindex="-1"></a>returned and run the locator command again to start afresh.</span>
<span id="cb72-878"><a href="#cb72-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-879"><a href="#cb72-879" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Run the <span class="in">`locator()`</span> command and click on the 9</span>
<span id="cb72-880"><a href="#cb72-880" aria-hidden="true" tabindex="-1"></a>bands in order from top to bottom:</span>
<span id="cb72-881"><a href="#cb72-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-884"><a href="#cb72-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-885"><a href="#cb72-885" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb72-886"><a href="#cb72-886" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of bands in your marker lane</span></span>
<span id="cb72-887"><a href="#cb72-887" aria-hidden="true" tabindex="-1"></a><span class="co"># click from the top or gel to the bottom </span></span>
<span id="cb72-888"><a href="#cb72-888" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e., high MW to low</span></span>
<span id="cb72-889"><a href="#cb72-889" aria-hidden="true" tabindex="-1"></a>marker_positions <span class="ot">&lt;-</span> <span class="fu">locator</span>(<span class="at">n =</span> <span class="dv">9</span>)  </span>
<span id="cb72-890"><a href="#cb72-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-891"><a href="#cb72-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-894"><a href="#cb72-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-895"><a href="#cb72-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb72-896"><a href="#cb72-896" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data-raw/standard-mw-with-positions.csv"</span>)</span>
<span id="cb72-897"><a href="#cb72-897" aria-hidden="true" tabindex="-1"></a>marker_positions <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">220</span>, <span class="dv">9</span>), <span class="at">y =</span> temp<span class="sc">$</span>dist_to_band <span class="sc">+</span> gel_top)</span>
<span id="cb72-898"><a href="#cb72-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-899"><a href="#cb72-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-900"><a href="#cb72-900" aria-hidden="true" tabindex="-1"></a>Magic! The (*x*,*y*) position of each band is now stored in an R object</span>
<span id="cb72-901"><a href="#cb72-901" aria-hidden="true" tabindex="-1"></a>called <span class="in">`marker_positions`</span>.</span>
<span id="cb72-902"><a href="#cb72-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-903"><a href="#cb72-903" aria-hidden="true" tabindex="-1"></a>We need to</span>
<span id="cb72-904"><a href="#cb72-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-905"><a href="#cb72-905" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>combine the *y* positions with molecular weights in <span class="in">`mw`</span></span>
<span id="cb72-906"><a href="#cb72-906" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>calculate the distance to each band by substracting <span class="in">`gel_top`</span></span>
<span id="cb72-907"><a href="#cb72-907" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>calculate $R_f$ values for the marker proteins using</span>
<span id="cb72-908"><a href="#cb72-908" aria-hidden="true" tabindex="-1"></a>    $R_f = \frac{L - d}{L}$ where $L$ is the length of the gel and $d$</span>
<span id="cb72-909"><a href="#cb72-909" aria-hidden="true" tabindex="-1"></a>    is the distance to the band.</span>
<span id="cb72-910"><a href="#cb72-910" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>log the molecular weights of the marker proteins to make a linear</span>
<span id="cb72-911"><a href="#cb72-911" aria-hidden="true" tabindex="-1"></a>    relationship.</span>
<span id="cb72-912"><a href="#cb72-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-913"><a href="#cb72-913" aria-hidden="true" tabindex="-1"></a>We can put all these new columns in a dataframe called <span class="in">`mw_positions`</span></span>
<span id="cb72-914"><a href="#cb72-914" aria-hidden="true" tabindex="-1"></a>frame using the <span class="in">`mutate()`</span>.</span>
<span id="cb72-915"><a href="#cb72-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-916"><a href="#cb72-916" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Create <span class="in">`mw_positions`</span> from <span class="in">`mw`</span> and the *y*</span>
<span id="cb72-917"><a href="#cb72-917" aria-hidden="true" tabindex="-1"></a>positions in <span class="in">`marker_positions`</span>:</span>
<span id="cb72-918"><a href="#cb72-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-921"><a href="#cb72-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-922"><a href="#cb72-922" aria-hidden="true" tabindex="-1"></a>mw_positions <span class="ot">&lt;-</span> mw <span class="sc">|&gt;</span></span>
<span id="cb72-923"><a href="#cb72-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> marker_positions<span class="sc">$</span>y,</span>
<span id="cb72-924"><a href="#cb72-924" aria-hidden="true" tabindex="-1"></a>         <span class="at">dist_to_band =</span> y <span class="sc">-</span> gel_top,</span>
<span id="cb72-925"><a href="#cb72-925" aria-hidden="true" tabindex="-1"></a>         <span class="at">Rf =</span> (gel_length <span class="sc">-</span> dist_to_band) <span class="sc">/</span> gel_length,</span>
<span id="cb72-926"><a href="#cb72-926" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_kda =</span> <span class="fu">log</span>(kda)) </span>
<span id="cb72-927"><a href="#cb72-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-928"><a href="#cb72-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-929"><a href="#cb72-929" aria-hidden="true" tabindex="-1"></a>The process is now exactly the same as it was for Option 1.</span>
<span id="cb72-930"><a href="#cb72-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-931"><a href="#cb72-931" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Plot the data with <span class="in">`geom_point()`</span> and add a</span>
<span id="cb72-932"><a href="#cb72-932" aria-hidden="true" tabindex="-1"></a>linear regression line with <span class="in">`geom_smooth(method = "lm")`</span>:</span>
<span id="cb72-933"><a href="#cb72-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-936"><a href="#cb72-936" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-937"><a href="#cb72-937" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mw_positions, <span class="fu">aes</span>(<span class="at">x =</span> Rf, <span class="at">y =</span> log_kda)) <span class="sc">+</span></span>
<span id="cb72-938"><a href="#cb72-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-939"><a href="#cb72-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb72-940"><a href="#cb72-940" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb72-941"><a href="#cb72-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb72-942"><a href="#cb72-942" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-943"><a href="#cb72-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-944"><a href="#cb72-944" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Fit a linear model so we have the equation of</span>
<span id="cb72-945"><a href="#cb72-945" aria-hidden="true" tabindex="-1"></a>the line</span>
<span id="cb72-946"><a href="#cb72-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-949"><a href="#cb72-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-950"><a href="#cb72-950" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_kda <span class="sc">~</span> Rf, <span class="at">data =</span> mw_positions)</span>
<span id="cb72-951"><a href="#cb72-951" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-952"><a href="#cb72-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-953"><a href="#cb72-953" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Print the model:</span>
<span id="cb72-954"><a href="#cb72-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-957"><a href="#cb72-957" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-958"><a href="#cb72-958" aria-hidden="true" tabindex="-1"></a>mod</span>
<span id="cb72-959"><a href="#cb72-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-960"><a href="#cb72-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-961"><a href="#cb72-961" aria-hidden="true" tabindex="-1"></a>We only need to print the coefficients -- we don't care about the</span>
<span id="cb72-962"><a href="#cb72-962" aria-hidden="true" tabindex="-1"></a>statistical tests here. You can tell from the plot that the relationship</span>
<span id="cb72-963"><a href="#cb72-963" aria-hidden="true" tabindex="-1"></a>is very tight and linear. The equation of the line is: $MW$=</span>
<span id="cb72-964"><a href="#cb72-964" aria-hidden="true" tabindex="-1"></a><span class="in">`r mod$coef[2] |&gt; round(3)`</span> <span class="sc">\*</span> $R_f$ + <span class="in">`r mod$coef[1] |&gt; round(3)`</span></span>
<span id="cb72-965"><a href="#cb72-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-966"><a href="#cb72-966" aria-hidden="true" tabindex="-1"></a>You can substitute the values of the coefficients and the $R_f$ of</span>
<span id="cb72-967"><a href="#cb72-967" aria-hidden="true" tabindex="-1"></a>ShpatB to find the log molecular weight of ShPatB. Or you can use the</span>
<span id="cb72-968"><a href="#cb72-968" aria-hidden="true" tabindex="-1"></a><span class="in">`predict()`</span> function to do this for you.</span>
<span id="cb72-969"><a href="#cb72-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-970"><a href="#cb72-970" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Calculate the $R_f$ of ShPatB:</span>
<span id="cb72-971"><a href="#cb72-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-974"><a href="#cb72-974" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-975"><a href="#cb72-975" aria-hidden="true" tabindex="-1"></a>patB_Rf <span class="ot">=</span> (gel_length <span class="sc">-</span> pos_patB) <span class="sc">/</span> gel_length</span>
<span id="cb72-976"><a href="#cb72-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-977"><a href="#cb72-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-978"><a href="#cb72-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-979"><a href="#cb72-979" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/do_in_R.png)</span> Predict the molecular weight ShPatB:</span>
<span id="cb72-980"><a href="#cb72-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-983"><a href="#cb72-983" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb72-984"><a href="#cb72-984" aria-hidden="true" tabindex="-1"></a>patB_kda <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Rf =</span> patB_Rf)) <span class="sc">|&gt;</span> </span>
<span id="cb72-985"><a href="#cb72-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>()</span>
<span id="cb72-986"><a href="#cb72-986" aria-hidden="true" tabindex="-1"></a>patB_kda</span>
<span id="cb72-987"><a href="#cb72-987" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-988"><a href="#cb72-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-989"><a href="#cb72-989" aria-hidden="true" tabindex="-1"></a>If you would like to practice Option 2 again, you could repeat the the</span>
<span id="cb72-990"><a href="#cb72-990" aria-hidden="true" tabindex="-1"></a>steps using the set of results on the other side of the gel.</span>
<span id="cb72-991"><a href="#cb72-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-992"><a href="#cb72-992" aria-hidden="true" tabindex="-1"></a><span class="fu">## Look after future you!</span></span>
<span id="cb72-993"><a href="#cb72-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-994"><a href="#cb72-994" aria-hidden="true" tabindex="-1"></a>Future you will submit scripts for the assessment and these need to be</span>
<span id="cb72-995"><a href="#cb72-995" aria-hidden="true" tabindex="-1"></a>organised, well-formatted, concise and well-commented so others can</span>
<span id="cb72-996"><a href="#cb72-996" aria-hidden="true" tabindex="-1"></a>understand what you did and why.</span>
<span id="cb72-997"><a href="#cb72-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-998"><a href="#cb72-998" aria-hidden="true" tabindex="-1"></a>You might need to:</span>
<span id="cb72-999"><a href="#cb72-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1000"><a href="#cb72-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>collect together library statements at the beginning of the code</span>
<span id="cb72-1001"><a href="#cb72-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>edit your comments for clarity and include a paragraph explaining</span>
<span id="cb72-1002"><a href="#cb72-1002" aria-hidden="true" tabindex="-1"></a>    what the analysis is about add code section headers (Ctrl+Shift+R)</span>
<span id="cb72-1003"><a href="#cb72-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>rename variables for consistency or clarity</span>
<span id="cb72-1004"><a href="#cb72-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>remove house keeping or exploratory code or mark it for later</span>
<span id="cb72-1005"><a href="#cb72-1005" aria-hidden="true" tabindex="-1"></a>    removal</span>
<span id="cb72-1006"><a href="#cb72-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>restyle code indentation (Ctrl+i) if needed</span>
<span id="cb72-1007"><a href="#cb72-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>check whitespace and line length.</span>
<span id="cb72-1008"><a href="#cb72-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1009"><a href="#cb72-1009" aria-hidden="true" tabindex="-1"></a>You will find it useful to change some options in RStudio to make your</span>
<span id="cb72-1010"><a href="#cb72-1010" aria-hidden="true" tabindex="-1"></a>life easier. Revisit [Changing some defaults to make life</span>
<span id="cb72-1011"><a href="#cb72-1011" aria-hidden="true" tabindex="-1"></a>easier](https://3mmarand.github.io/comp4biosci/first-steps-rstudio.html#changing-some-defaults-to-make-life-easier).</span>
<span id="cb72-1012"><a href="#cb72-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1013"><a href="#cb72-1013" aria-hidden="true" tabindex="-1"></a>If you need to make additional notes that do not belong in the script,</span>
<span id="cb72-1014"><a href="#cb72-1014" aria-hidden="true" tabindex="-1"></a>you can add them a text file called <span class="in">`README.txt`</span> that future you -- and</span>
<span id="cb72-1015"><a href="#cb72-1015" aria-hidden="true" tabindex="-1"></a>anyone else will know exactly what to do with!</span>
<span id="cb72-1016"><a href="#cb72-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1017"><a href="#cb72-1017" aria-hidden="true" tabindex="-1"></a>You're finished!</span>
<span id="cb72-1018"><a href="#cb72-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1019"><a href="#cb72-1019" aria-hidden="true" tabindex="-1"></a><span class="fu"># 🥳 Well Done! 🎉</span></span>
<span id="cb72-1020"><a href="#cb72-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1021"><a href="#cb72-1021" aria-hidden="true" tabindex="-1"></a>![Artwork by @allison_horst: "length</span>
<span id="cb72-1022"><a href="#cb72-1022" aria-hidden="true" tabindex="-1"></a>typos"](images/lenght-length.png){fig-alt="Comic panels of an alligator trying to debug some code. First panel: A confident looking alligator gets an error message. Second panel: a few minutes later, the error remains and the alligator is looking carefully at their code. Third panel: 10 minutes after that, the error remains and the alligator is giving a frustrated 'RAAAR' while desperately typing. Fourth panel: The error remains, and the alligator looks exhausted and exasperated, and a thought bubble reads 'maybe it's a bug'. Fifth panel: A friendly flamingo comes over to take a look, and reads aloud from the problematic code a spelling error: 'L-E-N-G-H-T'. Only the tail of the alligator is visible as it stomp stomp stomps out of the panel roaring."</span>
<span id="cb72-1023"><a href="#cb72-1023" aria-hidden="true" tabindex="-1"></a>width="800"}</span>
<span id="cb72-1024"><a href="#cb72-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1025"><a href="#cb72-1025" aria-hidden="true" tabindex="-1"></a><span class="fu"># Independent study following the workshop</span></span>
<span id="cb72-1026"><a href="#cb72-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1027"><a href="#cb72-1027" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Consolidate</span><span class="co">](study_after_workshop.qmd)</span></span>
<span id="cb72-1028"><a href="#cb72-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1029"><a href="#cb72-1029" aria-hidden="true" tabindex="-1"></a><span class="fu"># The Code file</span></span>
<span id="cb72-1030"><a href="#cb72-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1031"><a href="#cb72-1031" aria-hidden="true" tabindex="-1"></a>This contains all the code needed in the workshop even where it is not</span>
<span id="cb72-1032"><a href="#cb72-1032" aria-hidden="true" tabindex="-1"></a>visible on the webpage.</span>
<span id="cb72-1033"><a href="#cb72-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1034"><a href="#cb72-1034" aria-hidden="true" tabindex="-1"></a>The <span class="in">`workshop.qmd`</span> file is the file I use to compile the practical. Qmd</span>
<span id="cb72-1035"><a href="#cb72-1035" aria-hidden="true" tabindex="-1"></a>stands for Quarto markdown. It allows code and ordinary text to be</span>
<span id="cb72-1036"><a href="#cb72-1036" aria-hidden="true" tabindex="-1"></a>interweaved to produce well-formatted reports including webpages. View</span>
<span id="cb72-1037"><a href="#cb72-1037" aria-hidden="true" tabindex="-1"></a>the source code for this workshop using the <span class="in">`&lt;/&gt; Code`</span> button at the top</span>
<span id="cb72-1038"><a href="#cb72-1038" aria-hidden="true" tabindex="-1"></a>of the page. Coding and thinking answers are marked with</span>
<span id="cb72-1039"><a href="#cb72-1039" aria-hidden="true" tabindex="-1"></a><span class="in">`#---CODING ANSWER---`</span> and <span class="in">`#---THINKING ANSWER---`</span></span>
<span id="cb72-1040"><a href="#cb72-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1041"><a href="#cb72-1041" aria-hidden="true" tabindex="-1"></a>Pages made with R <span class="co">[</span><span class="ot">@R-core</span><span class="co">]</span>, Quarto <span class="co">[</span><span class="ot">@allaire2022</span><span class="co">]</span>, <span class="in">`knitr`</span> [@knitr1;</span>
<span id="cb72-1042"><a href="#cb72-1042" aria-hidden="true" tabindex="-1"></a>@knitr2; @knitr3], <span class="in">`kableExtra`</span> <span class="co">[</span><span class="ot">@kableExtra</span><span class="co">]</span></span>
<span id="cb72-1043"><a href="#cb72-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1044"><a href="#cb72-1044" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Rand, E. (2025). Data Analysis in R for Becoming a Bioscientist (Version 0.2) <a href="https://github.com/3mmaRand/R4BABS" class="uri">https://github.com/3mmaRand/R4BABS</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/3mmaRand/comp4biosci/edit/main/r4babs2/week-2/workshop.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://github.com/3mmaRand">
<p>Emma on GitHub</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer><script>
document.addEventListener("DOMContentLoaded", function() {
  // grab all links under “Other Links” in the right-hand TOC
  const links = document.querySelectorAll('.quarto-other-links ul li a');
  links.forEach(function(a) {
    // find the one whose text is exactly “Make a suggestion”
    if (a.textContent.trim() === 'Make a suggestion') {
      const pageUrl   = encodeURIComponent(window.location.href);
      const pageTitle = encodeURIComponent(document.title);
      a.href = 'https://github.com/3mmaRand/R4BABS/issues/new'
             + '?title=' + pageTitle
             + '&body='  + pageUrl;
      a.target = '_blank';
    }
  });
});
</script><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>