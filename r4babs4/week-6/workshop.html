<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Emma Rand">
<title>Workshop – Data Analysis in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-50FV9HPTRE"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-50FV9HPTRE', { 'anonymize_ip': true});
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Data Analysis in R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Welcome!</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../r4babs1/r4babs1.html"> 
<span class="menu-text">BABS 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../r4babs2/r4babs2.html"> 
<span class="menu-text">BABS 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../r4babs4/r4babs4.html" aria-current="page"> 
<span class="menu-text">BABS 4</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../pgt52m/pgt52m.html"> 
<span class="menu-text">PGT 52M</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://mastodon.social/users/3mma" title="Emma on mastodon" class="quarto-navigation-tool px-1" aria-label="Emma on mastodon"><i class="bi bi-mastodon"></i></a>
    <a href="https://github.com/3mmaRand" title="Emma on GitHub" class="quarto-navigation-tool px-1" aria-label="Emma on GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../r4babs4/week-6/overview.html">Week 6: DA 4 Immunobiology</a></li><li class="breadcrumb-item"><a href="../../r4babs4/week-6/workshop.html">Workshop</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/r4babs4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis in R for BABS 4</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 1: DA 1 Core</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-1/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-1/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-1/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-1/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 2: DA 2 Immunobiology</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-2/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-2/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-2/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-2/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 4: DA 3 Immunobiology</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-4/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-4/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-4/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-4/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 6: DA 4 Immunobiology</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-6/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-6/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-6/workshop.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-6/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#exercises" id="toc-exercises" class="nav-link active" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
<li><a href="#add-your-data" id="toc-add-your-data" class="nav-link" data-scroll-target="#add-your-data">Add your data</a></li>
  <li><a href="#set-up" id="toc-set-up" class="nav-link" data-scroll-target="#set-up">Set up</a></li>
  <li>
<a href="#distribution-of-apc-tnf-%CE%B1-signal-with-gate" id="toc-distribution-of-apc-tnf-α-signal-with-gate" class="nav-link" data-scroll-target="#distribution-of-apc-tnf-%CE%B1-signal-with-gate">Distribution of APC TNF-α signal with gate</a>
  <ul class="collapse">
<li><a href="#plot-one-sample" id="toc-plot-one-sample" class="nav-link" data-scroll-target="#plot-one-sample">Plot one sample</a></li>
  <li><a href="#write-to-file" id="toc-write-to-file" class="nav-link" data-scroll-target="#write-to-file">Write to file</a></li>
  <li><a href="#multiple-facets" id="toc-multiple-facets" class="nav-link" data-scroll-target="#multiple-facets">Multiple facets</a></li>
  <li><a href="#overlay-instead-of-facets" id="toc-overlay-instead-of-facets" class="nav-link" data-scroll-target="#overlay-instead-of-facets">Overlay instead of facets</a></li>
  </ul>
</li>
  <li><a href="#percentage-of-cells-in-each-quadrant" id="toc-percentage-of-cells-in-each-quadrant" class="nav-link" data-scroll-target="#percentage-of-cells-in-each-quadrant">Percentage of cells in each quadrant</a></li>
  <li><a href="#importing-from-google-sheets" id="toc-importing-from-google-sheets" class="nav-link" data-scroll-target="#importing-from-google-sheets">Importing from google sheets</a></li>
  <li><a href="#analysis-of-the-class-data" id="toc-analysis-of-the-class-data" class="nav-link" data-scroll-target="#analysis-of-the-class-data">Analysis of the class data</a></li>
  </ul>
</li>
  <li><a href="#independent-study-following-the-workshop" id="toc-independent-study-following-the-workshop" class="nav-link" data-scroll-target="#independent-study-following-the-workshop">Independent study following the workshop</a></li>
  <li><a href="#the-code-file" id="toc-the-code-file" class="nav-link" data-scroll-target="#the-code-file">The Code file</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../r4babs4/week-6/overview.html">Week 6: DA 4 Immunobiology</a></li><li class="breadcrumb-item"><a href="../../r4babs4/week-6/workshop.html">Workshop</a></li></ol></nav><div class="quarto-title">
<h1 class="title">Workshop</h1>
<p class="subtitle lead">Data Analysis 4: Immunobiology - Your data presentation</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In this workshop learn how to create density plots to visualise the distribution and gating of the signals and calculate the the percentage of cells in each quadrant of a quadrant gated plot of TNFa_APC_Lin signal against the E_coli_FITC_Lin signal. You will also grow your knowledge of ggplot annotation and data import from googlesheet.</p>
<section id="exercises" class="level1"><h1>Exercises</h1>
<section id="add-your-data" class="level2"><h2 class="anchored" data-anchor-id="add-your-data">Add your data</h2>
<p>Enter these in the <a href="https://docs.google.com/spreadsheets/d/104EXdgsiIq-FuRF9Ly9zewEVdpkVWbyOwxSAmiqJepg/edit#gid=0">BIO00066I Biomedical Sciences class data</a></p>
<p>The columns you must add are:</p>
<ul>
<li><p><code>apc_mfi</code>: Mean fluorescence intensity of the logicle transformed TNFa_APC_Lin in the TNF-α positive cells</p></li>
<li><p><code>perc_tfna_pos</code>: % non debris cells that are TNF-α positive cells</p></li>
</ul>
<p>The other columns are calculations you make along the way and may help you get to the <code>apc_mfi</code> and <code>perc_tfna_pos</code> values.</p>
<p>The column names are the same as those used in the <a href="../week-2/workshop.html">Data Analysis 2: Immunobiology - Sample data analysis</a> workshop.</p>
</section><section id="set-up" class="level2"><h2 class="anchored" data-anchor-id="set-up">Set up</h2>
<p>🎬 Open the RStudio project you created in the <a href="../week-2/workshop.html">Data Analysis 2: Immunobiology - Sample data analysis</a> workshop.</p>
<p>🎬 Create a new script called <code>data-presentation.R</code></p>
<p>🎬 Load packages:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 Save a copy of <a href="data-processed/live_labelled.csv">live_labelled.csv</a> to your <code>data-processed</code> folder. These cells have been AI cleaned, gated to remove debris and dead cells, and labelled as positive or negative for the E_coli_FITC_Lin and TNFa_APC_Lin signals<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>🎬 Import the data:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_nondebris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data-processed/live_labelled.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 I’m also going to select only columns I need to keep my life simple:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_nondebris</span> <span class="op">&lt;-</span> <span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">FS_Lin</span>,</span>
<span>         <span class="va">SS_Lin</span>,</span>
<span>         <span class="va">E_coli_FITC_Lin</span>,</span>
<span>         <span class="va">TNFa_APC_Lin</span>,</span>
<span>         <span class="va">antibody</span>,</span>
<span>         <span class="va">treatment</span>,</span>
<span>         <span class="va">tnfa</span>,</span>
<span>         <span class="va">fitc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These are the forward and side scatter, the two logicle-transformed signals the groups (treatment and antibody) and whether the cell is positive or negative for each of the signals.</p>
<p>🎬 Click on the data frame in the environment window to view it and make sure you have an understanding of the data.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">FS_Lin</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">SS_Lin</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">E_coli_FITC_Lin</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">TNFa_APC_Lin</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">antibody</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">treatment</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">fitc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">27304</td>
<td style="text-align: right;">21432</td>
<td style="text-align: right;">2.573944</td>
<td style="text-align: right;">1.797574</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">16437</td>
<td style="text-align: right;">18261</td>
<td style="text-align: right;">3.303969</td>
<td style="text-align: right;">1.553092</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23356</td>
<td style="text-align: right;">20257</td>
<td style="text-align: right;">3.024955</td>
<td style="text-align: right;">1.432302</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">20567</td>
<td style="text-align: right;">19949</td>
<td style="text-align: right;">1.665994</td>
<td style="text-align: right;">1.602869</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31556</td>
<td style="text-align: right;">24441</td>
<td style="text-align: right;">3.363674</td>
<td style="text-align: right;">1.674940</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25858</td>
<td style="text-align: right;">18398</td>
<td style="text-align: right;">1.592289</td>
<td style="text-align: right;">1.469350</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25512</td>
<td style="text-align: right;">11655</td>
<td style="text-align: right;">1.592289</td>
<td style="text-align: right;">1.535148</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">26949</td>
<td style="text-align: right;">18936</td>
<td style="text-align: right;">3.629136</td>
<td style="text-align: right;">1.762831</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22715</td>
<td style="text-align: right;">24400</td>
<td style="text-align: right;">3.345617</td>
<td style="text-align: right;">1.810729</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">29398</td>
<td style="text-align: right;">21824</td>
<td style="text-align: right;">3.687067</td>
<td style="text-align: right;">1.688024</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>🎬 Use <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> to put treatment groups in order so that our graphs are better to interpret.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_nondebris</span> <span class="op">&lt;-</span> <span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MEDIA"</span>,</span>
<span>                                              <span class="st">"LPS"</span>,</span>
<span>                                              <span class="st">"ECOLIGreen"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to calculate some summary information such as the percent of TNF-α positive cells in each sample and the mean fluorescence intensity of the TNFa_APC_Lin signal in the TNF-α positive cells. If you especially hate <code>R</code> but are familiar with pivot tables in Excel, then you could use that….. but it would not be as reproducible as using <code>R</code> and <code>tidyverse</code> functions.</p>
<p>🎬 Calculate the number of cells in each sample:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># number of cells in each sample after gating</span></span>
<span><span class="va">clean_trans_nondebris_n</span> <span class="op">&lt;-</span>  <span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">antibody</span>, <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n_nondebris <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 Click on the dataframe in the environment window to view it and make sure you have an understanding of the summary.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">antibody</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">treatment</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n_nondebris</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: right;">13106</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: right;">45138</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: right;">26866</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: right;">24419</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: right;">25479</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: right;">26002</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>🎬 Calculate the number of TNF-α positive cells in each sample and the mean fluorescence intensity of the TNFa_APC_Lin signal in the TNF-α positive cells:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## summarise the number of TNF-α +'ve cells in each sample  </span></span>
<span><span class="va">clean_trans_nondebris_tfna_pos</span> <span class="op">&lt;-</span> <span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">tnfa</span> <span class="op">==</span> <span class="st">"TNF-α +'ve"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">antibody</span>, <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n_pos_tnfa <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            mean_apc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">TNFa_APC_Lin</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 Click on the dataframe in the environment window to view it and make sure you have an understanding of the summary.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">antibody</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">treatment</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n_pos_tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">mean_apc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">2.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: right;">13503</td>
<td style="text-align: right;">2.26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: right;">25414</td>
<td style="text-align: right;">3.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: right;">25965</td>
<td style="text-align: right;">3.27</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>Note: If your dataframe has 0 rows first check you have written “TNF-α +’ve” correctly in the filter function (other no rows will match). If you have written it correctly, and you are working on your own machine, you may have different character encoding. The simplest solution: is to repeat the step in workshop 2</p>
<ul>
<li><p>is to repeat the step in workshop 2 “Add a label, tnfa, to the data to indicate if the cell is positive or negative for TNF-α” by using TNF-a rather than TNF-α in the labelling</p></li>
<li><p>make sure you resave the data (“data-processed/live_labelled.csv”) after that step</p></li>
<li><p>make sure you edit the code in this workshop to reflect the change in the label</p></li>
</ul>
<p>In order to calculate the percentage of cells that are TNF-α positive, we need to join the two summaries together and add a column using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>.</p>
<p>🎬 Join the summary of the total number of cells in each sample with the summary of the number of TNF-α positive cells in each sample and calculate the percentage of cells that are TNF-α positive:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## join the summary with the summary of the number of cells in each sample</span></span>
<span><span class="co">## and calculate the percentage of cells that are TNF-α +'ve</span></span>
<span><span class="va">clean_trans_nondebris_tfna_pos</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">clean_trans_nondebris_tfna_pos</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">clean_trans_nondebris_n</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"antibody"</span>, <span class="st">"treatment"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>perc_tfna_pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n_pos_tnfa</span><span class="op">/</span><span class="va">n_nondebris</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 Click on the dataframe in the environment window to view it and make sure you have an understanding of the summary.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">antibody</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">treatment</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n_pos_tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">mean_apc</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n_nondebris</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">perc_tfna_pos</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">13106</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">45138</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">26866</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: right;">13503</td>
<td style="text-align: right;">2.26</td>
<td style="text-align: right;">24419</td>
<td style="text-align: right;">55.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: right;">25414</td>
<td style="text-align: right;">3.14</td>
<td style="text-align: right;">25479</td>
<td style="text-align: right;">99.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: right;">25965</td>
<td style="text-align: right;">3.27</td>
<td style="text-align: right;">26002</td>
<td style="text-align: right;">99.9</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip for your own summaries
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can use the same process calculate the percentage of cells that are FITC positive in each sample and the mean fluorescence intensity of the FITC signal in the FITC positive cells.</p>
</div>
</div>
</section><section id="distribution-of-apc-tnf-α-signal-with-gate" class="level2"><h2 class="anchored" data-anchor-id="distribution-of-apc-tnf-α-signal-with-gate">Distribution of APC TNF-α signal with gate</h2>
<p>To annotate the distribution of APC TNF-α signal with the gate used to define whether the cells are positive or negative for TNF-α it is useful to assign that value to a variable that we can use in our plots. We will do the FITC gate value at the same time<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<p>🎬 Assign the gate values to variables:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">apc_cut</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">fitc_cut</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plot-one-sample" class="level3"><h3 class="anchored" data-anchor-id="plot-one-sample">Plot one sample</h3>
<p>The pipe (<code>|&gt;</code>) allows us to filter the data before plotting it which allows select the sample we want to plot.</p>
<p>🎬 Plot the distribution of the APC TNF-α signal for the MEDIA <code>treatment</code> and the ISOTYPE <code>antibody</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>           <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline()</a></code> adds a vertical line to the plot at the value of <code>apc_cut</code> which is the gate value we determined for the APC TNF-α signal.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> is a smoothed version of a histogram and shows the distribution of the data. The fill argument sets the colour of the plot to a light grey.</p></li>
<li><p>the expand argument in a <code>scale_x_....</code> or <code>scale_y_....</code> sets the axis line at zero rather than being below it.</p></li>
</ul>
<section id="plot-annotation" class="level4"><h4 class="anchored" data-anchor-id="plot-annotation">Plot annotation</h4>
<p>You have (at least) three options for adding the summary statistics to the plot.</p>
<ol type="1">
<li>
<p>Most simple: adding in word/googledocs (or whatever you write your report in).</p>
<p>Save the plot using <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, insert as an image into your report and a text box.</p>
</li>
<li><p>In R by hard coding the values in the <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> function.</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>         <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"0.1 % cells\nTNF-α +'ve\nMFI = 2.14"</span>,</span>
<span>            x <span class="op">=</span> <span class="fl">1.6</span>,</span>
<span>            y <span class="op">=</span> <span class="fl">2.2</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>In R and fully reproducibly by using the <code>clean_trans_nondebris_tfna_pos</code> dataframe with the summary statistics in <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>. That dataframe also needs filtering to the sample you are plotting.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>         <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">clean_trans_nondebris_tfna_pos</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>                     <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">perc_tfna_pos</span>, </span>
<span>                                <span class="st">"% cells\nTNF-α +'ve\nMFI = "</span>,</span>
<span>                                <span class="va">mean_apc</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             x <span class="op">=</span> <span class="fl">1.7</span>, </span>
<span>             y <span class="op">=</span> <span class="fl">2.1</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<p>This has several advantages:</p>
<ul>
<li><p>if the data changes, the plot annotation will update automatically just as the distribution will.</p></li>
<li><p>extending to multiple facets requires little extra work.</p></li>
</ul></section></section><section id="write-to-file" class="level3"><h3 class="anchored" data-anchor-id="write-to-file">Write to file</h3>
<p>🎬 Assign the plot to <code>apc_distibution_media_isotype</code></p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">apc_distibution_media_isotype</span> <span class="op">&lt;-</span> <span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>         <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">clean_trans_nondebris_tfna_pos</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>                     <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">perc_tfna_pos</span>, </span>
<span>                                <span class="st">"% cells\nTNF-α +'ve\nMFI = "</span>,</span>
<span>                                <span class="va">mean_apc</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             x <span class="op">=</span> <span class="fl">1.7</span>, </span>
<span>             y <span class="op">=</span> <span class="fl">2.1</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 Save the plot to a file:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"figures/apc_distibution_media_isotype.png"</span>,</span>
<span>       device <span class="op">=</span> <span class="st">"png"</span>,</span>
<span>       plot <span class="op">=</span> <span class="va">apc_distibution_media_isotype</span>,</span>
<span>       width <span class="op">=</span> <span class="fl">4</span>,</span>
<span>       height <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>       units <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>       dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="multiple-facets" class="level3"><h3 class="anchored" data-anchor-id="multiple-facets">Multiple facets</h3>
<p>To plot all the samples in one go we can use <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code>. <code>treatment ~ antibody</code> puts the treatments in rows and the antibodies in columns. Of course, we now don’t need to filter the data to a single sample.</p>
<p>🎬 Plot the distribution of the APC TNF-α signal for all samples:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">clean_trans_nondebris_tfna_pos</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">perc_tfna_pos</span>, </span>
<span>                                <span class="st">"% cells\nTNF-α +'ve\nMFI = "</span>,</span>
<span>                                <span class="va">mean_apc</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             x <span class="op">=</span> <span class="fl">4</span>, </span>
<span>             y <span class="op">=</span> <span class="fl">1.8</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">~</span> <span class="va">antibody</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<p>Note that adding plot annotations manually (method 1) and using R fully reproducibly (method 3) are possible on faceted plots but method 2 is not because you need the annotations to change with values in treatment and antibody.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip for your own plots
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can combine filtering data and faceted plots to do facet plots of a subset of the samples.</p>
</div>
</div>
</section><section id="overlay-instead-of-facets" class="level3"><h3 class="anchored" data-anchor-id="overlay-instead-of-facets">Overlay instead of facets</h3>
<p>Using facets is one way to show multiple samples in one plot. Another way is to overlay the plots by mapping the <code>fill</code> aesthetic to the <code>antibody</code> variable. Making the fill semi-transparent with <code>alpha = 0.3</code> allows you to see the overlap of the distributions.</p>
<p>🎬 Overlay the distribution of the APC TNF-α signals for the media treated samples:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span>, fill <span class="op">=</span> <span class="va">antibody</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>              color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<p>To change the colours we need to used a <code>scale_fill_...</code> function. These functions can also be used to change the name (<code>name = ...</code>) of the legend and the names (<code>labels = c(...)</code>) of each group. <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code> allows to specify the colours (<code>values = c(...)</code>) manually.</p>
<p>Instead of picking colours, I like to use the viridis scales. The viridis scales provide colour maps that are perceptually uniform in both colour and black-and-white. They are also designed to be perceived by viewers with common forms of colour blindness. See <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html#introduction">Introduction to viridis</a> for more information.</p>
<p>Here I use <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d()</a></code>. The d stands for discrete. The function <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c()</a></code> would be used for continuous data. I’ve used the default “viridis” (or “D”) option (do <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">?scale_fill_viridis_d</a></code> for all the options) and got rid of the “antibody” name. I also moved the legend.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span>, fill <span class="op">=</span> <span class="va">antibody</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>              color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="workshop_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="percentage-of-cells-in-each-quadrant" class="level2"><h2 class="anchored" data-anchor-id="percentage-of-cells-in-each-quadrant">Percentage of cells in each quadrant</h2>
<p>We want to calculate the the percentage of cells in each quadrant of a quadrant gated plot of TNFa_APC_Lin signal against the E_coli_FITC_Lin signal.</p>
<p>🎬 Calculate the number of cells in each quadrant for each sample:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## calculate the number of cells in each quadrant</span></span>
<span><span class="va">all_combin_n</span> <span class="op">&lt;-</span> <span class="va">clean_trans_nondebris</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">antibody</span>, <span class="va">treatment</span>, <span class="va">tnfa</span>, <span class="va">fitc</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 Click on the data frame in the environment window to view it and make sure you have an understanding of the data.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">antibody</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">treatment</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">fitc</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">13091</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">45109</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">15457</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">11386</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">13483</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">10914</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">25401</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">14969</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">10996</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>As there are four quadrants and six samples, you would expect 24 rows in the data frame. However, there are only 23 rows. This is because there are no cells in the quadrant where both cells are positive for both TNF-α and FITC for the ISOTYOPE antibody and MEDIA treated samples. Since we are probably happy not to annotate a figure with 0 %, this is fine.</p>
<p>To calculate the percentage of cells in each quadrant, we need to join this dataframe with the number of non-debris cells for each sample, <em>i.e.,</em> <code>clean_trans_nondebris_n</code></p>
<p>🎬 Calculate the percentage of cells in each quadrant for each sample:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_combin_perc</span> <span class="op">&lt;-</span> <span class="va">all_combin_n</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">clean_trans_nondebris_n</span>, </span>
<span>            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"antibody"</span>, <span class="st">"treatment"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>perc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="va">n_nondebris</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">perc</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I have additionally filtered out rows where the % cells rounds to 0. This is again because we are probably happy not to annotate a figure with 0 %.</p>
<p>🎬 Click on the data frame in the environment window to view it and make sure you have an understanding of the data.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">antibody</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">treatment</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">fitc</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n_nondebris</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">perc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">13106</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">13091</td>
<td style="text-align: right;">13106</td>
<td style="text-align: right;">99.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">45138</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">45109</td>
<td style="text-align: right;">45138</td>
<td style="text-align: right;">99.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">26866</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">15457</td>
<td style="text-align: right;">26866</td>
<td style="text-align: right;">57.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">11386</td>
<td style="text-align: right;">26866</td>
<td style="text-align: right;">42.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">24419</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">13483</td>
<td style="text-align: right;">24419</td>
<td style="text-align: right;">55.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">10914</td>
<td style="text-align: right;">24419</td>
<td style="text-align: right;">44.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">25479</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">25401</td>
<td style="text-align: right;">25479</td>
<td style="text-align: right;">99.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">25479</td>
<td style="text-align: right;">0.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">14969</td>
<td style="text-align: right;">26002</td>
<td style="text-align: right;">57.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">10996</td>
<td style="text-align: right;">26002</td>
<td style="text-align: right;">42.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">26002</td>
<td style="text-align: right;">0.1</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip for your own plots
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can combine the concept of annotation and faceted plots to annotate a quadrant gated plot of TNFa_APC_Lin signal against the E_coli_FITC_Lin signal you made in the <a href="../week-2/workshop.html">Data Analysis 2: Immunobiology - Sample data analysis</a> workshop.</p>
</div>
</div>
</section><section id="importing-from-google-sheets" class="level2"><h2 class="anchored" data-anchor-id="importing-from-google-sheets">Importing from google sheets</h2>
<p>The <a href="https://docs.google.com/spreadsheets/d/104EXdgsiIq-FuRF9Ly9zewEVdpkVWbyOwxSAmiqJepg/edit#gid=0">BIO00066I Biomedical Sciences class data</a> are in a google sheet. You can download the file as an excel file or .csv. file but it is also possible to import the data directly from the google sheet into R. Use whatever you prefer. An advantage of using the google sheet is you won’t have to remember to download the data when someone updates it.</p>
<p>You can use the <code>googlesheets4</code> package <span class="citation" data-cites="googlesheets4">(<a href="#ref-googlesheets4" role="doc-biblioref">Bryan 2023</a>)</span> to do this.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://googlesheets4.tidyverse.org">googlesheets4</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="st">"https://docs.google.com/spreadsheets/d/104EXdgsiIq-FuRF9Ly9zewEVdpkVWbyOwxSAmiqJepg/edit#gid=0"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">class_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You will be asked:</p>
<pre><code>Is it OK to cache OAuth access credentials in the folder
C:/Users/emmar/AppData/Local/gargle/gargle/Cache between R sessions?
1: Yes
2: No
Selection: </code></pre>
<p>Type the number for yes.</p>
<p>You will be prompted to authenticate with Google in a browser window.</p>
<p>I suggest clicking the box for:</p>
<blockquote class="blockquote">
<p>See, edit, create, and delete all your Google Sheets spreadsheets. Learn more</p>
</blockquote>
<p>but you do not have to. Click allow/continue.</p>
<p>You will see a message in the browser window:</p>
<blockquote class="blockquote">
<p>Authentication complete. Please close this page and return to R.</p>
</blockquote>
<p>You should see that the class data has been imported into R.</p>
<p>Note that you will probably want to do some quality control such has filtering out rows with missing data in some columns. We did this in the <a href="../week-1/workshop.html#quality-control">Data Analysis 1: Core</a> workshop.</p>
</section><section id="analysis-of-the-class-data" class="level2"><h2 class="anchored" data-anchor-id="analysis-of-the-class-data">Analysis of the class data</h2>
<p>You should be able to apply techniques you have learned in stage 1 to the class data. You can find those materials on the VLE in the 17C/8C module sites. However, you may find it useful to use the latest version of those material which are available outside the VLE at without 2FA.</p>
<p>Stage 1</p>
<ul>
<li><p><a href="../../r4babs1/r4babs1.html">Data Analysis in R for Becoming a Bioscientist 1</a> <span class="citation" data-cites="rand2023">(<a href="#ref-rand2023" role="doc-biblioref">Rand 2023a</a>)</span>. Core concepts about scientific computing, types of variable, the role of variables in analysis and how to use RStudio to organise analysis and import, summarise and plot data.</p></li>
<li><p><a href="../../r4babs2/r4babs2.html">Data Analysis in R for Becoming a Bioscientist 2</a> <span class="citation" data-cites="rand2023">(<a href="#ref-rand2023" role="doc-biblioref">Rand 2023a</a>)</span>. The logic of hypothesis testing, confidence intervals, what is meant by a statistical model, two-sample tests and one- and two-way analysis of variance (ANOVA).</p></li>
<li><p>Supporting book <a href="https://3mmarand.github.io/comp4biosci/">Computational Analysis for Bioscientists</a> <span class="citation" data-cites="Rand_Comp_Analysis">(<a href="#ref-Rand_Comp_Analysis" role="doc-biblioref">Rand 2023b</a>)</span></p></li>
</ul></section></section><section id="independent-study-following-the-workshop" class="level1"><h1>Independent study following the workshop</h1>
<p><a href="../../r4babs4/week-6/study_after_workshop.html">Consolidate</a></p>
</section><section id="the-code-file" class="level1"><h1>The Code file</h1>
<p>This contains all the code needed in the workshop even where it is not visible on the webpage.</p>
<p>The <code>workshop.qmd</code> file is the file I use to compile the practical. Qmd stands for Quarto markdown. It allows code and ordinary text to be interweaved to produce well-formatted reports including webpages. <a href="https://github.com/3mmaRand/R4BABS/blob/main/r4babs4/week-6/workshop.qmd">View the Qmd in Browser</a>. Coding and thinking answers are marked with <code>#---CODING ANSWER---</code> and <code>#---THINKING ANSWER---</code></p>
<p>Pages made with R <span class="citation" data-cites="R-core">(<a href="#ref-R-core" role="doc-biblioref">R Core Team 2023</a>)</span>, Quarto <span class="citation" data-cites="allaire2022">(<a href="#ref-allaire2022" role="doc-biblioref">Allaire et al. 2022</a>)</span>, <code>knitr</code> <span class="citation" data-cites="knitr">(<a href="#ref-knitr" role="doc-biblioref">Xie 2022</a>)</span>, <code>kableExtra</code> <span class="citation" data-cites="kableExtra">(<a href="#ref-kableExtra" role="doc-biblioref">Zhu 2021</a>)</span></p>
</section><section id="references" class="level1">



</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-allaire2022" class="csl-entry" role="listitem">
Allaire, J. J., Charles Teague, Carlos Scheidegger, Yihui Xie, and Christophe Dervieux. 2022. <em>Quarto</em>. <a href="https://doi.org/10.5281/zenodo.5960048">https://doi.org/10.5281/zenodo.5960048</a>.
</div>
<div id="ref-googlesheets4" class="csl-entry" role="listitem">
Bryan, Jennifer. 2023. <span>“Googlesheets4: Access Google Sheets Using the Sheets API V4.”</span> <a href="https://CRAN.R-project.org/package=googlesheets4">https://CRAN.R-project.org/package=googlesheets4</a>.
</div>
<div id="ref-R-core" class="csl-entry" role="listitem">
R Core Team. 2023. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-rand2023" class="csl-entry" role="listitem">
Rand, Emma. 2023a. <em>Data Analysis in r for Becoming a Bioscientist</em>. <a href="https://3mmarand.github.io/R4BABS/">https://3mmarand.github.io/R4BABS/</a>.
</div>
<div id="ref-Rand_Comp_Analysis" class="csl-entry" role="listitem">
———. 2023b. <em><span class="nocase">Computational Analysis for Bioscientists</span></em> (version 0.1). <a href="https://3mmarand.github.io/comp4biosci/">https://3mmarand.github.io/comp4biosci/</a>.
</div>
<div id="ref-knitr" class="csl-entry" role="listitem">
Xie, Yihui. 2022. <span>“Knitr: A General-Purpose Package for Dynamic Report Generation in r.”</span> <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-kableExtra" class="csl-entry" role="listitem">
Zhu, Hao. 2021. <span>“kableExtra: Construct Complex Table with ’Kable’ and Pipe Syntax.”</span> <a href="https://CRAN.R-project.org/package=kableExtra">https://CRAN.R-project.org/package=kableExtra</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p><a href="../week-2/workshop.html">Data Analysis 2: Immunobiology - Sample data analysis</a> workshop has been amended to include the instruction to save these data at the end.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>You might want to look back at <a href="../week-2/workshop.html#quality-control-3-gating-to-determine-a-real-signal">Quality control 3: Gating to determine a ‘real’ signal</a> in the week 2 workshop to remind yourself of how we determined the gate values for the sample data.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/3mmarand\.github\.io\/R4BABS");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Rand, E. (2023). Data Analysis in R for Becoming a Bioscientist (Version 0.1) <a href="https://github.com/3mmaRand/R4BABS" class="uri">https://github.com/3mmaRand/R4BABS</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://mastodon.social/users/3mma">
<p>Emma on mastodon</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://github.com/3mmaRand">
<p>Emma on GitHub</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>