<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Emma Rand">
<title>Workshop – Data Analysis in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a03e91e75e70fe074cb6f9e1686248b2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-efba4cb111cfd8b4774c90a6412e7cf1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-a03e91e75e70fe074cb6f9e1686248b2.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-50FV9HPTRE"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-50FV9HPTRE', { 'anonymize_ip': true});
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Data Analysis in R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Welcome!</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../r4babs1/r4babs1.html"> 
<span class="menu-text">BABS 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../r4babs2/r4babs2.html"> 
<span class="menu-text">BABS 2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../r4babs4/r4babs4.html" aria-current="page"> 
<span class="menu-text">BABS 4</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../pgt52m/pgt52m.html"> 
<span class="menu-text">PGT 52M</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/3mmaRand" title="Emma on GitHub" class="quarto-navigation-tool px-1" aria-label="Emma on GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../r4babs4/week-6/overview.html">Week 6: DA 4 Biomed. Sci</a></li><li class="breadcrumb-item"><a href="../../r4babs4/week-6/workshop.html">Workshop</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/r4babs4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis in R for BABS 4</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 1: DA 1 Core</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-1/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-1/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-1/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-1/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 2: DA 2 Biomed. Sci</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-2/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-2/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-2/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-2/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 4: DA 3 Biomed. Sci</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-4/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-4/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-4/workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-4/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 6: DA 4 Biomed. Sci</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-6/overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-6/study_before_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prepare!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-6/workshop.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Workshop</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../r4babs4/week-6/study_after_workshop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidate!</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#exercises" id="toc-exercises" class="nav-link active" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
<li><a href="#set-up" id="toc-set-up" class="nav-link" data-scroll-target="#set-up">Set up</a></li>
  <li>
<a href="#distribution-of-apc-tnf-%CE%B1-signal-with-apc-gate" id="toc-distribution-of-apc-tnf-α-signal-with-apc-gate" class="nav-link" data-scroll-target="#distribution-of-apc-tnf-%CE%B1-signal-with-apc-gate">Distribution of APC TNF-α signal with APC gate</a>
  <ul class="collapse">
<li><a href="#plotting-one-sample" id="toc-plotting-one-sample" class="nav-link" data-scroll-target="#plotting-one-sample">Plotting one sample</a></li>
  <li><a href="#write-to-file" id="toc-write-to-file" class="nav-link" data-scroll-target="#write-to-file">Write to file</a></li>
  <li><a href="#multiple-facets" id="toc-multiple-facets" class="nav-link" data-scroll-target="#multiple-facets">Multiple facets</a></li>
  <li><a href="#overlay-instead-of-facets" id="toc-overlay-instead-of-facets" class="nav-link" data-scroll-target="#overlay-instead-of-facets">Overlay instead of facets</a></li>
  </ul>
</li>
  <li>
<a href="#a-figure-to-report-baselines-for-both-signals" id="toc-a-figure-to-report-baselines-for-both-signals" class="nav-link" data-scroll-target="#a-figure-to-report-baselines-for-both-signals">A figure to report baselines for both signals</a>
  <ul class="collapse">
<li><a href="#calculate-of-cells-in-each-quadrant" id="toc-calculate-of-cells-in-each-quadrant" class="nav-link" data-scroll-target="#calculate-of-cells-in-each-quadrant">Calculate % of cells in each quadrant</a></li>
  </ul>
</li>
  <li>
<a href="#importing-class-data" id="toc-importing-class-data" class="nav-link" data-scroll-target="#importing-class-data">Importing class data</a>
  <ul class="collapse">
<li><a href="#importing-from-a-googlesheet" id="toc-importing-from-a-googlesheet" class="nav-link" data-scroll-target="#importing-from-a-googlesheet">Importing from a googlesheet</a></li>
  </ul>
</li>
  <li><a href="#analysis-of-the-class-data" id="toc-analysis-of-the-class-data" class="nav-link" data-scroll-target="#analysis-of-the-class-data">Analysis of the class data</a></li>
  </ul>
</li>
  <li><a href="#independent-study-following-the-workshop" id="toc-independent-study-following-the-workshop" class="nav-link" data-scroll-target="#independent-study-following-the-workshop">Independent study following the workshop</a></li>
  <li><a href="#the-code-file" id="toc-the-code-file" class="nav-link" data-scroll-target="#the-code-file">The Code file</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/3mmaRand/comp4biosci/edit/main/r4babs4/week-6/workshop.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div><div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="#"><i class="bi bi-chat-left-dots"></i>Make a suggestion</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../r4babs4/week-6/overview.html">Week 6: DA 4 Biomed. Sci</a></li><li class="breadcrumb-item"><a href="../../r4babs4/week-6/workshop.html">Workshop</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Workshop</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Data Analysis 4: Biomedical sciences - Your data presentation</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In this workshop you will learn how to:</p>
<ul>
<li>create density plots to visualise the distribution and gating of the signals</li>
<li>create a quadrant gated plot of TNFa_APC_Lin signal against the E_coli_FITC_Lin signal.</li>
<li>calculate the the percentage of cells in each quadrant</li>
<li>annotate plots</li>
<li>import from a googlesheet.</li>
</ul>
<p>You will learn how to make a variety of plots but not <em>which</em> plots you should include in your report. You should select plots to match your narrative and you may need to apply your understanding of picking data for, faceting and annotating plots to get the plot you want.</p>
<p>You should have the processed data files listed below for your own data/the model data. However, if you do not, you can use the linked files prepared from the sample data</p>
<ul>
<li>
<a href="data-processed/clean_trans_live_tfna_pos.csv"><code>clean_trans_live_tfna_pos.csv</code></a>: Each row is a sample (a treatment-antibody combination). For each sample there is: the number of cells after AI cleaning, the number of live cells after gatting, the percentage of live cells, the number TNF-α postive cells, the percentage of TNF-α postive cells and the of the mean APC signal in the live cells and TNF-α postive cells</li>
<li>
<a href="data-processed/live_labelled.csv"><code>live_labelled.csv</code></a>: Each row is a cell. These are the AI cleaned, live cells with logicle-transformed TNFa_APC_Lin and E_coli_FITC_Lin signals. Each cell is labelled with the sample (filename) it came from, its treatment and antibody, and whether it is TNF-α positive (<em>i.e.</em> has a TNFa_APC_Lin level above the APC cut off used) or negative and whether it is FITC positive (<em>i.e.</em> E_coli_FITC_Lin level above the FITC cut off used) or negative.</li>
<li>you may also have the FITC equivalent of <code>clean_trans_live_tfna_pos.csv</code>
</li>
</ul>
<section id="exercises" class="level1"><h1>Exercises</h1>
<section id="set-up" class="level2"><h2 class="anchored" data-anchor-id="set-up">Set up</h2>
<p>🎬 Open the RStudio project you created in the <a href="../week-2/workshop.html">Data Analysis 2: Biomedical sciences - Sample data analysis</a> workshop.</p>
<p>🎬 Create a new script called <code>data-presentation.R</code></p>
<p>🎬 Load the <strong><code>tidyverse</code></strong>:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 Import the labelled live cell data and the sample summary data</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># import AI cleaned, logical transformed, live, labelled cell data</span></span>
<span><span class="va">clean_trans_live</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data-processed/live_labelled.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># import % live summary</span></span>
<span><span class="va">clean_trans_live_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data-processed/clean_trans_live_tfna_pos.csv"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It can helpful to select only the columns we need, especially for the <code>clean_trans_live</code> data. These are: <code>FS_Lin</code>, <code>SS_Lin</code>, <code>E_coli_FITC_Lin</code>, <code>TNFa_APC_Lin</code>, <code>treatment</code>, <code>antibody</code>, <code>tnfa</code> and <code>fitc</code></p>
<p>🎬 Select columns of interest:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_live</span> <span class="op">&lt;-</span> <span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">FS_Lin</span>, <span class="va">SS_Lin</span>, </span>
<span>         <span class="va">E_coli_FITC_Lin</span>, </span>
<span>         <span class="va">TNFa_APC_Lin</span>, </span>
<span>         <span class="va">treatment</span>, </span>
<span>         <span class="va">antibody</span>, </span>
<span>         <span class="va">tnfa</span>, </span>
<span>         <span class="va">fitc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 View each of the resulting dataframes (click on the name in the environment or use <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code>) to ensure you understand what they contain.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>clean_trans_live: The AI cleaned, logical transformed, live, labelled cell data (first 100 rows only</caption>
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">FS_Lin</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">SS_Lin</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">E_coli_FITC_Lin</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">TNFa_APC_Lin</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">treatment</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">antibody</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">fitc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">26469</td>
<td style="text-align: right;">20599</td>
<td style="text-align: right;">3.655921</td>
<td style="text-align: right;">3.412723</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">26934</td>
<td style="text-align: right;">23787</td>
<td style="text-align: right;">3.272194</td>
<td style="text-align: right;">3.593459</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">29254</td>
<td style="text-align: right;">21543</td>
<td style="text-align: right;">1.801447</td>
<td style="text-align: right;">3.452840</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">22195</td>
<td style="text-align: right;">12821</td>
<td style="text-align: right;">1.616435</td>
<td style="text-align: right;">3.439875</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22039</td>
<td style="text-align: right;">19032</td>
<td style="text-align: right;">1.691861</td>
<td style="text-align: right;">3.564814</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">22123</td>
<td style="text-align: right;">11865</td>
<td style="text-align: right;">3.035990</td>
<td style="text-align: right;">3.200115</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30587</td>
<td style="text-align: right;">17424</td>
<td style="text-align: right;">1.815565</td>
<td style="text-align: right;">3.574573</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">28684</td>
<td style="text-align: right;">14202</td>
<td style="text-align: right;">1.663241</td>
<td style="text-align: right;">2.850781</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22446</td>
<td style="text-align: right;">11619</td>
<td style="text-align: right;">1.557735</td>
<td style="text-align: right;">2.982059</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">28379</td>
<td style="text-align: right;">19434</td>
<td style="text-align: right;">1.829238</td>
<td style="text-align: right;">3.523421</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20251</td>
<td style="text-align: right;">10645</td>
<td style="text-align: right;">3.265220</td>
<td style="text-align: right;">2.962754</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">23614</td>
<td style="text-align: right;">20337</td>
<td style="text-align: right;">1.779371</td>
<td style="text-align: right;">3.301572</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19158</td>
<td style="text-align: right;">11703</td>
<td style="text-align: right;">1.474916</td>
<td style="text-align: right;">3.426511</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">24965</td>
<td style="text-align: right;">11188</td>
<td style="text-align: right;">2.900112</td>
<td style="text-align: right;">3.319301</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24686</td>
<td style="text-align: right;">14899</td>
<td style="text-align: right;">2.887052</td>
<td style="text-align: right;">3.310527</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25099</td>
<td style="text-align: right;">18187</td>
<td style="text-align: right;">2.895513</td>
<td style="text-align: right;">3.405661</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">29365</td>
<td style="text-align: right;">15384</td>
<td style="text-align: right;">2.691221</td>
<td style="text-align: right;">3.534145</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">27772</td>
<td style="text-align: right;">23432</td>
<td style="text-align: right;">3.819682</td>
<td style="text-align: right;">3.677236</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">19748</td>
<td style="text-align: right;">11414</td>
<td style="text-align: right;">2.051026</td>
<td style="text-align: right;">3.211396</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">26165</td>
<td style="text-align: right;">13617</td>
<td style="text-align: right;">1.538461</td>
<td style="text-align: right;">3.164399</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18928</td>
<td style="text-align: right;">13369</td>
<td style="text-align: right;">1.544981</td>
<td style="text-align: right;">3.051695</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">19445</td>
<td style="text-align: right;">20246</td>
<td style="text-align: right;">3.829446</td>
<td style="text-align: right;">3.319301</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24822</td>
<td style="text-align: right;">17783</td>
<td style="text-align: right;">3.604818</td>
<td style="text-align: right;">3.661723</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">24683</td>
<td style="text-align: right;">15608</td>
<td style="text-align: right;">1.544981</td>
<td style="text-align: right;">3.405661</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">27893</td>
<td style="text-align: right;">13294</td>
<td style="text-align: right;">2.611207</td>
<td style="text-align: right;">3.327901</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25050</td>
<td style="text-align: right;">16932</td>
<td style="text-align: right;">1.731540</td>
<td style="text-align: right;">3.164399</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26180</td>
<td style="text-align: right;">16349</td>
<td style="text-align: right;">3.118054</td>
<td style="text-align: right;">3.501144</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25565</td>
<td style="text-align: right;">13621</td>
<td style="text-align: right;">1.829238</td>
<td style="text-align: right;">3.164399</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22046</td>
<td style="text-align: right;">16315</td>
<td style="text-align: right;">2.677597</td>
<td style="text-align: right;">3.344607</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25447</td>
<td style="text-align: right;">18034</td>
<td style="text-align: right;">1.648192</td>
<td style="text-align: right;">3.501144</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18282</td>
<td style="text-align: right;">12319</td>
<td style="text-align: right;">3.627092</td>
<td style="text-align: right;">3.283089</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">23363</td>
<td style="text-align: right;">9366</td>
<td style="text-align: right;">1.482452</td>
<td style="text-align: right;">3.097452</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30433</td>
<td style="text-align: right;">16879</td>
<td style="text-align: right;">2.754385</td>
<td style="text-align: right;">3.405661</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">21885</td>
<td style="text-align: right;">11068</td>
<td style="text-align: right;">1.474916</td>
<td style="text-align: right;">3.035305</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">28801</td>
<td style="text-align: right;">14527</td>
<td style="text-align: right;">1.658282</td>
<td style="text-align: right;">3.465429</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">26517</td>
<td style="text-align: right;">14248</td>
<td style="text-align: right;">3.426464</td>
<td style="text-align: right;">3.352725</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">34001</td>
<td style="text-align: right;">23804</td>
<td style="text-align: right;">3.876131</td>
<td style="text-align: right;">3.750665</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25280</td>
<td style="text-align: right;">15484</td>
<td style="text-align: right;">1.936096</td>
<td style="text-align: right;">3.446406</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26224</td>
<td style="text-align: right;">10978</td>
<td style="text-align: right;">2.554881</td>
<td style="text-align: right;">3.412723</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">26428</td>
<td style="text-align: right;">19525</td>
<td style="text-align: right;">3.433386</td>
<td style="text-align: right;">3.483654</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23265</td>
<td style="text-align: right;">10872</td>
<td style="text-align: right;">1.474916</td>
<td style="text-align: right;">3.292429</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">27550</td>
<td style="text-align: right;">20423</td>
<td style="text-align: right;">2.892905</td>
<td style="text-align: right;">3.534145</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24407</td>
<td style="text-align: right;">19252</td>
<td style="text-align: right;">1.718712</td>
<td style="text-align: right;">3.607103</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">21299</td>
<td style="text-align: right;">22389</td>
<td style="text-align: right;">3.349083</td>
<td style="text-align: right;">3.459180</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">28336</td>
<td style="text-align: right;">16448</td>
<td style="text-align: right;">3.648432</td>
<td style="text-align: right;">3.419671</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">23089</td>
<td style="text-align: right;">14393</td>
<td style="text-align: right;">3.457651</td>
<td style="text-align: right;">3.528816</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22139</td>
<td style="text-align: right;">11209</td>
<td style="text-align: right;">1.605312</td>
<td style="text-align: right;">2.982059</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">27508</td>
<td style="text-align: right;">12098</td>
<td style="text-align: right;">2.642835</td>
<td style="text-align: right;">3.419671</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24216</td>
<td style="text-align: right;">14953</td>
<td style="text-align: right;">2.722446</td>
<td style="text-align: right;">3.398482</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">23216</td>
<td style="text-align: right;">18225</td>
<td style="text-align: right;">3.046321</td>
<td style="text-align: right;">3.360694</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">27858</td>
<td style="text-align: right;">13568</td>
<td style="text-align: right;">2.437061</td>
<td style="text-align: right;">3.253799</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">23366</td>
<td style="text-align: right;">12624</td>
<td style="text-align: right;">1.588075</td>
<td style="text-align: right;">3.200115</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22465</td>
<td style="text-align: right;">22049</td>
<td style="text-align: right;">3.581519</td>
<td style="text-align: right;">3.477663</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">29411</td>
<td style="text-align: right;">16536</td>
<td style="text-align: right;">3.115450</td>
<td style="text-align: right;">3.534145</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">27082</td>
<td style="text-align: right;">11514</td>
<td style="text-align: right;">3.046117</td>
<td style="text-align: right;">3.111693</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">28336</td>
<td style="text-align: right;">16448</td>
<td style="text-align: right;">3.648432</td>
<td style="text-align: right;">3.419671</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23604</td>
<td style="text-align: right;">13708</td>
<td style="text-align: right;">3.306040</td>
<td style="text-align: right;">3.465429</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">21610</td>
<td style="text-align: right;">10787</td>
<td style="text-align: right;">1.391368</td>
<td style="text-align: right;">3.067489</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21962</td>
<td style="text-align: right;">11956</td>
<td style="text-align: right;">1.435143</td>
<td style="text-align: right;">3.327901</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25645</td>
<td style="text-align: right;">24063</td>
<td style="text-align: right;">3.326008</td>
<td style="text-align: right;">3.579372</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25057</td>
<td style="text-align: right;">12138</td>
<td style="text-align: right;">1.599642</td>
<td style="text-align: right;">3.398482</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25688</td>
<td style="text-align: right;">14065</td>
<td style="text-align: right;">1.668144</td>
<td style="text-align: right;">3.164399</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21793</td>
<td style="text-align: right;">14611</td>
<td style="text-align: right;">2.385079</td>
<td style="text-align: right;">3.273543</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">29577</td>
<td style="text-align: right;">17082</td>
<td style="text-align: right;">1.848974</td>
<td style="text-align: right;">3.753870</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24205</td>
<td style="text-align: right;">21646</td>
<td style="text-align: right;">1.835917</td>
<td style="text-align: right;">3.292429</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">22260</td>
<td style="text-align: right;">12806</td>
<td style="text-align: right;">2.591877</td>
<td style="text-align: right;">3.336334</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26450</td>
<td style="text-align: right;">12121</td>
<td style="text-align: right;">1.643058</td>
<td style="text-align: right;">3.489563</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">19163</td>
<td style="text-align: right;">8446</td>
<td style="text-align: right;">1.482452</td>
<td style="text-align: right;">3.310527</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23193</td>
<td style="text-align: right;">9937</td>
<td style="text-align: right;">1.593897</td>
<td style="text-align: right;">3.327901</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">23724</td>
<td style="text-align: right;">15694</td>
<td style="text-align: right;">2.791906</td>
<td style="text-align: right;">3.352725</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">29743</td>
<td style="text-align: right;">16705</td>
<td style="text-align: right;">1.705494</td>
<td style="text-align: right;">3.681029</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">24749</td>
<td style="text-align: right;">11695</td>
<td style="text-align: right;">1.504309</td>
<td style="text-align: right;">3.067489</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25354</td>
<td style="text-align: right;">22005</td>
<td style="text-align: right;">1.764005</td>
<td style="text-align: right;">3.523421</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25840</td>
<td style="text-align: right;">11644</td>
<td style="text-align: right;">1.418157</td>
<td style="text-align: right;">3.125481</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26394</td>
<td style="text-align: right;">18609</td>
<td style="text-align: right;">1.928129</td>
<td style="text-align: right;">3.724134</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">20625</td>
<td style="text-align: right;">12195</td>
<td style="text-align: right;">1.576192</td>
<td style="text-align: right;">3.263784</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">25173</td>
<td style="text-align: right;">12610</td>
<td style="text-align: right;">1.531842</td>
<td style="text-align: right;">3.151810</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">21383</td>
<td style="text-align: right;">11286</td>
<td style="text-align: right;">1.653266</td>
<td style="text-align: right;">3.327901</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">29427</td>
<td style="text-align: right;">18400</td>
<td style="text-align: right;">1.756113</td>
<td style="text-align: right;">3.319301</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">30092</td>
<td style="text-align: right;">17994</td>
<td style="text-align: right;">3.499950</td>
<td style="text-align: right;">3.805022</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23462</td>
<td style="text-align: right;">13486</td>
<td style="text-align: right;">1.551405</td>
<td style="text-align: right;">3.263784</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">25580</td>
<td style="text-align: right;">14284</td>
<td style="text-align: right;">3.052806</td>
<td style="text-align: right;">3.426511</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20115</td>
<td style="text-align: right;">12329</td>
<td style="text-align: right;">1.467247</td>
<td style="text-align: right;">3.336334</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">20634</td>
<td style="text-align: right;">22645</td>
<td style="text-align: right;">1.714351</td>
<td style="text-align: right;">3.319301</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26361</td>
<td style="text-align: right;">11972</td>
<td style="text-align: right;">1.588075</td>
<td style="text-align: right;">3.398482</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">19723</td>
<td style="text-align: right;">22607</td>
<td style="text-align: right;">1.767898</td>
<td style="text-align: right;">3.477663</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">28813</td>
<td style="text-align: right;">18622</td>
<td style="text-align: right;">1.735733</td>
<td style="text-align: right;">3.588814</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">28102</td>
<td style="text-align: right;">26213</td>
<td style="text-align: right;">3.262622</td>
<td style="text-align: right;">3.574573</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22582</td>
<td style="text-align: right;">13318</td>
<td style="text-align: right;">3.488595</td>
<td style="text-align: right;">3.426511</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">22114</td>
<td style="text-align: right;">11226</td>
<td style="text-align: right;">2.817198</td>
<td style="text-align: right;">3.376206</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26787</td>
<td style="text-align: right;">15780</td>
<td style="text-align: right;">1.653266</td>
<td style="text-align: right;">3.344607</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">26708</td>
<td style="text-align: right;">23637</td>
<td style="text-align: right;">4.091778</td>
<td style="text-align: right;">3.544610</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">29361</td>
<td style="text-align: right;">14572</td>
<td style="text-align: right;">1.643058</td>
<td style="text-align: right;">3.452840</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">33706</td>
<td style="text-align: right;">17976</td>
<td style="text-align: right;">3.423904</td>
<td style="text-align: right;">3.579372</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">21198</td>
<td style="text-align: right;">12047</td>
<td style="text-align: right;">1.627280</td>
<td style="text-align: right;">3.391183</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">19099</td>
<td style="text-align: right;">18118</td>
<td style="text-align: right;">1.764005</td>
<td style="text-align: right;">3.477663</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24290</td>
<td style="text-align: right;">10269</td>
<td style="text-align: right;">3.143272</td>
<td style="text-align: right;">3.253799</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">19958</td>
<td style="text-align: right;">9390</td>
<td style="text-align: right;">2.979102</td>
<td style="text-align: right;">3.164399</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
</tr>
<tr class="odd">
<td style="text-align: right;">31077</td>
<td style="text-align: right;">14751</td>
<td style="text-align: right;">1.739887</td>
<td style="text-align: right;">3.549750</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
<tr class="even">
<td style="text-align: right;">23515</td>
<td style="text-align: right;">11006</td>
<td style="text-align: right;">1.570126</td>
<td style="text-align: right;">3.419671</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>clean_trans_live_n: sample summaries</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">antibody</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n_live</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">perc_live</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean_apc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n_pos_tnfa</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">perc_pos_tnfa</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: right;">20154</td>
<td style="text-align: right;">17856</td>
<td style="text-align: right;">88.6</td>
<td style="text-align: right;">3.950328</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: right;">31789</td>
<td style="text-align: right;">30675</td>
<td style="text-align: right;">96.5</td>
<td style="text-align: right;">3.968852</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: right;">44095</td>
<td style="text-align: right;">41927</td>
<td style="text-align: right;">95.1</td>
<td style="text-align: right;">3.867921</td>
<td style="text-align: right;">278</td>
<td style="text-align: right;">0.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: right;">31089</td>
<td style="text-align: right;">28085</td>
<td style="text-align: right;">90.3</td>
<td style="text-align: right;">4.121845</td>
<td style="text-align: right;">20066</td>
<td style="text-align: right;">71.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: right;">31945</td>
<td style="text-align: right;">30536</td>
<td style="text-align: right;">95.6</td>
<td style="text-align: right;">5.075325</td>
<td style="text-align: right;">30481</td>
<td style="text-align: right;">99.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: right;">32591</td>
<td style="text-align: right;">30715</td>
<td style="text-align: right;">94.2</td>
<td style="text-align: right;">5.201248</td>
<td style="text-align: right;">30686</td>
<td style="text-align: right;">99.9</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>By default, categorical variables are plotted in alphabetical order. The alphabetical order of the antibody type - ISOTYPE, TNFAPC - makes sense since ISOTYPE is the control. However, that of treatment - ECOLIGreen, LPS, MEDIA - is not. We will put these in a better order with MEDIA first for the live cell data.</p>
<p>🎬 Use <code><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel()</a></code> to put treatment groups in order so that our graphs are better to interpret.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_live</span> <span class="op">&lt;-</span> <span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MEDIA"</span>,</span>
<span>                                              <span class="st">"LPS"</span>,</span>
<span>                                              <span class="st">"ECOLIGreen"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="distribution-of-apc-tnf-α-signal-with-apc-gate" class="level2"><h2 class="anchored" data-anchor-id="distribution-of-apc-tnf-α-signal-with-apc-gate">Distribution of APC TNF-α signal with APC gate</h2>
<p>We often want to show the distribution of a signal with the value we used as a threshold (gate) so that readers can evaluate whether the value chosen is appropriate in their opinion. A distribution is best shown with a histogram or density plot. We will annotate the distribution of APC TNF-α signal with the gate used to define whether the cells are positive or negative for TNF-α. it is useful to assign that value to a variable that we can use in our plots<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>🎬 Assign the TNF-α gate value a variable remembering that your number will differ:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">apc_cut</span> <span class="op">&lt;-</span> <span class="fl">3.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 Also assign the FITC gate value a variable <code>fitc_cut</code>:</p>
<section id="plotting-one-sample" class="level3"><h3 class="anchored" data-anchor-id="plotting-one-sample">Plotting one sample</h3>
<p>Since the control sample (MEDIA, ISOTYPE) is crucial in determining the APC gating threshold, this is a useful plot.</p>
<p>We first filter the dataframe before plotting it which allows us to pick the sample we want to plot.</p>
<p>🎬 Plot the distribution of the APC TNF-α signal for the MEDIA <code>treatment</code> and the ISOTYPE <code>antibody</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>           <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-9-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="workshop_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline()</a></code> adds a vertical line to the plot at the value of <code>apc_cut</code> which is the gate value we determined for the APC TNF-α signal.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> is a smoothed version of a histogram<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> and shows the distribution of the data. The fill argument sets the colour of the plot to a light grey.</p></li>
<li><p>the expand argument in a <code>scale_x_....</code> or <code>scale_y_....</code> sets the axis line at zero rather than being below it.</p></li>
</ul>
<section id="plot-annotation" class="level4"><h4 class="anchored" data-anchor-id="plot-annotation">Plot annotation</h4>
<p>You have (at least) three options for adding the summary statistics to the plot.</p>
<ol type="1">
<li>
<p>Most simple: adding in word/googledocs (or whatever you write your report in).</p>
<p>Save the plot using <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, insert as an image into your report and a text box.</p>
</li>
<li><p>In R by hard coding the values in the <code><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate()</a></code> function. The values themselves you have calculated and are in the <code>clean_trans_live_n</code> dataframe</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>         <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>           label <span class="op">=</span> <span class="st">"0.2 % cells\nTNF-α +'ve\nMFI = 3.95"</span>,</span>
<span>           x <span class="op">=</span> <span class="fl">4.1</span>,</span>
<span>           y <span class="op">=</span> <span class="fl">2</span>,</span>
<span>           colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="workshop_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>In R and fully reproducibly by using the <code>clean_trans_live_n</code> dataframe with the summary statistics in <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>. That dataframe also needs filtering to the sample you are plotting. I have also rounded the <code>mean_apc</code> value to 2 decimal places.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>         <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">clean_trans_live_n</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>                     <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">perc_pos_tnfa</span>, </span>
<span>                               <span class="st">"% cells\nTNF-α +'ve\nMean = "</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mean_apc</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>           x <span class="op">=</span> <span class="fl">4.1</span>,</span>
<span>           y <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="workshop_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p>This has several advantages:</p>
<ul>
<li><p>if the data changes, the plot annotation will update automatically just as the distribution will.</p></li>
<li><p>extending to multiple facets requires little extra work.</p></li>
</ul></section></section><section id="write-to-file" class="level3"><h3 class="anchored" data-anchor-id="write-to-file">Write to file</h3>
<p>Whatever method you decide to use for annotation, you will need to save your figure as an image.</p>
<p>🎬 Assign the plot to <code>apc_distibution_media_isotype</code></p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">apc_distibution_media_isotype</span> <span class="op">&lt;-</span> <span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>         <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">clean_trans_live_n</span> <span class="op">|&gt;</span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span>,</span>
<span>                     <span class="va">antibody</span> <span class="op">==</span> <span class="st">"ISOTYPE"</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">perc_pos_tnfa</span>, </span>
<span>                               <span class="st">"% cells\nTNF-α +'ve\nMean = "</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mean_apc</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>           x <span class="op">=</span> <span class="fl">4.1</span>,</span>
<span>           y <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>🎬 Save the plot to a file:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"figures/apc_distibution_media_isotype.png"</span>,</span>
<span>       device <span class="op">=</span> <span class="st">"png"</span>,</span>
<span>       plot <span class="op">=</span> <span class="va">apc_distibution_media_isotype</span>,</span>
<span>       width <span class="op">=</span> <span class="fl">4</span>,</span>
<span>       height <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>       units <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>       dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="multiple-facets" class="level3"><h3 class="anchored" data-anchor-id="multiple-facets">Multiple facets</h3>
<p>To plot all the samples in one go we can use <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code>. <code>treatment ~ antibody</code> puts the treatments in rows and the antibodies in columns. Now do not need to filter the data to a single sample.</p>
<p>🎬 Plot the distribution of the APC TNF-α signal for all samples:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">clean_trans_live_n</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">perc_pos_tnfa</span>, </span>
<span>                                <span class="st">"% cells\nTNF-α +'ve\nMFI = "</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mean_apc</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             x <span class="op">=</span> <span class="fl">6</span>, </span>
<span>             y <span class="op">=</span> <span class="fl">1.7</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">~</span> <span class="va">antibody</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="workshop_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Methods of annotation for faceted plots
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that adding plot annotations manually (method 1) and using R fully reproducibly (method 3) are possible on faceted plots but method 2 is not because you need the annotations to change with values in treatment and antibody.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip for your own plots
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can combine filtering data and faceted plots to do facet plots of a subset of the samples. For example, you could filter for the ISOTYPE antibody and facet for the treatment.</p>
</div>
</div>
</section><section id="overlay-instead-of-facets" class="level3"><h3 class="anchored" data-anchor-id="overlay-instead-of-facets">Overlay instead of facets</h3>
<p>Using facets is <em>one</em> way to show multiple samples in one plot. Another is to overlay the plots by mapping the <code>fill</code> aesthetic to the <code>antibody</code> variable. Making the fill semi-transparent with <code>alpha = 0.3</code> allows you to see the overlap of the distributions.</p>
<p>🎬 Overlay the distribution of the APC TNF-α signals for the media treated samples:</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span>, fill <span class="op">=</span> <span class="va">antibody</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>              color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="workshop_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p>To use colours other than the default, we need to used a <code>scale_fill_...</code> function. These functions can also be used to change the name (<code>name = ...</code>) of the legend and the names (<code>labels = c(...)</code>) of each group. <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code> allows to specify the colours (<code>values = c(...)</code>) manually. So you might add:</p>
<p><code>scale_fill_manual(values = c("green", "blue"))</code></p>
<p>I like to use the viridis scales. The viridis scales provide colour maps that are perceptually uniform in both colour and black-and-white. They are also designed to be perceived by viewers with common forms of colour blindness. See <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html#introduction">Introduction to viridis</a> for more information. We do not have to know the names/codes for the colours because <strong><code>ggplot2</code></strong> provides these in special <code>scale_fill_...</code> functions.</p>
<p>Here I use <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d()</a></code>. The d stands for discrete - <code>antibody</code>, the variable mapped to <code>fill</code>, is discrete. The function <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c()</a></code> would be used for continuous data. I’ve used the default “viridis” (or “D”) option (do <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">?scale_fill_viridis_d</a></code> for all the options). I also removed the “antibody” name and moved the legend.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"MEDIA"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TNFa_APC_Lin</span>, fill <span class="op">=</span> <span class="va">antibody</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>              color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>name <span class="op">=</span> <span class="cn">NULL</span>, end <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Logicle transformed APC TNF-α signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="workshop_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p>🎬 Can you workout how to annotate this plot?</p>
</section></section><section id="a-figure-to-report-baselines-for-both-signals" class="level2"><h2 class="anchored" data-anchor-id="a-figure-to-report-baselines-for-both-signals">A figure to report baselines for both signals</h2>
<p>We created the figure below in <a href="../week-2/workshop.html#a-figure-to-report-baselines-for-both-signals">Week 2</a></p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">clean_trans_live</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">E_coli_FITC_Lin</span>, </span>
<span>                                  y <span class="op">=</span> <span class="va">TNFa_APC_Lin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">geom_hex</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">128</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">apc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">fitc_cut</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">antibody</span> <span class="op">~</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="workshop_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p>We might want to annotate this figure with the percentage of cells in each quadrant in each sample. To do that, we need to Calculate % of cells in each quadrant.</p>
<section id="calculate-of-cells-in-each-quadrant" class="level3"><h3 class="anchored" data-anchor-id="calculate-of-cells-in-each-quadrant">Calculate % of cells in each quadrant</h3>
<p>We want to calculate the the percentage of cells in each quadrant of the quadrant gated plot of TNFa_APC_Lin signal against the E_coli_FITC_Lin signal. The means finding the number of cells labelled as:</p>
<ul>
<li>TNF-α -’ve and FITC -’ve</li>
<li>TNF-α -’ve and FITC +’ve</li>
<li>TNF-α +’ve and FITC -’ve</li>
<li>TNF-α +’ve and FITC +’ve</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><a href="workshop_files/figure-html/unnamed-chunk-19-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="workshop_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="4200"></a></p>
</figure>
</div>
</div>
</div>
<p>🎬 Calculate the number of cells in each quadrant for each sample:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## calculate the number of cells in each quadrant</span></span>
<span><span class="va">all_combin_n</span> <span class="op">&lt;-</span> <span class="va">clean_trans_live</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">antibody</span>, <span class="va">treatment</span>, <span class="va">tnfa</span>, <span class="va">fitc</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n_quad <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Grouping by <code>antibody</code> and <code>treatment</code> ensures we get values for each sample. The <code>tnfa</code> and <code>fitc</code> columns give whether a cell is positive or negative for that signal.</p>
<p>🎬 Click on the data frame in the environment window to view it and make sure you have an understanding of the data.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>all_combin_n: number of cells in each quadrant for each sample</caption>
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">antibody</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">treatment</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">fitc</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n_quad</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">17809</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">30624</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">221</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">23811</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">17838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">63</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">20003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">8018</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">30441</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">55</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">17743</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">12943</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>As there are four quadrants and six samples, you would expect 24 rows in the data frame. However, there are only 23 rows. This is because for one sample, TNFAPC-LPS. there are no cells in one quadrant, TNF-α -’ve FITC +’ve (the bottom right quadrant). Since we are probably happy not to annotate a figure with 0 %, this is fine.</p>
<p>To calculate the percentage of cells in each quadrant, we need to join this dataframe with the number of non-debris cells for each sample, <em>i.e.,</em> <code>clean_trans_live_n</code></p>
<p>🎬 Calculate the percentage of cells in each quadrant for each sample:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_combin_perc</span> <span class="op">&lt;-</span> <span class="va">all_combin_n</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">clean_trans_live_n</span>, </span>
<span>            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"antibody"</span>, <span class="st">"treatment"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>perc_quad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n_quad</span> <span class="op">/</span> <span class="va">n_live</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">perc_quad</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I have additionally filtered out rows where the % cells rounds to 0. This is again because we are probably happy not to annotate a figure with 0 %.</p>
<p>🎬 Click on the data frame in the environment window to view it and make sure you have an understanding of the data.</p>
<div class="cell">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; ">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">antibody</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">treatment</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">fitc</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n_quad</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n_live</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">perc_live</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">mean_apc</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">n_pos_tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">perc_pos_tnfa</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">perc_quad</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">20154</td>
<td style="text-align: right;">17856</td>
<td style="text-align: right;">88.6</td>
<td style="text-align: right;">3.950328</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">20154</td>
<td style="text-align: right;">17856</td>
<td style="text-align: right;">88.6</td>
<td style="text-align: right;">3.950328</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">17809</td>
<td style="text-align: right;">20154</td>
<td style="text-align: right;">17856</td>
<td style="text-align: right;">88.6</td>
<td style="text-align: right;">3.950328</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">99.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">31789</td>
<td style="text-align: right;">30675</td>
<td style="text-align: right;">96.5</td>
<td style="text-align: right;">3.968852</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">30624</td>
<td style="text-align: right;">31789</td>
<td style="text-align: right;">30675</td>
<td style="text-align: right;">96.5</td>
<td style="text-align: right;">3.968852</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">99.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">221</td>
<td style="text-align: right;">44095</td>
<td style="text-align: right;">41927</td>
<td style="text-align: right;">95.1</td>
<td style="text-align: right;">3.867921</td>
<td style="text-align: right;">278</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">44095</td>
<td style="text-align: right;">41927</td>
<td style="text-align: right;">95.1</td>
<td style="text-align: right;">3.867921</td>
<td style="text-align: right;">278</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">23811</td>
<td style="text-align: right;">44095</td>
<td style="text-align: right;">41927</td>
<td style="text-align: right;">95.1</td>
<td style="text-align: right;">3.867921</td>
<td style="text-align: right;">278</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">56.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ISOTYPE</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">17838</td>
<td style="text-align: right;">44095</td>
<td style="text-align: right;">41927</td>
<td style="text-align: right;">95.1</td>
<td style="text-align: right;">3.867921</td>
<td style="text-align: right;">278</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">42.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">31089</td>
<td style="text-align: right;">28085</td>
<td style="text-align: right;">90.3</td>
<td style="text-align: right;">4.121845</td>
<td style="text-align: right;">20066</td>
<td style="text-align: right;">71.4</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">20003</td>
<td style="text-align: right;">31089</td>
<td style="text-align: right;">28085</td>
<td style="text-align: right;">90.3</td>
<td style="text-align: right;">4.121845</td>
<td style="text-align: right;">20066</td>
<td style="text-align: right;">71.4</td>
<td style="text-align: right;">71.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">MEDIA</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">8018</td>
<td style="text-align: right;">31089</td>
<td style="text-align: right;">28085</td>
<td style="text-align: right;">90.3</td>
<td style="text-align: right;">4.121845</td>
<td style="text-align: right;">20066</td>
<td style="text-align: right;">71.4</td>
<td style="text-align: right;">28.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">31945</td>
<td style="text-align: right;">30536</td>
<td style="text-align: right;">95.6</td>
<td style="text-align: right;">5.075325</td>
<td style="text-align: right;">30481</td>
<td style="text-align: right;">99.8</td>
<td style="text-align: right;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">30441</td>
<td style="text-align: right;">31945</td>
<td style="text-align: right;">30536</td>
<td style="text-align: right;">95.6</td>
<td style="text-align: right;">5.075325</td>
<td style="text-align: right;">30481</td>
<td style="text-align: right;">99.8</td>
<td style="text-align: right;">99.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">LPS</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">31945</td>
<td style="text-align: right;">30536</td>
<td style="text-align: right;">95.6</td>
<td style="text-align: right;">5.075325</td>
<td style="text-align: right;">30481</td>
<td style="text-align: right;">99.8</td>
<td style="text-align: right;">0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">17743</td>
<td style="text-align: right;">32591</td>
<td style="text-align: right;">30715</td>
<td style="text-align: right;">94.2</td>
<td style="text-align: right;">5.201248</td>
<td style="text-align: right;">30686</td>
<td style="text-align: right;">99.9</td>
<td style="text-align: right;">57.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α +'ve</td>
<td style="text-align: left;">FITC -'ve</td>
<td style="text-align: right;">12943</td>
<td style="text-align: right;">32591</td>
<td style="text-align: right;">30715</td>
<td style="text-align: right;">94.2</td>
<td style="text-align: right;">5.201248</td>
<td style="text-align: right;">30686</td>
<td style="text-align: right;">99.9</td>
<td style="text-align: right;">42.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">TNFAPC</td>
<td style="text-align: left;">ECOLIGreen</td>
<td style="text-align: left;">TNF-α -'ve</td>
<td style="text-align: left;">FITC +'ve</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">32591</td>
<td style="text-align: right;">30715</td>
<td style="text-align: right;">94.2</td>
<td style="text-align: right;">5.201248</td>
<td style="text-align: right;">30686</td>
<td style="text-align: right;">99.9</td>
<td style="text-align: right;">0.1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip for your own plots
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can combine the concept of annotation and faceted plots to annotate a quadrant gated plot of TNFa_APC_Lin signal against the E_coli_FITC_Lin signal.</p>
<p>Because the annotation for each quadrant is in a different place, you will need to use four <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> one for each quadrant and you will need to filter appropriately.</p>
<p>Remember you also have the option to annotate manually.</p>
</div>
</div>
</section></section><section id="importing-class-data" class="level2"><h2 class="anchored" data-anchor-id="importing-class-data">Importing class data</h2>
<p>The <a href="https://docs.google.com/spreadsheets/d/1wgQ9goCvYnO44sSHVvP37nFJM12mG8nibdpOOx7ZP9Q/edit?usp=drive_link">BIO00066I Biomedical Sciences class data</a> are in a google sheet.</p>
<p>You have a couple of options for importing this:</p>
<ul>
<li><p>download the file as an excel file or .csv and import that</p></li>
<li><p>import the data directly from the google sheet into R. An advantage of using the google sheet is you won’t have to remember to download the data when someone updates it.</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Google sheet closure
</div>
</div>
<div class="callout-body-container callout-body">
<p>The spreadsheet will be closed for input on <strong>Friday 21 March (week 6)</strong> so people can make conclusions about the class data without being concerned it will change.</p>
</div>
</div>
<section id="importing-from-a-googlesheet" class="level3"><h3 class="anchored" data-anchor-id="importing-from-a-googlesheet">Importing from a googlesheet</h3>
<p>You can use the <strong><code>googlesheets4</code></strong> package <span class="citation" data-cites="googlesheets4">(<a href="#ref-googlesheets4" role="doc-biblioref">Bryan 2023</a>)</span> to do this.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://googlesheets4.tidyverse.org">googlesheets4</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="st">"https://docs.google.com/spreadsheets/d/1wgQ9goCvYnO44sSHVvP37nFJM12mG8nibdpOOx7ZP9Q/edit?gid=0#gid=0"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">class_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://googlesheets4.tidyverse.org/reference/range_read.html">read_sheet</a></span><span class="op">(</span><span class="va">file</span>, sheet <span class="op">=</span> <span class="st">"data"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You will be asked to authenticate in your browser. This message will appear in the console and the browser should open</p>
<pre><code>Waiting for authentication in browser...
Press Esc/Ctrl + C to abort</code></pre>
<p>You can Allow “Tidyverse API Packages wants to access your Google Account”.</p>
<p>The data should then read in.</p>
<pre><code>Authentication complete.
✔ Reading from BIO00066I Biomedical Sciences class data.
✔ Range ''data''.</code></pre>
<p>Note that you will probably want to do some quality control such has filtering out rows with missing data in important columns. We did this in the <a href="../week-1/workshop.html#quality-control">Data Analysis 1: Core</a> workshop.</p>
</section></section><section id="analysis-of-the-class-data" class="level2"><h2 class="anchored" data-anchor-id="analysis-of-the-class-data">Analysis of the class data</h2>
<p>The class data has the summary statistics. You do not need to apply flowcytometry methods to these that. You should be able to apply techniques you have learned in stage 1 to the class data.</p>
<p>Stage 1</p>
<ul>
<li><p><a href="../../r4babs1/r4babs1.html">Data Analysis in R for Becoming a Bioscientist 1</a> <span class="citation" data-cites="rand2023">(<a href="#ref-rand2023" role="doc-biblioref">Rand 2023a</a>)</span>. Core concepts about scientific computing, types of variable, the role of variables in analysis and how to use RStudio to organise analysis and import, summarise and plot data.</p></li>
<li><p><a href="../../r4babs2/r4babs2.html">Data Analysis in R for Becoming a Bioscientist 2</a> <span class="citation" data-cites="rand2023">(<a href="#ref-rand2023" role="doc-biblioref">Rand 2023a</a>)</span>. The logic of hypothesis testing, confidence intervals, what is meant by a statistical model, two-sample tests and one- and two-way analysis of variance (ANOVA).</p></li>
<li><p>Supporting book <a href="https://3mmarand.github.io/comp4biosci/">Computational Analysis for Bioscientists</a> <span class="citation" data-cites="Rand_Comp_Analysis">(<a href="#ref-Rand_Comp_Analysis" role="doc-biblioref">Rand 2023b</a>)</span></p></li>
</ul></section></section><section id="independent-study-following-the-workshop" class="level1"><h1>Independent study following the workshop</h1>
<p><a href="../../r4babs4/week-6/study_after_workshop.html">Consolidate</a></p>
</section><section id="the-code-file" class="level1"><h1>The Code file</h1>
<p>This contains all the code needed in the workshop even where it is not visible on the webpage.</p>
<p>The <code>workshop.qmd</code> file is the file I use to compile the practical. Qmd stands for Quarto markdown. It allows code and ordinary text to be interweaved to produce well-formatted reports including webpages. <a href="https://github.com/3mmaRand/R4BABS/blob/main/r4babs4/week-6/workshop.qmd">View the Qmd in Browser</a>. Coding and thinking answers are marked with <code>#---CODING ANSWER---</code> and <code>#---THINKING ANSWER---</code></p>
<p>Pages made with R <span class="citation" data-cites="R-core">(<a href="#ref-R-core" role="doc-biblioref">R Core Team 2024</a>)</span>, Quarto <span class="citation" data-cites="allaire2022">(<a href="#ref-allaire2022" role="doc-biblioref">Allaire et al. 2022</a>)</span>, <code>knitr</code> <span class="citation" data-cites="knitr1 knitr2 knitr3">(<a href="#ref-knitr1" role="doc-biblioref">Xie 2024</a>, <a href="#ref-knitr2" role="doc-biblioref">2015</a>, <a href="#ref-knitr3" role="doc-biblioref">2014</a>)</span>, <code>kableExtra</code> <span class="citation" data-cites="kableExtra">(<a href="#ref-kableExtra" role="doc-biblioref">Zhu 2024</a>)</span></p>
</section><section id="references" class="level1">


<!-- -->


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-allaire2022" class="csl-entry" role="listitem">
Allaire, J. J., Charles Teague, Carlos Scheidegger, Yihui Xie, and Christophe Dervieux. 2022. <em>Quarto</em>. <a href="https://doi.org/10.5281/zenodo.5960048">https://doi.org/10.5281/zenodo.5960048</a>.
</div>
<div id="ref-googlesheets4" class="csl-entry" role="listitem">
Bryan, Jennifer. 2023. <span>“Googlesheets4: Access Google Sheets Using the Sheets API V4.”</span> <a href="https://CRAN.R-project.org/package=googlesheets4">https://CRAN.R-project.org/package=googlesheets4</a>.
</div>
<div id="ref-R-core" class="csl-entry" role="listitem">
R Core Team. 2024. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-rand2023" class="csl-entry" role="listitem">
Rand, Emma. 2023a. <em>Data Analysis in r for Becoming a Bioscientist</em>. <a href="https://3mmarand.github.io/R4BABS/">https://3mmarand.github.io/R4BABS/</a>.
</div>
<div id="ref-Rand_Comp_Analysis" class="csl-entry" role="listitem">
———. 2023b. <em><span class="nocase">Computational Analysis for Bioscientists</span></em> (version 0.1). <a href="https://3mmarand.github.io/comp4biosci/">https://3mmarand.github.io/comp4biosci/</a>.
</div>
<div id="ref-knitr3" class="csl-entry" role="listitem">
Xie, Yihui. 2014. <span>“Knitr: A Comprehensive Tool for Reproducible Research in <span>R</span>.”</span> In <em>Implementing Reproducible Computational Research</em>, edited by Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman; Hall/CRC.
</div>
<div id="ref-knitr2" class="csl-entry" role="listitem">
———. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-knitr1" class="csl-entry" role="listitem">
———. 2024. <em>Knitr: A General-Purpose Package for Dynamic Report Generation in r</em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-kableExtra" class="csl-entry" role="listitem">
Zhu, Hao. 2024. <em>kableExtra: Construct Complex Table with ’Kable’ and Pipe Syntax</em>. <a href="https://CRAN.R-project.org/package=kableExtra">https://CRAN.R-project.org/package=kableExtra</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>You might want to look back at <a href="../week-2/workshop.html#quality-control-3-gating-to-determine-a-real-signal">Quality control 3: Gating to determine a ‘real’ signal</a> in the week 2 workshop to remind yourself how we determined the gate values for the sample data.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>You can use a histogram if you prefer. You will need different limits on the <em>y</em> axis.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("^(?:http:|https:)\/\/3mmarand\.github\.io\/R4BABS");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb22" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Workshop"</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Data Analysis 4: Biomedical sciences - Your data presentation"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="an">toc-location:</span><span class="co"> right</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: sentence</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>In this workshop you will learn how to:</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>create density plots to visualise the distribution and gating of </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    the signals</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>create a quadrant gated plot of TNFa_APC_Lin signal against the </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    E_coli_FITC_Lin signal.</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>calculate the the percentage of cells in each quadrant</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>annotate plots</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>import from a googlesheet.</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>You will learn how to make a variety of plots but not *which* plots you </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>should include in your report.</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>You should select plots to match your narrative and you may need to </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>apply your understanding of picking data for, faceting and annotating </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>plots to get the plot you want.</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>You should have the processed data files listed below for your own </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>data/the model data.</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>However, if you do not, you can use the linked files prepared from </span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>the sample data</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`clean_trans_live_tfna_pos.csv`</span><span class="co">](data-processed/clean_trans_live_tfna_pos.csv)</span>: </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    Each row is a sample (a treatment-antibody combination). For each </span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    sample there is: the number of cells after AI cleaning, the </span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    number of live cells after gatting, the percentage of live </span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    cells, the number TNF-α postive cells, the percentage of </span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    TNF-α postive cells and the of the mean APC signal in the live </span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>    cells and TNF-α postive cells</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`live_labelled.csv`</span><span class="co">](data-processed/live_labelled.csv)</span>: Each row </span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>    is a cell. These are the AI cleaned, live cells with </span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>    logicle-transformed TNFa_APC_Lin and E_coli_FITC_Lin signals. Each </span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    cell is labelled with the sample (filename) it came from, its </span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    treatment and antibody, and whether it is TNF-α positive (*i.e.* </span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>    has a TNFa_APC_Lin level above the APC cut off used) or negative </span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>    and whether it is FITC positive (*i.e.* E_coli_FITC_Lin level above </span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    the FITC cut off used) or negative.</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>you may also have the FITC equivalent of </span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>    <span class="in">`clean_trans_live_tfna_pos.csv`</span></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a><span class="fu"># Exercises</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Set up</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>🎬 Open the RStudio project you created in the <span class="co">[</span><span class="ot">Data Analysis 2: Biomedical sciences - Sample data analysis</span><span class="co">](../week-2/workshop.html)</span> workshop.</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>🎬 Create a new script called <span class="in">`data-presentation.R`</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>🎬 Load the **`tidyverse`**:</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>🎬 Import the labelled live cell data and the sample summary data</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a><span class="co"># import AI cleaned, logical transformed, live, labelled cell data</span></span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data-processed/live_labelled.csv"</span>)</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a><span class="co"># import % live summary</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>clean_trans_live_n <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data-processed/clean_trans_live_tfna_pos.csv"</span>) </span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>It can helpful to select only the columns we need, especially for the </span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a><span class="in">`clean_trans_live`</span> data. These are: <span class="in">`FS_Lin`</span>, <span class="in">`SS_Lin`</span>, </span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a><span class="in">`E_coli_FITC_Lin`</span>, <span class="in">`TNFa_APC_Lin`</span>, <span class="in">`treatment`</span>, <span class="in">`antibody`</span>, </span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a><span class="in">`tnfa`</span> and <span class="in">`fitc`</span></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>🎬 Select columns of interest:</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="ot">&lt;-</span> clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(FS_Lin, SS_Lin, </span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>         E_coli_FITC_Lin, </span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>         TNFa_APC_Lin, </span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>         treatment, </span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>         antibody, </span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>         tnfa, </span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a>         fitc)</span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>🎬 View each of the resulting dataframes (click on the name in the </span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a>environment or use <span class="in">`View()`</span>) to ensure you understand what they contain.</span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"clean_trans_live: The AI cleaned, logical transformed, live, labelled cell data (first 100 rows only"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">|&gt;</span> </span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"200px"</span>)</span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a>clean_trans_live_n <span class="sc">|&gt;</span> </span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"clean_trans_live_n: sample summaries"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() </span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a>By default, categorical variables are plotted in alphabetical order.</span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a>The alphabetical order of the antibody type - ISOTYPE, TNFAPC - makes </span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a>sense since ISOTYPE is the control.</span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a>However, that of treatment - ECOLIGreen, LPS, MEDIA - is not.</span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a>We will put these in a better order with MEDIA first for the live </span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a>cell data.</span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a>🎬 Use <span class="in">`fct_relevel()`</span> to put treatment groups in order so that our </span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a>graphs are better to interpret.</span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="ot">&lt;-</span> clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">fct_relevel</span>(treatment, <span class="fu">c</span>(<span class="st">"MEDIA"</span>,</span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"LPS"</span>,</span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"ECOLIGreen"</span>)))</span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribution of APC TNF-α signal with APC gate</span></span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a>We often want to show the distribution of a signal with the value we </span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a>used as a threshold (gate) so that readers can evaluate whether the </span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a>value chosen is appropriate in their opinion.</span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a>A distribution is best shown with a histogram or density plot.</span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a>We will annotate the distribution of APC TNF-α signal with the gate </span>
<span id="cb22-152"><a href="#cb22-152" aria-hidden="true" tabindex="-1"></a>used to define whether the cells are positive or negative for TNF-α.</span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a>it is useful to assign that value to a variable that we can use in our </span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a>plots<span class="ot">[^1]</span>.</span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-156"><a href="#cb22-156" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>You might want to look back at <span class="co">[</span><span class="ot">Quality control 3: Gating to determine a ‘real’ signal</span><span class="co">](../week-2/workshop.html#quality-control-3-gating-to-determine-a-real-signal)</span> in the week 2 workshop to remind yourself how we determined the gate values for the sample data.</span>
<span id="cb22-157"><a href="#cb22-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-158"><a href="#cb22-158" aria-hidden="true" tabindex="-1"></a>🎬 Assign the TNF-α gate value a variable remembering that your number </span>
<span id="cb22-159"><a href="#cb22-159" aria-hidden="true" tabindex="-1"></a>will differ:</span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a>apc_cut <span class="ot">&lt;-</span> <span class="fl">3.8</span></span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a>🎬 Also assign the FITC gate value a variable <span class="in">`fitc_cut`</span>:</span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-175"><a href="#cb22-175" aria-hidden="true" tabindex="-1"></a><span class="co">#---CODING ANSWER--- </span></span>
<span id="cb22-176"><a href="#cb22-176" aria-hidden="true" tabindex="-1"></a><span class="co"># your value will likely differ</span></span>
<span id="cb22-177"><a href="#cb22-177" aria-hidden="true" tabindex="-1"></a>fitc_cut <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-179"><a href="#cb22-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-180"><a href="#cb22-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-181"><a href="#cb22-181" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting one sample</span></span>
<span id="cb22-182"><a href="#cb22-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-183"><a href="#cb22-183" aria-hidden="true" tabindex="-1"></a>Since the control sample (MEDIA, ISOTYPE) is crucial in determining the </span>
<span id="cb22-184"><a href="#cb22-184" aria-hidden="true" tabindex="-1"></a>APC gating threshold, this is a useful plot.</span>
<span id="cb22-185"><a href="#cb22-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-186"><a href="#cb22-186" aria-hidden="true" tabindex="-1"></a>We first filter the dataframe before plotting it which allows us to </span>
<span id="cb22-187"><a href="#cb22-187" aria-hidden="true" tabindex="-1"></a>pick the sample we want to plot.</span>
<span id="cb22-188"><a href="#cb22-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-189"><a href="#cb22-189" aria-hidden="true" tabindex="-1"></a>🎬 Plot the distribution of the APC TNF-α signal for the MEDIA </span>
<span id="cb22-190"><a href="#cb22-190" aria-hidden="true" tabindex="-1"></a><span class="in">`treatment`</span> and the ISOTYPE <span class="in">`antibody`</span>:</span>
<span id="cb22-191"><a href="#cb22-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-194"><a href="#cb22-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-195"><a href="#cb22-195" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-196"><a href="#cb22-196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>,</span>
<span id="cb22-197"><a href="#cb22-197" aria-hidden="true" tabindex="-1"></a>           antibody <span class="sc">==</span> <span class="st">"ISOTYPE"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-198"><a href="#cb22-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TNFa_APC_Lin)) <span class="sc">+</span></span>
<span id="cb22-199"><a href="#cb22-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb22-200"><a href="#cb22-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> apc_cut, </span>
<span id="cb22-201"><a href="#cb22-201" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-202"><a href="#cb22-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb22-203"><a href="#cb22-203" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>),</span>
<span id="cb22-204"><a href="#cb22-204" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb22-205"><a href="#cb22-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Logicle transformed APC TNF-α signal"</span>) <span class="sc">+</span></span>
<span id="cb22-206"><a href="#cb22-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-207"><a href="#cb22-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-208"><a href="#cb22-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-209"><a href="#cb22-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-210"><a href="#cb22-210" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_vline()`</span> adds a vertical line to the plot at the value of </span>
<span id="cb22-211"><a href="#cb22-211" aria-hidden="true" tabindex="-1"></a>    <span class="in">`apc_cut`</span> which is the gate value we determined for the APC TNF-α </span>
<span id="cb22-212"><a href="#cb22-212" aria-hidden="true" tabindex="-1"></a>    signal.</span>
<span id="cb22-213"><a href="#cb22-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-214"><a href="#cb22-214" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_density()`</span> is a smoothed version of a histogram<span class="ot">[^2]</span> and </span>
<span id="cb22-215"><a href="#cb22-215" aria-hidden="true" tabindex="-1"></a>     shows the distribution of the data. The fill argument sets the </span>
<span id="cb22-216"><a href="#cb22-216" aria-hidden="true" tabindex="-1"></a>     colour of the plot to a light grey.</span>
<span id="cb22-217"><a href="#cb22-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-218"><a href="#cb22-218" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the expand argument in a <span class="in">`scale_x_....`</span> or <span class="in">`scale_y_....`</span> sets </span>
<span id="cb22-219"><a href="#cb22-219" aria-hidden="true" tabindex="-1"></a>    the axis line at zero rather than being below it.</span>
<span id="cb22-220"><a href="#cb22-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-221"><a href="#cb22-221" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span>You can use a histogram if you prefer.</span>
<span id="cb22-222"><a href="#cb22-222" aria-hidden="true" tabindex="-1"></a>    You will need different limits on the *y* axis.</span>
<span id="cb22-223"><a href="#cb22-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-224"><a href="#cb22-224" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot annotation</span></span>
<span id="cb22-225"><a href="#cb22-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-226"><a href="#cb22-226" aria-hidden="true" tabindex="-1"></a>You have (at least) three options for adding the summary statistics </span>
<span id="cb22-227"><a href="#cb22-227" aria-hidden="true" tabindex="-1"></a>to the plot.</span>
<span id="cb22-228"><a href="#cb22-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-229"><a href="#cb22-229" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Most simple: adding in word/googledocs (or whatever you write your</span>
<span id="cb22-230"><a href="#cb22-230" aria-hidden="true" tabindex="-1"></a>    report in).</span>
<span id="cb22-231"><a href="#cb22-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-232"><a href="#cb22-232" aria-hidden="true" tabindex="-1"></a>    Save the plot using <span class="in">`ggsave()`</span>, insert as an image into your report </span>
<span id="cb22-233"><a href="#cb22-233" aria-hidden="true" tabindex="-1"></a>    and a text box.</span>
<span id="cb22-234"><a href="#cb22-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-235"><a href="#cb22-235" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>In R by hard coding the values in the <span class="in">`annotate()`</span> function.</span>
<span id="cb22-236"><a href="#cb22-236" aria-hidden="true" tabindex="-1"></a>    The values themselves you have calculated and are in the </span>
<span id="cb22-237"><a href="#cb22-237" aria-hidden="true" tabindex="-1"></a>    <span class="in">`clean_trans_live_n`</span> dataframe</span>
<span id="cb22-238"><a href="#cb22-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-241"><a href="#cb22-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-242"><a href="#cb22-242" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-243"><a href="#cb22-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>,</span>
<span id="cb22-244"><a href="#cb22-244" aria-hidden="true" tabindex="-1"></a>         antibody <span class="sc">==</span> <span class="st">"ISOTYPE"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-245"><a href="#cb22-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TNFa_APC_Lin)) <span class="sc">+</span></span>
<span id="cb22-246"><a href="#cb22-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb22-247"><a href="#cb22-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> apc_cut, </span>
<span id="cb22-248"><a href="#cb22-248" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-249"><a href="#cb22-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb22-250"><a href="#cb22-250" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"0.2 % cells</span><span class="sc">\n</span><span class="st">TNF-α +'ve</span><span class="sc">\n</span><span class="st">MFI = 3.95"</span>,</span>
<span id="cb22-251"><a href="#cb22-251" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">4.1</span>,</span>
<span id="cb22-252"><a href="#cb22-252" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">2</span>,</span>
<span id="cb22-253"><a href="#cb22-253" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-254"><a href="#cb22-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb22-255"><a href="#cb22-255" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>),</span>
<span id="cb22-256"><a href="#cb22-256" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb22-257"><a href="#cb22-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Logicle transformed APC TNF-α signal"</span>) <span class="sc">+</span></span>
<span id="cb22-258"><a href="#cb22-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-259"><a href="#cb22-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-260"><a href="#cb22-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-261"><a href="#cb22-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-262"><a href="#cb22-262" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>In R and fully reproducibly by using the <span class="in">`clean_trans_live_n`</span> </span>
<span id="cb22-263"><a href="#cb22-263" aria-hidden="true" tabindex="-1"></a>    dataframe with the summary statistics in <span class="in">`geom_text()`</span>. That </span>
<span id="cb22-264"><a href="#cb22-264" aria-hidden="true" tabindex="-1"></a>    dataframe also needs filtering to the sample you are plotting. I </span>
<span id="cb22-265"><a href="#cb22-265" aria-hidden="true" tabindex="-1"></a>    have also rounded the <span class="in">`mean_apc`</span> value to 2 decimal places.</span>
<span id="cb22-266"><a href="#cb22-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-269"><a href="#cb22-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-270"><a href="#cb22-270" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-271"><a href="#cb22-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>,</span>
<span id="cb22-272"><a href="#cb22-272" aria-hidden="true" tabindex="-1"></a>         antibody <span class="sc">==</span> <span class="st">"ISOTYPE"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-273"><a href="#cb22-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TNFa_APC_Lin)) <span class="sc">+</span></span>
<span id="cb22-274"><a href="#cb22-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb22-275"><a href="#cb22-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> apc_cut, </span>
<span id="cb22-276"><a href="#cb22-276" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-277"><a href="#cb22-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> clean_trans_live_n <span class="sc">|&gt;</span> </span>
<span id="cb22-278"><a href="#cb22-278" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>,</span>
<span id="cb22-279"><a href="#cb22-279" aria-hidden="true" tabindex="-1"></a>                     antibody <span class="sc">==</span> <span class="st">"ISOTYPE"</span>), </span>
<span id="cb22-280"><a href="#cb22-280" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(perc_pos_tnfa, </span>
<span id="cb22-281"><a href="#cb22-281" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"% cells</span><span class="sc">\n</span><span class="st">TNF-α +'ve</span><span class="sc">\n</span><span class="st">Mean = "</span>,</span>
<span id="cb22-282"><a href="#cb22-282" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">round</span>(mean_apc, <span class="dv">2</span>))), </span>
<span id="cb22-283"><a href="#cb22-283" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">4.1</span>,</span>
<span id="cb22-284"><a href="#cb22-284" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">2</span>,</span>
<span id="cb22-285"><a href="#cb22-285" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-286"><a href="#cb22-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb22-287"><a href="#cb22-287" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>),</span>
<span id="cb22-288"><a href="#cb22-288" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb22-289"><a href="#cb22-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Logicle transformed APC TNF-α signal"</span>) <span class="sc">+</span></span>
<span id="cb22-290"><a href="#cb22-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-291"><a href="#cb22-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-292"><a href="#cb22-292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-293"><a href="#cb22-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-294"><a href="#cb22-294" aria-hidden="true" tabindex="-1"></a>This has several advantages:</span>
<span id="cb22-295"><a href="#cb22-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-296"><a href="#cb22-296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>if the data changes, the plot annotation will update automatically </span>
<span id="cb22-297"><a href="#cb22-297" aria-hidden="true" tabindex="-1"></a>    just as the distribution will.</span>
<span id="cb22-298"><a href="#cb22-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-299"><a href="#cb22-299" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>extending to multiple facets requires little extra work.</span>
<span id="cb22-300"><a href="#cb22-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-301"><a href="#cb22-301" aria-hidden="true" tabindex="-1"></a><span class="fu">### Write to file</span></span>
<span id="cb22-302"><a href="#cb22-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-303"><a href="#cb22-303" aria-hidden="true" tabindex="-1"></a>Whatever method you decide to use for annotation, you will need to </span>
<span id="cb22-304"><a href="#cb22-304" aria-hidden="true" tabindex="-1"></a>save your figure as an image.</span>
<span id="cb22-305"><a href="#cb22-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-306"><a href="#cb22-306" aria-hidden="true" tabindex="-1"></a>🎬 Assign the plot to <span class="in">`apc_distibution_media_isotype`</span></span>
<span id="cb22-307"><a href="#cb22-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-310"><a href="#cb22-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-311"><a href="#cb22-311" aria-hidden="true" tabindex="-1"></a>apc_distibution_media_isotype <span class="ot">&lt;-</span> clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-312"><a href="#cb22-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>,</span>
<span id="cb22-313"><a href="#cb22-313" aria-hidden="true" tabindex="-1"></a>         antibody <span class="sc">==</span> <span class="st">"ISOTYPE"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-314"><a href="#cb22-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TNFa_APC_Lin)) <span class="sc">+</span></span>
<span id="cb22-315"><a href="#cb22-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb22-316"><a href="#cb22-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> apc_cut, </span>
<span id="cb22-317"><a href="#cb22-317" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-318"><a href="#cb22-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> clean_trans_live_n <span class="sc">|&gt;</span> </span>
<span id="cb22-319"><a href="#cb22-319" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>,</span>
<span id="cb22-320"><a href="#cb22-320" aria-hidden="true" tabindex="-1"></a>                     antibody <span class="sc">==</span> <span class="st">"ISOTYPE"</span>), </span>
<span id="cb22-321"><a href="#cb22-321" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(perc_pos_tnfa, </span>
<span id="cb22-322"><a href="#cb22-322" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"% cells</span><span class="sc">\n</span><span class="st">TNF-α +'ve</span><span class="sc">\n</span><span class="st">Mean = "</span>,</span>
<span id="cb22-323"><a href="#cb22-323" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">round</span>(mean_apc, <span class="dv">2</span>))), </span>
<span id="cb22-324"><a href="#cb22-324" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fl">4.1</span>,</span>
<span id="cb22-325"><a href="#cb22-325" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">2</span>,</span>
<span id="cb22-326"><a href="#cb22-326" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-327"><a href="#cb22-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb22-328"><a href="#cb22-328" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>),</span>
<span id="cb22-329"><a href="#cb22-329" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb22-330"><a href="#cb22-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Logicle transformed APC TNF-α signal"</span>) <span class="sc">+</span></span>
<span id="cb22-331"><a href="#cb22-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-332"><a href="#cb22-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-333"><a href="#cb22-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-334"><a href="#cb22-334" aria-hidden="true" tabindex="-1"></a>🎬 Save the plot to a file:</span>
<span id="cb22-335"><a href="#cb22-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-338"><a href="#cb22-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-339"><a href="#cb22-339" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figures/apc_distibution_media_isotype.png"</span>,</span>
<span id="cb22-340"><a href="#cb22-340" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">"png"</span>,</span>
<span id="cb22-341"><a href="#cb22-341" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> apc_distibution_media_isotype,</span>
<span id="cb22-342"><a href="#cb22-342" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">4</span>,</span>
<span id="cb22-343"><a href="#cb22-343" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="fl">2.5</span>,</span>
<span id="cb22-344"><a href="#cb22-344" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb22-345"><a href="#cb22-345" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb22-346"><a href="#cb22-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-347"><a href="#cb22-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-348"><a href="#cb22-348" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multiple facets</span></span>
<span id="cb22-349"><a href="#cb22-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-350"><a href="#cb22-350" aria-hidden="true" tabindex="-1"></a>To plot all the samples in one go we can use <span class="in">`facet_grid()`</span>.</span>
<span id="cb22-351"><a href="#cb22-351" aria-hidden="true" tabindex="-1"></a><span class="in">`treatment ~ antibody`</span> puts the treatments in rows and the antibodies </span>
<span id="cb22-352"><a href="#cb22-352" aria-hidden="true" tabindex="-1"></a>in columns.</span>
<span id="cb22-353"><a href="#cb22-353" aria-hidden="true" tabindex="-1"></a>Now do not need to filter the data to a single sample.</span>
<span id="cb22-354"><a href="#cb22-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-355"><a href="#cb22-355" aria-hidden="true" tabindex="-1"></a>🎬 Plot the distribution of the APC TNF-α signal for all samples:</span>
<span id="cb22-356"><a href="#cb22-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-359"><a href="#cb22-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-360"><a href="#cb22-360" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-361"><a href="#cb22-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TNFa_APC_Lin)) <span class="sc">+</span></span>
<span id="cb22-362"><a href="#cb22-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb22-363"><a href="#cb22-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> apc_cut, </span>
<span id="cb22-364"><a href="#cb22-364" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-365"><a href="#cb22-365" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="at">data =</span> clean_trans_live_n, </span>
<span id="cb22-366"><a href="#cb22-366" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(perc_pos_tnfa, </span>
<span id="cb22-367"><a href="#cb22-367" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"% cells</span><span class="sc">\n</span><span class="st">TNF-α +'ve</span><span class="sc">\n</span><span class="st">MFI = "</span>,</span>
<span id="cb22-368"><a href="#cb22-368" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">round</span>(mean_apc, <span class="dv">2</span>))), </span>
<span id="cb22-369"><a href="#cb22-369" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="dv">6</span>, </span>
<span id="cb22-370"><a href="#cb22-370" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fl">1.7</span>,</span>
<span id="cb22-371"><a href="#cb22-371" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-372"><a href="#cb22-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb22-373"><a href="#cb22-373" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>),</span>
<span id="cb22-374"><a href="#cb22-374" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb22-375"><a href="#cb22-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Logicle transformed APC TNF-α signal"</span>) <span class="sc">+</span></span>
<span id="cb22-376"><a href="#cb22-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(treatment <span class="sc">~</span> antibody) <span class="sc">+</span></span>
<span id="cb22-377"><a href="#cb22-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-378"><a href="#cb22-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-379"><a href="#cb22-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-380"><a href="#cb22-380" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb22-381"><a href="#cb22-381" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods of annotation for faceted plots</span></span>
<span id="cb22-382"><a href="#cb22-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-383"><a href="#cb22-383" aria-hidden="true" tabindex="-1"></a>Note that adding plot annotations manually (method 1) and using R fully </span>
<span id="cb22-384"><a href="#cb22-384" aria-hidden="true" tabindex="-1"></a>reproducibly (method 3) are possible on faceted plots but method 2 is </span>
<span id="cb22-385"><a href="#cb22-385" aria-hidden="true" tabindex="-1"></a>not because you need the annotations to change with values in treatment </span>
<span id="cb22-386"><a href="#cb22-386" aria-hidden="true" tabindex="-1"></a>and antibody.</span>
<span id="cb22-387"><a href="#cb22-387" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-388"><a href="#cb22-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-389"><a href="#cb22-389" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb22-390"><a href="#cb22-390" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tip for your own plots</span></span>
<span id="cb22-391"><a href="#cb22-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-392"><a href="#cb22-392" aria-hidden="true" tabindex="-1"></a>You can combine filtering data and faceted plots to do facet plots of </span>
<span id="cb22-393"><a href="#cb22-393" aria-hidden="true" tabindex="-1"></a>a subset of the samples.</span>
<span id="cb22-394"><a href="#cb22-394" aria-hidden="true" tabindex="-1"></a>For example, you could filter for the ISOTYPE antibody and facet </span>
<span id="cb22-395"><a href="#cb22-395" aria-hidden="true" tabindex="-1"></a>for the treatment.</span>
<span id="cb22-396"><a href="#cb22-396" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-397"><a href="#cb22-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-398"><a href="#cb22-398" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overlay instead of facets</span></span>
<span id="cb22-399"><a href="#cb22-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-400"><a href="#cb22-400" aria-hidden="true" tabindex="-1"></a>Using facets is *one* way to show multiple samples in one plot.</span>
<span id="cb22-401"><a href="#cb22-401" aria-hidden="true" tabindex="-1"></a>Another is to overlay the plots by mapping the <span class="in">`fill`</span> aesthetic to </span>
<span id="cb22-402"><a href="#cb22-402" aria-hidden="true" tabindex="-1"></a>the <span class="in">`antibody`</span> variable.</span>
<span id="cb22-403"><a href="#cb22-403" aria-hidden="true" tabindex="-1"></a>Making the fill semi-transparent with <span class="in">`alpha = 0.3`</span> allows you to </span>
<span id="cb22-404"><a href="#cb22-404" aria-hidden="true" tabindex="-1"></a>see the overlap of the distributions.</span>
<span id="cb22-405"><a href="#cb22-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-406"><a href="#cb22-406" aria-hidden="true" tabindex="-1"></a>🎬 Overlay the distribution of the APC TNF-α signals for the media </span>
<span id="cb22-407"><a href="#cb22-407" aria-hidden="true" tabindex="-1"></a>treated samples:</span>
<span id="cb22-408"><a href="#cb22-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-411"><a href="#cb22-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-412"><a href="#cb22-412" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-413"><a href="#cb22-413" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-414"><a href="#cb22-414" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TNFa_APC_Lin, <span class="at">fill =</span> antibody)) <span class="sc">+</span></span>
<span id="cb22-415"><a href="#cb22-415" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb22-416"><a href="#cb22-416" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> apc_cut, </span>
<span id="cb22-417"><a href="#cb22-417" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-418"><a href="#cb22-418" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb22-419"><a href="#cb22-419" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb22-420"><a href="#cb22-420" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Logicle transformed APC TNF-α signal"</span>) <span class="sc">+</span></span>
<span id="cb22-421"><a href="#cb22-421" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>() </span>
<span id="cb22-422"><a href="#cb22-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-423"><a href="#cb22-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-424"><a href="#cb22-424" aria-hidden="true" tabindex="-1"></a>To use colours other than the default, we need to used a <span class="in">`scale_fill_...`</span> function.</span>
<span id="cb22-425"><a href="#cb22-425" aria-hidden="true" tabindex="-1"></a>These functions can also be used to change the name (<span class="in">`name = ...`</span>) of the legend and the names (<span class="in">`labels = c(...)`</span>) of each group.</span>
<span id="cb22-426"><a href="#cb22-426" aria-hidden="true" tabindex="-1"></a><span class="in">`scale_fill_manual()`</span> allows to specify the colours (<span class="in">`values = c(...)`</span>) manually.</span>
<span id="cb22-427"><a href="#cb22-427" aria-hidden="true" tabindex="-1"></a>So you might add:</span>
<span id="cb22-428"><a href="#cb22-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-429"><a href="#cb22-429" aria-hidden="true" tabindex="-1"></a><span class="in">`scale_fill_manual(values = c("green", "blue"))`</span></span>
<span id="cb22-430"><a href="#cb22-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-431"><a href="#cb22-431" aria-hidden="true" tabindex="-1"></a>I like to use the viridis scales.</span>
<span id="cb22-432"><a href="#cb22-432" aria-hidden="true" tabindex="-1"></a>The viridis scales provide colour maps that are perceptually uniform in both colour and black-and-white.</span>
<span id="cb22-433"><a href="#cb22-433" aria-hidden="true" tabindex="-1"></a>They are also designed to be perceived by viewers with common forms of colour blindness.</span>
<span id="cb22-434"><a href="#cb22-434" aria-hidden="true" tabindex="-1"></a>See <span class="co">[</span><span class="ot">Introduction to viridis</span><span class="co">](https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html#introduction)</span> for more information.</span>
<span id="cb22-435"><a href="#cb22-435" aria-hidden="true" tabindex="-1"></a>We do not have to know the names/codes for the colours because **`ggplot2`** provides these in special <span class="in">`scale_fill_...`</span> functions.</span>
<span id="cb22-436"><a href="#cb22-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-437"><a href="#cb22-437" aria-hidden="true" tabindex="-1"></a>Here I use <span class="in">`scale_fill_viridis_d()`</span>.</span>
<span id="cb22-438"><a href="#cb22-438" aria-hidden="true" tabindex="-1"></a>The d stands for discrete - <span class="in">`antibody`</span>, the variable mapped to <span class="in">`fill`</span>, is discrete.</span>
<span id="cb22-439"><a href="#cb22-439" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`scale_fill_viridis_c()`</span> would be used for continuous data.</span>
<span id="cb22-440"><a href="#cb22-440" aria-hidden="true" tabindex="-1"></a>I've used the default "viridis" (or "D") option (do <span class="in">`?scale_fill_viridis_d`</span> for all the options).</span>
<span id="cb22-441"><a href="#cb22-441" aria-hidden="true" tabindex="-1"></a>I also removed the "antibody" name and moved the legend.</span>
<span id="cb22-442"><a href="#cb22-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-445"><a href="#cb22-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-446"><a href="#cb22-446" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-447"><a href="#cb22-447" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-448"><a href="#cb22-448" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TNFa_APC_Lin, <span class="at">fill =</span> antibody)) <span class="sc">+</span></span>
<span id="cb22-449"><a href="#cb22-449" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb22-450"><a href="#cb22-450" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> apc_cut, </span>
<span id="cb22-451"><a href="#cb22-451" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-452"><a href="#cb22-452" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_fill_viridis_d</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">end =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb22-453"><a href="#cb22-453" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb22-454"><a href="#cb22-454" aria-hidden="true" tabindex="-1"></a>                      <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb22-455"><a href="#cb22-455" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Logicle transformed APC TNF-α signal"</span>) <span class="sc">+</span></span>
<span id="cb22-456"><a href="#cb22-456" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb22-457"><a href="#cb22-457" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-458"><a href="#cb22-458" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.85</span>)) </span>
<span id="cb22-459"><a href="#cb22-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-460"><a href="#cb22-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-461"><a href="#cb22-461" aria-hidden="true" tabindex="-1"></a>🎬 Can you workout how to annotate this plot?</span>
<span id="cb22-462"><a href="#cb22-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-465"><a href="#cb22-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-466"><a href="#cb22-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb22-467"><a href="#cb22-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-468"><a href="#cb22-468" aria-hidden="true" tabindex="-1"></a><span class="co">#---CODING ANSWER--- </span></span>
<span id="cb22-469"><a href="#cb22-469" aria-hidden="true" tabindex="-1"></a>clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-470"><a href="#cb22-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-471"><a href="#cb22-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TNFa_APC_Lin, <span class="at">fill =</span> antibody)) <span class="sc">+</span></span>
<span id="cb22-472"><a href="#cb22-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb22-473"><a href="#cb22-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> apc_cut, </span>
<span id="cb22-474"><a href="#cb22-474" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-475"><a href="#cb22-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb22-476"><a href="#cb22-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> clean_trans_live_n <span class="sc">|&gt;</span> </span>
<span id="cb22-477"><a href="#cb22-477" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>,</span>
<span id="cb22-478"><a href="#cb22-478" aria-hidden="true" tabindex="-1"></a>                     antibody <span class="sc">==</span> <span class="st">"ISOTYPE"</span>), </span>
<span id="cb22-479"><a href="#cb22-479" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(perc_pos_tnfa, </span>
<span id="cb22-480"><a href="#cb22-480" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"% cells, TNF-α +'ve, Mean = "</span>,</span>
<span id="cb22-481"><a href="#cb22-481" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">round</span>(mean_apc, <span class="dv">2</span>))), </span>
<span id="cb22-482"><a href="#cb22-482" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fl">4.8</span>,</span>
<span id="cb22-483"><a href="#cb22-483" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="fl">2.25</span>,</span>
<span id="cb22-484"><a href="#cb22-484" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> viridisLite<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb22-485"><a href="#cb22-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> clean_trans_live_n <span class="sc">|&gt;</span> </span>
<span id="cb22-486"><a href="#cb22-486" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(treatment <span class="sc">==</span> <span class="st">"MEDIA"</span>,</span>
<span id="cb22-487"><a href="#cb22-487" aria-hidden="true" tabindex="-1"></a>                     antibody <span class="sc">==</span> <span class="st">"TNFAPC"</span>), </span>
<span id="cb22-488"><a href="#cb22-488" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(perc_pos_tnfa, </span>
<span id="cb22-489"><a href="#cb22-489" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"% cells, TNF-α +'ve, Mean = "</span>,</span>
<span id="cb22-490"><a href="#cb22-490" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">round</span>(mean_apc, <span class="dv">2</span>))), </span>
<span id="cb22-491"><a href="#cb22-491" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fl">4.8</span>,</span>
<span id="cb22-492"><a href="#cb22-492" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="dv">2</span>,</span>
<span id="cb22-493"><a href="#cb22-493" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> viridisLite<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>])<span class="sc">+</span></span>
<span id="cb22-494"><a href="#cb22-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb22-495"><a href="#cb22-495" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb22-496"><a href="#cb22-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Logicle transformed APC TNF-α signal"</span>) <span class="sc">+</span></span>
<span id="cb22-497"><a href="#cb22-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb22-498"><a href="#cb22-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-499"><a href="#cb22-499" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.85</span>),</span>
<span id="cb22-500"><a href="#cb22-500" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>)) </span>
<span id="cb22-501"><a href="#cb22-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-502"><a href="#cb22-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-503"><a href="#cb22-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-504"><a href="#cb22-504" aria-hidden="true" tabindex="-1"></a><span class="fu">## A figure to report baselines for both signals</span></span>
<span id="cb22-505"><a href="#cb22-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-506"><a href="#cb22-506" aria-hidden="true" tabindex="-1"></a>We created the figure below in <span class="co">[</span><span class="ot">Week 2</span><span class="co">](../week-2/workshop.html#a-figure-to-report-baselines-for-both-signals)</span></span>
<span id="cb22-507"><a href="#cb22-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-510"><a href="#cb22-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-511"><a href="#cb22-511" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clean_trans_live, <span class="fu">aes</span>(<span class="at">x =</span> E_coli_FITC_Lin, </span>
<span id="cb22-512"><a href="#cb22-512" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> TNFa_APC_Lin)) <span class="sc">+</span></span>
<span id="cb22-513"><a href="#cb22-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">128</span>) <span class="sc">+</span></span>
<span id="cb22-514"><a href="#cb22-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> apc_cut, </span>
<span id="cb22-515"><a href="#cb22-515" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-516"><a href="#cb22-516" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> fitc_cut, </span>
<span id="cb22-517"><a href="#cb22-517" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-518"><a href="#cb22-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb22-519"><a href="#cb22-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(antibody <span class="sc">~</span> treatment) <span class="sc">+</span></span>
<span id="cb22-520"><a href="#cb22-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-521"><a href="#cb22-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-522"><a href="#cb22-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-523"><a href="#cb22-523" aria-hidden="true" tabindex="-1"></a>We might want to annotate this figure with the percentage of cells in each quadrant in each sample.</span>
<span id="cb22-524"><a href="#cb22-524" aria-hidden="true" tabindex="-1"></a>To do that, we need to Calculate % of cells in each quadrant.</span>
<span id="cb22-525"><a href="#cb22-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-526"><a href="#cb22-526" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate % of cells in each quadrant</span></span>
<span id="cb22-527"><a href="#cb22-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-528"><a href="#cb22-528" aria-hidden="true" tabindex="-1"></a>We want to calculate the the percentage of cells in each quadrant of the quadrant gated plot of TNFa_APC_Lin signal against the E_coli_FITC_Lin signal.</span>
<span id="cb22-529"><a href="#cb22-529" aria-hidden="true" tabindex="-1"></a>The means finding the number of cells labelled as:</span>
<span id="cb22-530"><a href="#cb22-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-531"><a href="#cb22-531" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TNF-α -'ve and FITC -'ve</span>
<span id="cb22-532"><a href="#cb22-532" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TNF-α -'ve and FITC +'ve</span>
<span id="cb22-533"><a href="#cb22-533" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TNF-α +'ve and FITC -'ve</span>
<span id="cb22-534"><a href="#cb22-534" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TNF-α +'ve and FITC +'ve</span>
<span id="cb22-535"><a href="#cb22-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-538"><a href="#cb22-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-539"><a href="#cb22-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb22-540"><a href="#cb22-540" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(clean_trans_live, <span class="fu">aes</span>(<span class="at">x =</span> E_coli_FITC_Lin, </span>
<span id="cb22-541"><a href="#cb22-541" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> TNFa_APC_Lin)) <span class="sc">+</span></span>
<span id="cb22-542"><a href="#cb22-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> apc_cut, </span>
<span id="cb22-543"><a href="#cb22-543" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-544"><a href="#cb22-544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> fitc_cut, </span>
<span id="cb22-545"><a href="#cb22-545" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-546"><a href="#cb22-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb22-547"><a href="#cb22-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">6.5</span>)) <span class="sc">+</span></span>
<span id="cb22-548"><a href="#cb22-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"TNF-α -'ve </span><span class="sc">\n</span><span class="st"> FITC -'ve"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb22-549"><a href="#cb22-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"TNF-α -'ve </span><span class="sc">\n</span><span class="st"> FITC +'ve"</span>, <span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">y =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb22-550"><a href="#cb22-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"TNF-α +'ve </span><span class="sc">\n</span><span class="st"> FITC -'ve"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb22-551"><a href="#cb22-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">label =</span> <span class="st">"TNF-α +'ve </span><span class="sc">\n</span><span class="st"> FITC +'ve"</span>, <span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">y =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb22-552"><a href="#cb22-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb22-553"><a href="#cb22-553" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-554"><a href="#cb22-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-555"><a href="#cb22-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-556"><a href="#cb22-556" aria-hidden="true" tabindex="-1"></a>🎬 Calculate the number of cells in each quadrant for each sample:</span>
<span id="cb22-557"><a href="#cb22-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-560"><a href="#cb22-560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-561"><a href="#cb22-561" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate the number of cells in each quadrant</span></span>
<span id="cb22-562"><a href="#cb22-562" aria-hidden="true" tabindex="-1"></a>all_combin_n <span class="ot">&lt;-</span> clean_trans_live <span class="sc">|&gt;</span> </span>
<span id="cb22-563"><a href="#cb22-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(antibody, treatment, tnfa, fitc) <span class="sc">|&gt;</span></span>
<span id="cb22-564"><a href="#cb22-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_quad =</span> <span class="fu">n</span>()) </span>
<span id="cb22-565"><a href="#cb22-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-566"><a href="#cb22-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-567"><a href="#cb22-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-568"><a href="#cb22-568" aria-hidden="true" tabindex="-1"></a>Grouping by <span class="in">`antibody`</span> and <span class="in">`treatment`</span> ensures we get values for each </span>
<span id="cb22-569"><a href="#cb22-569" aria-hidden="true" tabindex="-1"></a>sample. The <span class="in">`tnfa`</span> and <span class="in">`fitc`</span> columns give whether a cell is positive </span>
<span id="cb22-570"><a href="#cb22-570" aria-hidden="true" tabindex="-1"></a>or negative for that signal.</span>
<span id="cb22-571"><a href="#cb22-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-572"><a href="#cb22-572" aria-hidden="true" tabindex="-1"></a>🎬 Click on the data frame in the environment window to view it and </span>
<span id="cb22-573"><a href="#cb22-573" aria-hidden="true" tabindex="-1"></a>make sure you have an understanding of the data.</span>
<span id="cb22-574"><a href="#cb22-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-577"><a href="#cb22-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-578"><a href="#cb22-578" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb22-579"><a href="#cb22-579" aria-hidden="true" tabindex="-1"></a>all_combin_n <span class="sc">|&gt;</span> </span>
<span id="cb22-580"><a href="#cb22-580" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"all_combin_n: number of cells in each quadrant for each sample"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-581"><a href="#cb22-581" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">|&gt;</span> </span>
<span id="cb22-582"><a href="#cb22-582" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"200px"</span>)</span>
<span id="cb22-583"><a href="#cb22-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-584"><a href="#cb22-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-585"><a href="#cb22-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-586"><a href="#cb22-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-587"><a href="#cb22-587" aria-hidden="true" tabindex="-1"></a>As there are four quadrants and six samples, you would expect 24 rows </span>
<span id="cb22-588"><a href="#cb22-588" aria-hidden="true" tabindex="-1"></a>in the data frame. However, there are only 23 rows. This is because </span>
<span id="cb22-589"><a href="#cb22-589" aria-hidden="true" tabindex="-1"></a>for one sample, TNFAPC-LPS. there are no cells in one quadrant, TNF-α -'ve</span>
<span id="cb22-590"><a href="#cb22-590" aria-hidden="true" tabindex="-1"></a>FITC +'ve (the bottom right quadrant). </span>
<span id="cb22-591"><a href="#cb22-591" aria-hidden="true" tabindex="-1"></a>Since we are probably happy not to annotate a figure with 0 %, this is </span>
<span id="cb22-592"><a href="#cb22-592" aria-hidden="true" tabindex="-1"></a>fine.</span>
<span id="cb22-593"><a href="#cb22-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-594"><a href="#cb22-594" aria-hidden="true" tabindex="-1"></a>To calculate the percentage of cells in each quadrant, we need to join </span>
<span id="cb22-595"><a href="#cb22-595" aria-hidden="true" tabindex="-1"></a>this dataframe with the number of non-debris cells for each sample, </span>
<span id="cb22-596"><a href="#cb22-596" aria-hidden="true" tabindex="-1"></a>*i.e.,* <span class="in">`clean_trans_live_n`</span></span>
<span id="cb22-597"><a href="#cb22-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-598"><a href="#cb22-598" aria-hidden="true" tabindex="-1"></a>🎬 Calculate the percentage of cells in each quadrant for each sample:</span>
<span id="cb22-599"><a href="#cb22-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-602"><a href="#cb22-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-603"><a href="#cb22-603" aria-hidden="true" tabindex="-1"></a>all_combin_perc <span class="ot">&lt;-</span> all_combin_n <span class="sc">|&gt;</span> </span>
<span id="cb22-604"><a href="#cb22-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(clean_trans_live_n, </span>
<span id="cb22-605"><a href="#cb22-605" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"antibody"</span>, <span class="st">"treatment"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb22-606"><a href="#cb22-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc_quad =</span> <span class="fu">round</span>(n_quad <span class="sc">/</span> n_live <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb22-607"><a href="#cb22-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(perc_quad <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb22-608"><a href="#cb22-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-609"><a href="#cb22-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-610"><a href="#cb22-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-611"><a href="#cb22-611" aria-hidden="true" tabindex="-1"></a>I have additionally filtered out rows where the % cells rounds to 0.</span>
<span id="cb22-612"><a href="#cb22-612" aria-hidden="true" tabindex="-1"></a>This is again because we are probably happy not to annotate a figure with 0 %.</span>
<span id="cb22-613"><a href="#cb22-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-614"><a href="#cb22-614" aria-hidden="true" tabindex="-1"></a>🎬 Click on the data frame in the environment window to view it and</span>
<span id="cb22-615"><a href="#cb22-615" aria-hidden="true" tabindex="-1"></a>make sure you have an understanding of the data.</span>
<span id="cb22-616"><a href="#cb22-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-619"><a href="#cb22-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-620"><a href="#cb22-620" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb22-621"><a href="#cb22-621" aria-hidden="true" tabindex="-1"></a>all_combin_perc <span class="sc">|&gt;</span> </span>
<span id="cb22-622"><a href="#cb22-622" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb22-623"><a href="#cb22-623" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">|&gt;</span> </span>
<span id="cb22-624"><a href="#cb22-624" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"200px"</span>)</span>
<span id="cb22-625"><a href="#cb22-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-626"><a href="#cb22-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-627"><a href="#cb22-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-628"><a href="#cb22-628" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb22-629"><a href="#cb22-629" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tip for your own plots</span></span>
<span id="cb22-630"><a href="#cb22-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-631"><a href="#cb22-631" aria-hidden="true" tabindex="-1"></a>You can combine the concept of annotation and faceted plots to annotate a quadrant gated plot of TNFa_APC_Lin signal against the E_coli_FITC_Lin signal.</span>
<span id="cb22-632"><a href="#cb22-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-633"><a href="#cb22-633" aria-hidden="true" tabindex="-1"></a>Because the annotation for each quadrant is in a different place, you will need to use four <span class="in">`geom_text()`</span> one for each quadrant and you will need to filter appropriately.</span>
<span id="cb22-634"><a href="#cb22-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-635"><a href="#cb22-635" aria-hidden="true" tabindex="-1"></a>Remember you also have the option to annotate manually.</span>
<span id="cb22-636"><a href="#cb22-636" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-637"><a href="#cb22-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-638"><a href="#cb22-638" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importing class data</span></span>
<span id="cb22-639"><a href="#cb22-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-640"><a href="#cb22-640" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">BIO00066I Biomedical Sciences class data</span><span class="co">](https://docs.google.com/spreadsheets/d/1wgQ9goCvYnO44sSHVvP37nFJM12mG8nibdpOOx7ZP9Q/edit?usp=drive_link)</span> are in a google sheet.</span>
<span id="cb22-641"><a href="#cb22-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-642"><a href="#cb22-642" aria-hidden="true" tabindex="-1"></a>You have a couple of options for importing this:</span>
<span id="cb22-643"><a href="#cb22-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-644"><a href="#cb22-644" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>download the file as an excel file or .csv and import that</span>
<span id="cb22-645"><a href="#cb22-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-646"><a href="#cb22-646" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>import the data directly from the google sheet into R.</span>
<span id="cb22-647"><a href="#cb22-647" aria-hidden="true" tabindex="-1"></a>    An advantage of using the google sheet is you won't have to remember to download the data when someone updates it.</span>
<span id="cb22-648"><a href="#cb22-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-649"><a href="#cb22-649" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb22-650"><a href="#cb22-650" aria-hidden="true" tabindex="-1"></a><span class="fu">## Google sheet closure</span></span>
<span id="cb22-651"><a href="#cb22-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-652"><a href="#cb22-652" aria-hidden="true" tabindex="-1"></a>The spreadsheet will be closed for input on **Friday 21 March (week 6)** so people can make conclusions about the class data without being concerned it will change.</span>
<span id="cb22-653"><a href="#cb22-653" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-654"><a href="#cb22-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-655"><a href="#cb22-655" aria-hidden="true" tabindex="-1"></a><span class="fu">### Importing from a googlesheet</span></span>
<span id="cb22-656"><a href="#cb22-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-657"><a href="#cb22-657" aria-hidden="true" tabindex="-1"></a>You can use the **`googlesheets4`** package <span class="co">[</span><span class="ot">@googlesheets4</span><span class="co">]</span> to do this.</span>
<span id="cb22-658"><a href="#cb22-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-661"><a href="#cb22-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-662"><a href="#cb22-662" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-663"><a href="#cb22-663" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb22-664"><a href="#cb22-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-665"><a href="#cb22-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-668"><a href="#cb22-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-669"><a href="#cb22-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-670"><a href="#cb22-670" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">"https://docs.google.com/spreadsheets/d/1wgQ9goCvYnO44sSHVvP37nFJM12mG8nibdpOOx7ZP9Q/edit?gid=0#gid=0"</span></span>
<span id="cb22-671"><a href="#cb22-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-672"><a href="#cb22-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-675"><a href="#cb22-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-676"><a href="#cb22-676" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb22-677"><a href="#cb22-677" aria-hidden="true" tabindex="-1"></a>class_data <span class="ot">&lt;-</span> <span class="fu">read_sheet</span>(file, <span class="at">sheet =</span> <span class="st">"data"</span>)</span>
<span id="cb22-678"><a href="#cb22-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-679"><a href="#cb22-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-680"><a href="#cb22-680" aria-hidden="true" tabindex="-1"></a>You will be asked to authenticate in your browser.</span>
<span id="cb22-681"><a href="#cb22-681" aria-hidden="true" tabindex="-1"></a>This message will appear in the console and the browser should open</span>
<span id="cb22-682"><a href="#cb22-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-683"><a href="#cb22-683" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb22-684"><a href="#cb22-684" aria-hidden="true" tabindex="-1"></a><span class="in">Waiting for authentication in browser...</span></span>
<span id="cb22-685"><a href="#cb22-685" aria-hidden="true" tabindex="-1"></a><span class="in">Press Esc/Ctrl + C to abort</span></span>
<span id="cb22-686"><a href="#cb22-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-687"><a href="#cb22-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-688"><a href="#cb22-688" aria-hidden="true" tabindex="-1"></a>You can Allow "Tidyverse API Packages wants to access your Google Account".</span>
<span id="cb22-689"><a href="#cb22-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-690"><a href="#cb22-690" aria-hidden="true" tabindex="-1"></a>The data should then read in.</span>
<span id="cb22-691"><a href="#cb22-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-692"><a href="#cb22-692" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb22-693"><a href="#cb22-693" aria-hidden="true" tabindex="-1"></a><span class="in">Authentication complete.</span></span>
<span id="cb22-694"><a href="#cb22-694" aria-hidden="true" tabindex="-1"></a><span class="in">✔ Reading from BIO00066I Biomedical Sciences class data.</span></span>
<span id="cb22-695"><a href="#cb22-695" aria-hidden="true" tabindex="-1"></a><span class="in">✔ Range ''data''.</span></span>
<span id="cb22-696"><a href="#cb22-696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-697"><a href="#cb22-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-698"><a href="#cb22-698" aria-hidden="true" tabindex="-1"></a>Note that you will probably want to do some quality control such has filtering out rows with missing data in important columns.</span>
<span id="cb22-699"><a href="#cb22-699" aria-hidden="true" tabindex="-1"></a>We did this in the <span class="co">[</span><span class="ot">Data Analysis 1: Core</span><span class="co">](../week-1/workshop.html#quality-control)</span> workshop.</span>
<span id="cb22-700"><a href="#cb22-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-701"><a href="#cb22-701" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analysis of the class data</span></span>
<span id="cb22-702"><a href="#cb22-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-703"><a href="#cb22-703" aria-hidden="true" tabindex="-1"></a>The class data has the summary statistics.</span>
<span id="cb22-704"><a href="#cb22-704" aria-hidden="true" tabindex="-1"></a>You do not need to apply flowcytometry methods to these that.</span>
<span id="cb22-705"><a href="#cb22-705" aria-hidden="true" tabindex="-1"></a>You should be able to apply techniques you have learned in stage 1 to the class data.</span>
<span id="cb22-706"><a href="#cb22-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-707"><a href="#cb22-707" aria-hidden="true" tabindex="-1"></a>Stage 1</span>
<span id="cb22-708"><a href="#cb22-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-709"><a href="#cb22-709" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Data Analysis in R for Becoming a Bioscientist 1</span><span class="co">](../../r4babs1/r4babs1.html)</span> <span class="co">[</span><span class="ot">@rand2023</span><span class="co">]</span>.</span>
<span id="cb22-710"><a href="#cb22-710" aria-hidden="true" tabindex="-1"></a>    Core concepts about scientific computing, types of variable, the role of variables in analysis and how to use RStudio to organise analysis and import, summarise and plot data.</span>
<span id="cb22-711"><a href="#cb22-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-712"><a href="#cb22-712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Data Analysis in R for Becoming a Bioscientist 2</span><span class="co">](../../r4babs2/r4babs2.html)</span> <span class="co">[</span><span class="ot">@rand2023</span><span class="co">]</span>.</span>
<span id="cb22-713"><a href="#cb22-713" aria-hidden="true" tabindex="-1"></a>    The logic of hypothesis testing, confidence intervals, what is meant by a statistical model, two-sample tests and one- and two-way analysis of variance (ANOVA).</span>
<span id="cb22-714"><a href="#cb22-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-715"><a href="#cb22-715" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Supporting book <span class="co">[</span><span class="ot">Computational Analysis for Bioscientists</span><span class="co">](https://3mmarand.github.io/comp4biosci/)</span> <span class="co">[</span><span class="ot">@Rand_Comp_Analysis</span><span class="co">]</span></span>
<span id="cb22-716"><a href="#cb22-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-717"><a href="#cb22-717" aria-hidden="true" tabindex="-1"></a><span class="fu"># Independent study following the workshop</span></span>
<span id="cb22-718"><a href="#cb22-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-719"><a href="#cb22-719" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Consolidate</span><span class="co">](study_after_workshop.qmd)</span></span>
<span id="cb22-720"><a href="#cb22-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-721"><a href="#cb22-721" aria-hidden="true" tabindex="-1"></a><span class="fu"># The Code file</span></span>
<span id="cb22-722"><a href="#cb22-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-723"><a href="#cb22-723" aria-hidden="true" tabindex="-1"></a>This contains all the code needed in the workshop even where it is not visible on the webpage.</span>
<span id="cb22-724"><a href="#cb22-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-725"><a href="#cb22-725" aria-hidden="true" tabindex="-1"></a>The <span class="in">`workshop.qmd`</span> file is the file I use to compile the practical.</span>
<span id="cb22-726"><a href="#cb22-726" aria-hidden="true" tabindex="-1"></a>Qmd stands for Quarto markdown.</span>
<span id="cb22-727"><a href="#cb22-727" aria-hidden="true" tabindex="-1"></a>It allows code and ordinary text to be interweaved to produce well-formatted reports including webpages.</span>
<span id="cb22-728"><a href="#cb22-728" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">View the Qmd in Browser</span><span class="co">](https://github.com/3mmaRand/R4BABS/blob/main/r4babs4/week-6/workshop.qmd)</span>.</span>
<span id="cb22-729"><a href="#cb22-729" aria-hidden="true" tabindex="-1"></a>Coding and thinking answers are marked with <span class="in">`#---CODING ANSWER---`</span> and <span class="in">`#---THINKING ANSWER---`</span></span>
<span id="cb22-730"><a href="#cb22-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-731"><a href="#cb22-731" aria-hidden="true" tabindex="-1"></a>Pages made with R <span class="co">[</span><span class="ot">@R-core</span><span class="co">]</span>, Quarto <span class="co">[</span><span class="ot">@allaire2022</span><span class="co">]</span>, <span class="in">`knitr`</span> <span class="co">[</span><span class="ot">@knitr1; @knitr2; @knitr3</span><span class="co">]</span>, <span class="in">`kableExtra`</span> <span class="co">[</span><span class="ot">@kableExtra</span><span class="co">]</span></span>
<span id="cb22-732"><a href="#cb22-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-733"><a href="#cb22-733" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Rand, E. (2025). Data Analysis in R for Becoming a Bioscientist (Version 0.2) <a href="https://github.com/3mmaRand/R4BABS" class="uri">https://github.com/3mmaRand/R4BABS</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/3mmaRand/comp4biosci/edit/main/r4babs4/week-6/workshop.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://github.com/3mmaRand">
<p>Emma on GitHub</p>
</a>
  </li>  
</ul>
</div>
  </div>
</footer><script>
document.addEventListener("DOMContentLoaded", function() {
  // grab all links under “Other Links” in the right-hand TOC
  const links = document.querySelectorAll('.quarto-other-links ul li a');
  links.forEach(function(a) {
    // find the one whose text is exactly “Make a suggestion”
    if (a.textContent.trim() === 'Make a suggestion') {
      const pageUrl   = encodeURIComponent(window.location.href);
      const pageTitle = encodeURIComponent(document.title);
      a.href = 'https://github.com/3mmaRand/R4BABS/issues/new'
             + '?title=' + pageTitle
             + '&body='  + pageUrl;
      a.target = '_blank';
    }
  });
});
</script><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>